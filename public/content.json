[{"title":"ç®—æ³•-æœ€å¤§å­åºå’Œ","date":"2019-01-14T13:43:04.000Z","path":"2019/01/14/ç®—æ³•-æœ€å¤§å­åºå’Œ/","text":"é¢˜ç›®è‹±æ–‡Given an integer array nums, find the contiguous subarray (containing at least one number) which has the largest sum and return its sum. Example: Input: [-2,1,-3,4,-1,2,1,-5,4],Output: 6Explanation: [4,-1,2,1] has the largest sum = 6. ä¸­æ–‡ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums ï¼Œæ‰¾åˆ°ä¸€ä¸ªå…·æœ‰æœ€å¤§å’Œçš„è¿ç»­å­æ•°ç»„ï¼ˆå­æ•°ç»„æœ€å°‘åŒ…å«ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œè¿”å›å…¶æœ€å¤§å’Œã€‚ æ€è·¯ åŠ¨æ€è§„åˆ’ã€‚ æŠŠæ±‚è”ç³»æœ€å¤§å­åºåˆ—è½¬åŒ–ä¸ºæ±‚å½“å‰èŠ‚ç‚¹ä¸ä¸Šä¸€èŠ‚ç‚¹çš„æœ€å¤§å€¼ã€‚ ä»£ç 1234567891011121314151617181920212223242526272829int maxSubArray(int* nums, int numsSize) &#123; if(numsSize == 0)&#123; return 0; &#125; if(numsSize &lt;=1)&#123; return *nums; &#125; int tmp = 0; int pre = *nums ; nums++; int ret = pre; for(int i = 1; i&lt; numsSize;i++) &#123; tmp = (pre + *nums) &gt; *nums ? (pre + *nums) : *nums; // printf(\"tmp:%d\\n\", tmp); if(tmp &gt; ret) &#123; ret = tmp; &#125; pre = tmp; nums++; &#125; return ret;&#125;","tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://yoursite.com/tags/ç®—æ³•/"}]},{"title":"ç®—æ³•-æ±‚æœ€å¤§æ­£æ–¹å½¢é¢ç§¯","date":"2019-01-14T09:18:04.000Z","path":"2019/01/14/ç®—æ³•-æ±‚æœ€å¤§æ­£æ–¹å½¢é¢ç§¯/","text":"é¢˜ç›®è‹±æ–‡Given a 2D binary matrix filled with 0â€™s and 1â€™s, find the largest square containing only 1â€™s and return its area. Example: Input: 1 0 1 0 01 0 1 1 11 1 1 1 11 0 0 1 0 Output: 4 ä¸­æ–‡åœ¨ä¸€ä¸ªç”± 0 å’Œ 1 ç»„æˆçš„äºŒç»´çŸ©é˜µå†…ï¼Œæ‰¾åˆ°åªåŒ…å« 1 çš„æœ€å¤§æ­£æ–¹å½¢ï¼Œå¹¶è¿”å›å…¶é¢ç§¯ã€‚ æ€è·¯ åŠ¨æ€è§„åˆ’(ä¸»è¦ç”¨æˆ·å°†ä¸€ä¸ªå¤æ‚çš„é—®é¢˜åˆ†è§£ä¸ºå¤šä¸ªå»ºå•çš„é—®é¢˜ï¼Œæ±‚æœ€ä¼˜è§£æ—¶)ã€‚ å£°æ˜ä¸€ä¸ªç©ºé—´å’ŒåŸæœ‰äºŒä½æ•°æ®å¤§å°ä¸€æ ·çš„äºŒä½æ•°ç»„(tmp[i][j])ã€‚ è®¡ç®—æ¯ä¸€ä¸ªèŠ‚ç‚¹æœ€å¤§æ­£æ–¹å½¢çš„è¾¹é•¿ï¼Œå¹¶å­˜å‚¨ä¸è¯¥èŠ‚ç‚¹ï¼ˆåˆ©ç”¨ä¹‹å‰èŠ‚ç‚¹è®¡ç®—å½“å‰èŠ‚ç‚¹æœ€å¤§æ­£æ–¹å½¢è¾¹é•¿ï¼‰ã€‚ å–tmp[i][j]å¾—æœ€å¤§å€¼çš„å¹³å‡¡è¿”å›ã€‚ä»£ç  ç¬¬ä¸€ç‰ˆä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152class Solution &#123; function maximalSquare($matrix) &#123; $hight = count($matrix); if($hight&lt;1) &#123; return 0; &#125; $wide = 0; if($hight &gt; 0)&#123; $wide= count($matrix[0]); &#125; $ret = 0; for($i = 1; $i&lt;= $hight; $i++) &#123; $tmp = $this-&gt;getRet($matrix, $i, $hight, $wide); if($ret &lt;$tmp )&#123; $ret = $tmp; &#125; &#125; return $ret; &#125; public function getRet($matrix, $i, $hight, $wide) &#123; //èµ·å§‹ç‚¹çºµå‘åæ ‡ for($h = 0; $h&lt;= $hight-$i; $h++ ) &#123; for($j = 0;$j &lt;= $wide-$i; $j++) &#123; //h ä¸ºèµ·ç‚¹é«˜ï¼Œjä¸ºèµ·ç‚¹å®½ã€‚ $ret = 1; for($m = $h; $m &lt;$h + $i; $m++)&#123; for($k = $j; $k &lt; $j + $i; $k++)&#123; if($matrix[$m][$k] == 0) &#123; $ret = 0; break; &#125; &#125; if($ret == 0) &#123; break; &#125; &#125; if($ret == 1)&#123; return $i*$i; &#125; &#125; &#125; return 0; &#125; &#125; ç”¨phpè·‘æµ‹è¯•ç”¨ä¾‹ï¼Œè·‘äº†2.5ç§’ã€‚ğŸ˜“ å›å¤´ç”¨cé‡å†™ä¸‹è¯•è¯•ã€‚1å¾…å®š æœ€ä¼˜è§£123456789101112131415161718192021222324class Solution &#123; public int maximalSquare(char[][] matrix) &#123; /** dp[i][j]è¡¨ç¤ºä»¥ç¬¬iè¡Œç¬¬jåˆ—ä¸ºå³ä¸‹è§’æ‰€èƒ½æ„æˆçš„æœ€å¤§æ­£æ–¹å½¢è¾¹é•¿, åˆ™é€’æ¨å¼ä¸º: dp[i][j] = 1 + min(dp[i-1][j-1], dp[i-1][j], dp[i][j-1]); **/ int m = matrix.length; if(m &lt; 1) return 0; int n = matrix[0].length; int max = 0; int[][] dp = new int[m+1][n+1]; for(int i = 1; i &lt;= m; ++i) &#123; for(int j = 1; j &lt;= n; ++j) &#123; if(matrix[i-1][j-1] == '1') &#123; dp[i][j] = 1 + Math.min(dp[i-1][j-1], Math.min(dp[i-1][j], dp[i][j-1])); max = Math.max(max, dp[i][j]); &#125; &#125; &#125; return max*max; &#125;&#125;","tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://yoursite.com/tags/ç®—æ³•/"}]},{"title":"äºŒå‰æ ‘æœ€è¿‘å…¬å…±ç¥–å…ˆ","date":"2019-01-10T14:59:11.000Z","path":"2019/01/10/ç®—æ³•-äºŒå‰æ ‘æœ€è¿‘å…¬å…±ç¥–å…ˆ/","text":"é¢˜ç›®ç»™å®šä¸€ä¸ªäºŒå‰æ ‘, æ‰¾åˆ°è¯¥æ ‘ä¸­ä¸¤ä¸ªæŒ‡å®šèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚ ç™¾åº¦ç™¾ç§‘ä¸­æœ€è¿‘å…¬å…±ç¥–å…ˆçš„å®šä¹‰ä¸ºï¼šâ€œå¯¹äºæœ‰æ ¹æ ‘ T çš„ä¸¤ä¸ªç»“ç‚¹ pã€qï¼Œæœ€è¿‘å…¬å…±ç¥–å…ˆè¡¨ç¤ºä¸ºä¸€ä¸ªç»“ç‚¹ xï¼Œæ»¡è¶³ x æ˜¯ pã€q çš„ç¥–å…ˆä¸” x çš„æ·±åº¦å°½å¯èƒ½å¤§ï¼ˆä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿå¯ä»¥æ˜¯å®ƒè‡ªå·±çš„ç¥–å…ˆï¼‰ã€‚â€ ä¾‹å¦‚ï¼Œç»™å®šå¦‚ä¸‹äºŒå‰æ ‘: root = [3,5,1,6,2,0,8,null,null,7,4] æ€è·¯åŸæœ‰æ€è·¯ æŸ¥è¯¢æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹æœ‰ä¸¤ä¸ªç›®æ ‡èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚ ç„¶åæŸ¥è¯¢å½“å‰èŠ‚ç‚¹çš„å·¦å³å­èŠ‚ç‚¹ï¼Œå¦‚æœæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹çš„å­èŠ‚ç‚¹åªåŒ…å«ä¸€ä¸ªç›®æ ‡èŠ‚ç‚¹ï¼Œåˆ™ä»–çš„çˆ¶èŠ‚ç‚¹åˆ™ä¸ºæœ€è¿‘å…¬å…±ç¥–å…ˆã€‚æ”¹è‰¯åæ€è·¯ ä¸­åºéå†æ‰€æœ‰èŠ‚ç‚¹ï¼Œå¦‚æœå½“å‰æ¥ç”µæ¥ç‚¹æˆ–è€…å…¶å­èŠ‚ç‚¹åŒ¹é…åˆ°äº†ç›®æ ‡èŠ‚ç‚¹ï¼Œåˆ™è¿”å›å½“å‰èŠ‚ç‚¹ã€‚ å¦‚æœå½“å‰èŠ‚ç‚¹çš„å·¦å³èŠ‚ç‚¹åˆ†åˆ«åŒ¹é…åˆ°äº†ä¸€ä¸ªç›®æ ‡èŠ‚ç‚¹ï¼ˆroot == null || p || q ç›´æ¥è¿”å›rootï¼‰ï¼Œåˆ™å½“å‰èŠ‚ç‚¹æ˜¯æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚ä»£ç  åŸç‰ˆä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263int leftFist(struct TreeNode* root, struct TreeNode* p, struct TreeNode* q) &#123; int ret = 0; if(root-&gt;left) &#123; ret = ret + leftFist(root-&gt;left, p, q); &#125; if(root-&gt;right)&#123; ret = ret+ leftFist(root-&gt;right, p, q); &#125; if(root == p) &#123; ret +=1; &#125; if(root == q) &#123; ret +=1; &#125; return ret;&#125;/** * Definition for a binary tree node. * struct TreeNode &#123; * int val; * struct TreeNode *left; * struct TreeNode *right; * &#125;; */struct TreeNode* lowestCommonAncestor(struct TreeNode* root, struct TreeNode* p, struct TreeNode* q) &#123; struct TreeNode* retRoot = NULL ; int retSum = leftFist(root, p, q); if(retSum == 2) &#123; int retSumleft = NULL; if(root-&gt;left) &#123; retSumleft = leftFist(root-&gt;left, p, q); &#125; if(0 &lt; retSumleft &amp;&amp; retSumleft &lt; 2) &#123; // printf(\"retSumleft:%d,\", root-&gt;left-&gt;val); return root; &#125; int retSumright = NULL; if(root-&gt;right) &#123; retSumright = leftFist(root-&gt;right, p, q); &#125; if(0 &lt; retSumright &amp;&amp; retSumright&lt; 2) &#123; // printf(\"retSumright:%d\", root-&gt;right-&gt;val); return root; &#125; &#125; if(root-&gt;left) &#123; retRoot = lowestCommonAncestor(root-&gt;left, p, q); if(retRoot) &#123; return retRoot; &#125; &#125; if(root-&gt;right)&#123; retRoot = lowestCommonAncestor(root-&gt;right, p, q); if(retRoot) &#123; return retRoot; &#125; &#125; return retRoot;&#125; cè¯­è¨€è®©æˆ‘è·‘äº†1888msã€‚ã€‚ ä¼˜åŒ–è§£12345678910111213141516171819/** * Definition for a binary tree node. * struct TreeNode &#123; * int val; * struct TreeNode *left; * struct TreeNode *right; * &#125;; */struct TreeNode* lowestCommonAncestor(struct TreeNode* root, struct TreeNode* p, struct TreeNode* q) &#123; if(root == NULL || root == p || root == q) &#123; return root; &#125; struct TreeNode* left = lowestCommonAncestor(root-&gt;left, p ,q); struct TreeNode* right = lowestCommonAncestor(root-&gt;right, p ,q); if(left == NULL &amp;&amp; right == NULL) return NULL; if(left != NULL &amp;&amp; right != NULL) return root; return (left == NULL ? right : left);&#125; 12ms","tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://yoursite.com/tags/ç®—æ³•/"}]},{"title":"åˆå¹¶kä¸ªé“¾è¡¨","date":"2019-01-10T08:09:18.000Z","path":"2019/01/10/ç®—æ³•-åˆå¹¶kä¸ªé“¾è¡¨/","text":"é¢˜ç›®åˆå¹¶ k ä¸ªæ’åºé“¾è¡¨ï¼Œè¿”å›åˆå¹¶åçš„æ’åºé“¾è¡¨ã€‚è¯·åˆ†æå’Œæè¿°ç®—æ³•çš„å¤æ‚åº¦ã€‚ ç¤ºä¾‹: è¾“å…¥:[ 1-&gt;4-&gt;5, 1-&gt;3-&gt;4, 2-&gt;6]è¾“å‡º: 1-&gt;1-&gt;2-&gt;3-&gt;4-&gt;4-&gt;5-&gt;6 åˆ†æ å¦‚æœç†ç”±æœ€åé€‰æ‹©è¿›è¡Œåˆå¹¶é“¾è¡¨ï¼Œè¿™æ˜¯æ—¶é—´å¤æ‚åº¦æ˜¯knå¦‚æœ k å¾ˆå¤§çš„æ—¶å€™æ—¶é—´å¤æ‚åº¦ç®€ç›´çˆ†ç‚¸ï¼Œè¿˜ä¸å¦‚ç›´æ¥åˆå¹¶ã€‚ å¦‚æœä½¿ç”¨å½’å¹¶æ’åº æ—¶é—´å¤æ‚åº¦æ˜¯nlogkã€‚ å¦‚æœç›´æ¥ä¸¤ä¸¤æš´åŠ›åˆå¹¶ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯n(k^2+k)/2 æ‰€ä»¥å½“kå¾ˆå¤§çš„æ—¶å€™ï¼Œæœ€ä¼˜è§£åº”è¯¥æ˜¯å¹¶å½’ã€‚ä»£ç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879struct ListNode* merge(struct ListNode* l1, struct ListNode* l2)&#123; struct ListNode* l3 = NULL; struct ListNode* p = NULL; struct ListNode* tmp = NULL; if(!l1 &amp;&amp; !l2) &#123; return l3; &#125; if(l1 &amp;&amp; !l2) &#123; return l1; &#125; if(!l1 &amp;&amp; l2) &#123; return l2; &#125; //è®¾ç½®å¤´ç»“ç‚¹ if(l1-&gt;val &lt; l2-&gt;val) &#123; l3 = l1; l1 = l1-&gt;next; &#125; else &#123; l3 = l2; l2 = l2-&gt;next; &#125; p = l3; while(l1 &amp;&amp; l2) &#123; if(l1-&gt;val &lt; l2-&gt;val) &#123; tmp = l1-&gt;next; p-&gt;next = l1; l1 = tmp; &#125; else &#123; tmp = l2-&gt;next; p-&gt;next = l2; l2 = tmp; &#125; p = p-&gt;next; &#125; if(l1) &#123; p-&gt;next = l1; &#125; if(l2) &#123; p-&gt;next = l2; &#125; // struct ListNode* tmp3= l3; // while(tmp3) // &#123; // printf(\"%d,\", tmp3-&gt;val); // tmp3 = tmp3-&gt;next; // &#125; // printf(\"\\n\"); return l3;&#125;/** * Definition for singly-linked list. * struct ListNode &#123; * int val; * struct ListNode *next; * &#125;; */struct ListNode* mergeKLists(struct ListNode** lists, int listsSize) &#123; if(listsSize == 0) &#123; return 0; &#125; if(listsSize == 1) &#123; return (*lists); &#125; struct ListNode* ret = (*lists); for(int i = 1 ; i &lt; listsSize; i++) &#123; lists++; ret = merge((*lists), ret); &#125; return ret; &#125; åè®°å°è¯•å¯»æ‰¾æ›´ä¼˜è§£æ³•ã€‚","tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://yoursite.com/tags/ç®—æ³•/"}]},{"title":"tcpä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æŒ¥æ‰‹","date":"2019-01-09T14:16:19.000Z","path":"2019/01/09/tcpä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æŒ¥æ‰‹/","text":"ä¸‰æ¬¡æ¡æ‰‹ä¸‰æ¬¡æ¡æ‰‹ æ˜¯æŒ‡tcpå»ºç«‹è¿æ¥æ—¶å€™éœ€è¦æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å‘é€ä¸‰ä¸ªç½‘ç»œåŒ…ã€‚ä¸‰æ¬¡æ¡æ‰‹çš„ç›®çš„æ˜¯é“¾æ¥ä¸æœåŠ¡å™¨ç«¯å£ï¼Œå¹¶å»ºç«‹tcpè¿æ¥ï¼Œå¹¶åŒæ­¥è¿æ¥åŒæ–¹çš„åºåˆ—å·å’Œç¡®è®¤å·ï¼Œå¹¶äº¤æ¢tcpçª—å£å¤§å°ä¿¡æ¯ã€‚ åœ¨tcp/ipåè®®ä¸­, tcpæä¾›å¯é çš„é“¾æ¥æœåŠ¡ï¼Œé‡‡ç”¨ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹ä¸€ä¸ªé“¾æ¥ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå»ºç«‹è¿æ¥æ—¶ï¼Œå®¢æˆ·ç«¯å‘é€SYNåŒ…åˆ°æœåŠ¡å™¨ï¼ŒåŒæ—¶è¿›å…¥SYN_SENDçŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡å™¨Bç¡®è®¤ã€‚ ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨Bæ”¶åˆ°SYNåŒ…ï¼Œç¡®è®¤å®¢æˆ·ç«¯çš„SYN(ACK+1),åŒæ—¶è‡ªå·±å‘é€ä¸€ä¸ªSYNåŒ…ï¼Œæ­¤æ—¶æœåŠ¡å™¨è¿›å…¥SYN_RECVçŠ¶æ€ã€‚ ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼š å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„SYN+ACKåŒ…ï¼Œå‘æœåŠ¡å™¨å‘é€ç¡®è®¤åŒ…ï¼ˆACK+1ï¼‰,æ­¤åŒ…å‘é€å®Œæ¯•ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è¿›å…¥RESTABLISHEDçŠ¶æ€ï¼Œå®Œæˆä¸‰æ¬¡æ¡æ‰‹ã€‚å››æ¬¡æŒ¥æ‰‹tcpæ–­å¼€è¿æ¥éœ€è¦å‘é€å››ä¸ªåŒ…ï¼Œæ‰€ä»¥ç§°ä¹‹ä¸º å››æ¬¡æŒ¥æ‰‹,å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¯ä»¥å‘èµ·æŒ¥æ‰‹ã€‚ ç”±äºTCPæ˜¯å…¨åŒå·¥çš„ï¼Œæ‰€ä»¥éœ€è¦åŒå‘å…³é—­ã€‚åŸåˆ™æ˜¯å½“ä¸€æ–¹å®Œæˆæ•°æ®å‘é€åå°±åªèƒ½å‘é€ä¸€ä¸ªFINæ¥ç»ˆæ­¢è¿™ä¸ªæ–¹å‘çš„é“¾æ¥ã€‚æ”¶åˆ°ä¸€ä¸ªFINåªæ„å‘³ç€è¿™ä¸ªä¸€ä¸ªæ–¹å‘æ²¡æœ‰æ•°æ®å‘é€ï¼Œä¸€ä¸ªtcpé“¾æ¥æ”¶åˆ°ä¸€ä¸ªFINåä»ç„¶èƒ½å‘é€æ•°æ®ã€‚é¦–å…ˆå…³é—­çš„ä»¥é˜²è¿›è¡Œä¸»åŠ¨å…³é—­ï¼Œå¦å¤–ä»¥é˜²æ‰§è¡Œè¢«åŠ¨å…³é—­ã€‚ ä¸»åŠ¨æ–¹å‘é€ä¸€ä¸ªFIN,ç”¨æ¥å‘Šè¯‰è¢«åŠ¨æ–¹æˆ‘å‘é€å®Œæ¯•ï¼Œè¯·æ±‚å…³é—­é“¾æ¥ã€‚ è¢«åŠ¨æ–¹æ”¶åˆ°ä¸»åŠ¨æ–¹çš„FINè¯·æ±‚ï¼Œä¼šå›å‘ä¸€ä¸ªACK(æˆ‘çŸ¥é“äº†)ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ç»Ÿä¸€å…³é—­é“¾æ¥ã€‚ å½“è¢«åŠ¨æ–¹ä¹Ÿå‘é€å®Œæ•°æ®äº†ï¼Œä¼šå‘é€ä¸€ä¸ªFINåŒ…ï¼Œé«˜é€Ÿä¸»åŠ¨æ–¹æˆ‘ä¹Ÿå‘é€å®Œäº†ã€‚ ä¸»åŠ¨æ–¹æ”¶åˆ°è¢«åŠ¨æ–¹çš„FINåŒ…ï¼Œå›å¤ACK(ç¡®è®¤æ”¶åˆ°)ï¼Œæ­¤æ—¶tcpæ–­å¼€è¿æ¥ã€‚","tags":[{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"http://yoursite.com/tags/ç½‘ç»œ/"}]},{"title":"ç®—æ³•-é“¾è¡¨ç›¸äº¤(ntersection of Two Linked Lists)","date":"2019-01-08T09:11:56.000Z","path":"2019/01/08/ç®—æ³•-é“¾è¡¨ç›¸äº¤/","text":"é¢˜ç›®ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œæ‰¾åˆ°ä¸¤ä¸ªå•é“¾è¡¨ç›¸äº¤çš„èµ·å§‹èŠ‚ç‚¹æ³¨æ„ï¼š å¦‚æœä¸¤ä¸ªé“¾è¡¨æ²¡æœ‰äº¤ç‚¹ï¼Œè¿”å› null. åœ¨è¿”å›ç»“æœåï¼Œä¸¤ä¸ªé“¾è¡¨ä»é¡»ä¿æŒåŸæœ‰çš„ç»“æ„ã€‚ å¯å‡å®šæ•´ä¸ªé“¾è¡¨ç»“æ„ä¸­æ²¡æœ‰å¾ªç¯ã€‚ ç¨‹åºå°½é‡æ»¡è¶³ O(n) æ—¶é—´å¤æ‚åº¦ï¼Œä¸”ä»…ç”¨ O(1) å†…å­˜ã€‚ æ€è·¯æ¶è®¾å­˜åœ¨ä¸¤ä¸ªé“¾è¡¨ headA headBã€‚å®šä¹‰ä¸¤ä¸ªæŒ‡é’ˆ a båˆ†åˆ«å¯¹åº”headA headB, å¾ªç¯a b ç›´è‡³åˆ°è¾¾é“¾è¡¨çš„å°¾éƒ¨ï¼Œç„¶åå°†aæŒ‡å‘headBã€å°†bæŒ‡å‘headA ,ç»§ç»­å¾ªç¯ç›´è‡³å‡ºç°a==bçš„æƒ…å†µï¼Œæˆ–è€…ä»»æ„ä¸€ä¸ªé“¾è¡¨åˆ°è¾¾ç»ˆç‚¹ã€‚ ä»£ç 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647/** * Definition for singly-linked list. * struct ListNode &#123; * int val; * struct ListNode *next; * &#125;; */struct ListNode *getIntersectionNode(struct ListNode *headA, struct ListNode *headB) &#123; struct ListNode *a = headA; struct ListNode *b = headB; int aDone =0; int bDone =0; while(1) &#123; if(a == b) &#123; return a; &#125; if(a &amp;&amp; a-&gt;next) &#123; a = a-&gt;next; &#125; else &#123; if(aDone != 1) &#123; a = headB; aDone = 1; &#125; else &#123; break; &#125; &#125; if(b &amp;&amp; b-&gt;next ) &#123; b = b-&gt;next; &#125; else &#123; if(bDone != 1) &#123; b = headA; bDone =1; &#125; else &#123; break; &#125; &#125; &#125; return NULL; &#125;","tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"http://yoursite.com/tags/ç®—æ³•/"}]},{"title":"æ•°æ®åº“éš”ç¦»çº§åˆ«","date":"2018-12-23T12:34:25.000Z","path":"2018/12/23/æ•°æ®åº“éš”ç¦»çº§åˆ«/","text":"SQLæ ‡å‡†è§„èŒƒä¸­å®šä¹‰äº†å››ç§æ•°æ®åº“éš”ç¦»çº§åˆ«ã€‚æ¯ç§éš”ç¦»çº§åˆ«å¸¦æ¥çš„ç³»ç»Ÿå¼€é”€æ˜¯ä¸ä¸€æ ·çš„ã€‚é€šå¸¸è¾ƒä½çš„éš”ç¦»çº§åˆ«çš„ç³»ç»Ÿå¼€é”€ä¼šæ›´ä½ï¼Œå¯ä»¥æ‰§è¡Œæ›´é«˜çš„å¹¶å‘ã€‚ READ COMMITTED(æœªæäº¤è¯»)é¡¾åæ€ä¹‰ï¼Œæœªæäº¤è¯»éš”ç¦»çº§åˆ«ä¸­ï¼Œäº‹ç‰©çš„ä¿®æ”¹å³ä½¿æ²¡æœ‰æäº¤ï¼Œå¯¹å…¶ä»–äº‹åŠ¡ä¹Ÿæ˜¯å¯è§çš„ã€‚äº‹åŠ¡å¯ä»¥è¯»å–ä¸ºæœªæäº¤çš„æ•°æ®ï¼Œä¹Ÿæˆä¸ºè„è¯»ã€‚READ COMMITED æ€§èƒ½ä¸Šä¸ä¼šæœ‰è·Ÿå¾ˆå¤§çš„ä¼˜åŠ¿ï¼Œä½†æ˜¯å´ä¼šå¯¼è‡´å¾ˆå¤šçš„é—®é¢˜ï¼Œåœ¨å®é™…åº”ç”¨ä¸­å¾ˆå°‘ä½¿ç”¨ã€‚ eg:ä¸šåŠ¡åœºæ™¯æ”¯ä»˜æ‰£æ¬¾ã€‚å½“ç”¨æˆ·ç»Ÿä¸€æ—¶åˆ»å‘ç”Ÿä¸€ç¬”å……å€¼500ï¼Œå’Œä¸€ç¬”æ‰£æ¬¾200ä¸šåŠ¡æ—¶ã€‚ æ‰£æ¬¾è¯»åˆ°æ˜¯æœªæ‰§è¡Œçš„å……å€¼äº‹åŠ¡é‡‘é¢ï¼Œè´¦æˆ·ä½™é¢500å…ƒï¼Œä½†æ˜¯å……å€¼äº‹åŠ¡å›æ»šäº†ï¼Œè¿™ç§æƒ…å†µä¸‹æ•°æ®å‡ºç°é—®é¢˜ï¼Œæ‰€ä»¥æœªæäº¤è¯»æ˜¯ä¸€ç§ä¸å¯é çš„äº‹åŠ¡ã€‚ READ COMMITED(æäº¤è¯»)å¤šæ•°æ•°æ®åº“çš„éš”ç¦»çº§æ˜¯æäº¤è¯»(æ¯”å¦‚Sql Server , Oracle)ï¼Œä½†æ˜¯mysqlä¸æ˜¯ã€‚æäº¤è¯»çš„å«ä¹‰æ˜¯ï¼šä¸€ä¸ªäº‹åŠ¡åªèƒ½çœ‹åˆ°å·²ç»æäº¤çš„äº‹åŠ¡æ‰€åšçš„ä¿®æ”¹ã€‚ä¹Ÿå°±æ˜¯è¯´äº‹åŠ¡å’Œäº‹åŠ¡ä¹‹å‰åœ¨æäº¤å‰æ˜¯ç›¸äº’ä¸å¯è§çš„ã€‚è¿™ä¸ªçº§åˆ«åˆç§°ä¸ºä¸å¯é‡å¤è¯»ï¼Œå› ä¸ºæ¯æ¬¡è¯»å–çš„ç»“æœå¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚ eg:å½“æˆ‘ä»¬æ‹¿ç€é“¶è¡Œå¡å»æ¶ˆè´¹æ—¶å€™ï¼ŒæŸ¥è¯¢åˆ°å¡é‡Œè¿˜æœ‰2000å…ƒï¼Œè¿™æ—¶å‡†å¤‡æ¶ˆè´¹ã€‚ä¸æ­¤åŒæ—¶è¿™å¼ å¡çš„é’±è¢«è€å©†è½¬è´¦äº†ï¼ˆå·²ç»è½¬å‡ºå»2000å…ƒï¼‰ï¼Œå½“æˆ‘ä»¬åœ¨æ‰£æ¬¾ä½ çš„æ—¶å€™ä¼šæç¤ºä½™é¢ä¸è¶³ã€‚æäº¤è¯»é¿å…äº†è„è¯»ï¼Œä½†æ˜¯å´äº§ç”Ÿäº†ä¸å¯é‡å¤è¯»ï¼ˆåŒä¸€äº‹åŠ¡å†…ï¼‰ã€‚ Repeatable read ï¼ˆé‡å¤è¯»ï¼‰é‡å¤è¯»ï¼Œä¿è¯äº†åœ¨åŒä¸€ä¸ªäº‹åŠ¡å†…è¯»å–åŒä¸€æ¡æ•°æ®æ˜¯ä¸å˜çš„ï¼Œä½†æ˜¯å´æ— æ³•ä¿è¯æˆ‘ä»¬è¯»å–ï¼ˆåŒä¸€äº‹åŠ¡å†…ï¼‰åŒä¸€è¡¨é‡Œçš„æ•°æ®é‡æ˜¯ä¸€è‡´çš„ã€‚ä½†æ˜¯å´ä¼šäº§ç”Ÿå¹»è¯»ï¼ˆå¹»è¡Œï¼‰ã€‚ ä¾‹å¦‚æ¶ˆè´¹è®°å½•è¡¨ï¼Œæˆ‘ä»¬åœ¨æ‰“å°ä¿¡ç”¨å¡çš„æ¶ˆè´¹è®°å½•æ—¶æŸ¥è¯¢å‡ºæ¥åªæœ‰ä¸€æ¡æ¶ˆè´¹è®°å½•80ï¼ˆè¿™æ˜¯å¦å¤–ä¸€ä¸ªäº‹åŠ¡æ— æ³•æ”¹å˜çš„ï¼‰ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬æ‰“å°çš„æ—¶å€™ï¼Œè€å©†åˆæ¶ˆè´¹äº†1000å…ƒï¼ˆå¦å¤–ä¸€ä¸ªäº‹åŠ¡ï¼Œä½†æ˜¯æ²¡æœ‰å¯¹åŸæ¥çš„80å…ƒè¿›è¡Œä¿®æ”¹ï¼‰ï¼Œæˆ‘ä»¬æ‰“å°å‡ºæ¥çš„ç»“æœæ˜¯ä¸¤æ¡è®°å½• 80 +1000ï¼Œè¿™å°±æ˜¯å¹»è¡Œã€‚ Serializable ï¼ˆåºåˆ—åŒ–ï¼‰Serializable é€šè¿‡å¼ºåˆ¶äº‹åŠ¡ä¸²è¡Œæ‰§è¡Œé¿å…äº†æ¬¢è¯»ã€‚ä½†æ˜¯Serializableåœ¨æ‰§è¡Œçš„æ—¶å€™ä¼šå¯¹æ¯ä¸€æ ·çš„æ•°æ®éƒ½åŠ ä¸Šé”ï¼Œä¼šå¯¼è‡´å¤§é‡çš„è¶…æ—¶å’Œé”ç«äº‰ã€‚åªæœ‰åœ¨æ•°æ®ä¸€è‡´æ€§éå¸¸é‡è¦ï¼Œä¸”å¹¶å‘ä¸æ˜¯å¾ˆå¤§æƒ…å†µé€‰ï¼Œå¯ä»¥é€‰ç”¨è¿™ç§éš”ç¦»çº§åˆ«ã€‚ å‡ ä¸ªåè¯è„è¯»æŒ‡çš„æ˜¯åœ¨Aäº‹åŠ¡å†…ï¼Œå¤šæ¬¡è¯»å–åŒä¸€ä¸€ä¸ªæ•°æ®ã€‚ä¸æ­¤åŒæ—¶è¿˜æœ‰å¦å¤–ä¸€ä¸ªBäº‹åŠ¡å¯¹åŒä¸€æ•°æ®è¿›è¡Œäº†ä¿®æ”¹ï¼Œä½†æ˜¯æœªæäº¤ã€‚è¿™æ—¶å°±ä¼šäº§ç”Ÿäº‹åŠ¡Aä¸¤æ¬¡è¯»å–çš„æ•°æ®ä¸ä¸€è‡´ï¼Œä¸€ä¸ªæ˜¯äº‹åŠ¡Bæœªæ‰§è¡Œå‰çš„æ•°æ®ï¼Œä¸€ä¸ªæ˜¯è¯»å–äº‹åŠ¡Bæœªæäº¤çš„æ•°æ®ã€‚ ä¸å¯é‡å¤è¯»ã€‚æŒ‡çš„æ˜¯åŒä¸€äº‹åŠ¡å†…ï¼Œæ— æ³•å¯¹åŒä¸€ä¸ªæ•°æ®å¤šæ¬¡è¯»å–ï¼Œå› ä¸ºä¸¤æ¬¡è¯»å–å¯èƒ½æ˜¯ä¸ä¸€è‡´çš„ï¼ˆå› ä¸ºæ²¡æœ‰å¯¹ æ•°æ®å†™ åŠ é”ï¼‰ã€‚ å¹»è¯»å¹»è¯»æ˜¯åœ¨å¯é‡å¤è¯»çš„éš”ç¦»çº§åˆ«ä¸‹äº§ç”Ÿçš„é—®é¢˜ã€‚å¯é‡å¤è¯»è™½ç„¶å¯¹æ•°æ®åŠ å†™é”ï¼Œä½†æ˜¯å´æ²¡å¯¹è¡¨åŠ é”ï¼Œé€ æˆæ¯æ¬¡è¯»å–è¡¨çš„æ•°æ®é‡æ˜¯ä¸ä¸€è‡´çš„ï¼Œæ‰€ä»¥åˆç§°å¹»è¡Œã€‚","tags":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"http://yoursite.com/tags/æ•°æ®åº“/"}]},{"title":"kong","date":"2018-12-02T11:02:17.000Z","path":"2018/12/02/kong/","text":"å½“å‰ç³»ç»Ÿï¼Œç¯å¢ƒcentos7\bèµ·kongæœåŠ¡éœ€è¦åšï¼š å®‰è£… kong pgsql dashboard(å¯é€‰ï¼Œç”¨æ¥é€šè¿‡apiæ¥ç®¡ç†ç©º) é…ç½® kong.confï¼ˆé…ç½®æ•°æ®åº“ç­‰ï¼‰ã€é…ç½®è·¯ç”±ã€‚ pgsqlé…ç½®ï¼ˆæ–°å»ºæ•°æ®åº“ï¼‰ é…ç½®kongè·¯ç”± æ³¨æ„äº‹é¡¹ å°½é‡å®‰è£…é«˜ç‰ˆæœ¬ï¼Œé˜²æ­¢å’Œpgsqlä¸å…¼å®¹ã€‚ 1.å®‰è£…kong éœ€è¦å®‰è£…kong å®‰è£…pgsql å®˜æ–¹æ–‡æ¡£æä¾›çš„å¿«é€Ÿå®‰è£…åœ°å€https://docs.konghq.com/install/centos/?_ga=2.182378343.1594956911.1543481061-735966922.1539239867 step1:baseurl=https://kong.bintray.com/kong-community-edition-rpm/centos/7 å„ä¸ªç‰ˆæœ¬çš„åœ°å€ï¼Œä¸‹è½½è¦å®‰è£…çš„ç‰ˆæœ¬ã€‚wget https://kong.bintray.com/kong-community-edition-rpm/centos/7/kong-community-edition-0.14.1.el7.noarch.rpmsrep2:æ‰§è¡Œä¸‹è¾¹å‘½ä»¤:12sudo yum install epel-releasesudo yum install kong-community-edition-0.14.1.*.noarch.rpm --nogpgcheck å®‰è£…å®Œæˆï¼Œè¿™ä¸ªæ—¶å€™æ˜¯èµ·ä¸æ¥é¢ï¼Œå› ä¸ºæ²¡æœ‰å®‰è£…pgsqlã€‚ 2.å®‰è£…postgresql10å°½é‡å®‰è£…é«˜ç‰ˆæœ¬ï¼Œé˜²æ­¢å’Œpgsqlä¸å…¼å®¹,ä¸ºäº†é¿å…é‡‡å‘ï¼Œé€‰æ‹©kong-community-edition-0.14.1.el7.noarch.rpmç‰ˆæœ¬ï¼Œå½“ç„¶ä¹Ÿåœ¨æµ‹è¯•æœºæµ‹è¯•æ²¡æœ‰é—®é¢˜ã€‚å®˜æ–¹åœ°å€https://www.postgresql.org/download/linux/redhat/ å¯ä»¥é€‰æ‹©å¯¹éœ€å®‰è£…çš„å¯¹åº”çš„ç‰ˆæœ¬ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆå®‰è£…å‘½ä»¤ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯10.6 postgresql10å®‰è£…ä¸å¯åŠ¨123456yum install https://download.postgresql.org/pub/repos/yum/10/redhat/rhel-7-x86_64/pgdg-centos10-10-2.noarch.rpm yum install postgresql10 yum install postgresql10-server/usr/pgsql-10/bin/postgresql-10-setup initdb systemctl enable postgresql-10 systemctl start postgresql-10 å®‰è£…å®Œæˆåï¼Œè¿˜éœ€è¦åšï¼š é…ç½®postgrepsç”¨æˆ·ã€‚ æ–°å¢å’Œæ•°æ®åº“ã€‚ é…ç½®è¿œç¨‹è¿æ¥ã€‚ æ·»åŠ ç”¨æˆ·ä»¥åŠæ–°å¢æ•°æ®ï¼š123456789sudo -s //å–å¾—rootæƒé™su - postgres psql -U postgres //è¿æ¥æœ¬åœ°æ•°æ®postgres=# CREATE USER kong WITH LOGIN PASSWORD &apos;kong&apos;; //åˆ›å»ºç”¨æˆ·postgres-# CREATE ROLE //è¿”å›CREATE ROLEï¼Œè¡¨ç¤ºåˆ›å»ºç”¨æˆ·æˆåŠŸpostgres=# CREATE DATABASE kong; //åˆ›å»ºæ•°æ®åº“CREATE DATABASE //è¿”å›CREATE DATABASEï¼Œè¡¨ç¤ºåˆ›å»ºæ•°æ®åº“æˆåŠŸ. ç„¶ååˆå§‹åŒ–æ•°æ®åº“:sudo /usr/local/bin/kong migrations up ä¿®æ”¹pgsql,é…ç½®è¿œç¨‹è¿æ¥ï¼šæ‰§è¡Œvim /var/lib/pgsql/10/data/pg_hba.conf1234//ä¿®æ”¹ 127.0.0.1/32 ä¸ºtrusthost all all 127.0.0.1/32 trust//æ·»åŠ ä¸‹è¾¹è¿™æ¡è®°å½•ï¼Œç”¨äºsslè¿æ¥host all all 0.0.0.0/0 md5 æ‰§è¡Œvim /var/lib/pgsql/10/data/postgresql.confæ·»åŠ ä¸€ä¸‹ä¿¡æ¯:1listen_addresses = &apos;*&apos; //å…è®¸æ‰€æœ‰çš„ipè®¿é—®postgres 3.é…ç½®kong.confæ‰§è¡Œ vi /etc/kong/kong.conf 12345pg_host = 127.0.0.1 # The PostgreSQL host to connect to.pg_port = 5432 # The port to connect to.pg_user = kong # The username to authenticate if required.pg_password = kong # The password to authenticate if required.pg_database = kong # The database name to connect to. æ‰§è¡Œsudo /usr/local/bin/kong start -c /etc/kong/kong.conf,æç¤ºKong startedåˆ™ä»£è¡¨å¯åŠ¨æˆåŠŸ curl -i http://localhost:8001/,æµ‹è¯•kongæ˜¯å¦å¯åŠ¨ã€‚ä¹Ÿå¯ä»¥è®¿é—®http://host:8000/,æ¥ç¡®å®škongæ˜¯å¦èµ·æ¥ã€‚å› ä¸ºæ­¤æ—¶æˆ‘ä»¬å°šæœªé…ç½®ä»»ä½•æœåŠ¡ã€è·¯ç”±ï¼Œè®¿é—®ä¼šè¿”å›404ï¼Œå¦‚ä¸‹ï¼š 4.é…ç½®dashboardå‰ç½®æ“ä½œï¼šéœ€è¦å®‰è£…nodejssudo yum install nodejs kongæä¾›ä¸€å¥—apiï¼Œç”¨äºåŠ¨æ€ç®¡æœåŠ¡ã€è·¯ç”±ã€æ’ä»¶ç­‰ã€‚å½“ç„¶æœ‰å¼€æºçš„dashboardï¼Œè¿™æ ·æˆ‘ä»¬æ“ä½œèµ·æ¥æ›´æ–¹ä¾¿ã€‚å¼€æºé¡¹ç›®åœ°å€https://github.com/PGBI/kong-dashboard å®‰è£…å‘½ä»¤npm install -g kong-dashboard å¯åŠ¨å‘½ä»¤ï¼šnohup kong-dashboard start --kong-url http://localhost:8001 /dev/null 2&gt;&amp;1 &amp; ä¸ºäº†å®‰å…¨èµ·è§ï¼Œå¯ä»¥å§å¯åŠ¨kongçš„è´¦æˆ·å¯†ç æ”¾åœ¨workçš„ç¯å¢ƒå˜é‡é‡Œã€‚ä¿®æ”¹workçš„ç¯å¢ƒå˜é‡ vi ~.bash_profileï¼Œæ·»åŠ passwordå‚æ•°ã€‚kong-dashboard start \\ â€“kong-url http://kong:8001 \\ â€“basic-auth work=$password 5.æ—¥å¿—ç›®å½•ä»¥åŠå¯åŠ¨ç›¸å…³æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶tail -f /usr/local/kong/logs/error.log kongé…ç½®æ–‡ä»¶é»˜è®¤åœ°å€ä¸º /ect/kong/kong.confæƒ³è¦åˆ é™¤postgreSqlï¼Œéœ€è¦å…ˆæ–­å¼€æ‰€æœ‰è¿æ¥sudo ps aux | grep scidb | xargs sudo kill -9 å¯åŠ¨å‘½ä»¤sudo /usr/local/bin/kong start -c /etc/kong/kong.conf 6.é‡åˆ°é—®é¢˜æ²™ç›’é¡¹ç›®éƒ¨ç½²çš„æ—¶å€™ï¼Œæˆ‘æŠŠé¡¹ç›®ä¸Šä¼ åˆ°äº† /home/work/kong/ç›®å½•ä¸‹ï¼Œå¹¶å°†å…¶è½¯è¿åˆ°äº†/usr/local/share/lua/ç›®å½•ä¸‹ã€‚ã€ å†å¯åŠ¨kongæ—¶ï¼ŒæŠ¥é”™: 1234567891011121314151617181920212223242526272829303132332018/12/06 15:26:01 [error] 7684#0: init_worker_by_lua error: /usr/local/share/lua/5.1/kong/init.lua:244: module &apos;resty.worker.events&apos; not found:Failed loading module resty.worker.events in LuaRocks rock lua-resty-worker-events 0.3.3-1 no field package.preload[&apos;resty.worker.events&apos;] no file &apos;./resty/worker/events.lua&apos; no file &apos;./resty/worker/events/init.lua&apos; no file &apos;/usr/local/openresty/site/lualib/resty/worker/events.ljbc&apos; no file &apos;/usr/local/openresty/site/lualib/resty/worker/events/init.ljbc&apos; no file &apos;/usr/local/openresty/lualib/resty/worker/events.ljbc&apos; no file &apos;/usr/local/openresty/lualib/resty/worker/events/init.ljbc&apos; no file &apos;/usr/local/openresty/site/lualib/resty/worker/events.lua&apos; no file &apos;/usr/local/openresty/site/lualib/resty/worker/events/init.lua&apos; no file &apos;/usr/local/openresty/lualib/resty/worker/events.lua&apos; no file &apos;/usr/local/openresty/lualib/resty/worker/events/init.lua&apos; no file &apos;/usr/local/openresty/luajit/share/luajit-2.1.0-beta3/resty/worker/events.lua&apos; no file &apos;/usr/local/share/lua/5.1/resty/worker/events.lua&apos; no file &apos;/usr/local/share/lua/5.1/resty/worker/events/init.lua&apos; no file &apos;/usr/local/openresty/luajit/share/lua/5.1/resty/worker/events.lua&apos; no file &apos;/usr/local/openresty/luajit/share/lua/5.1/resty/worker/events/init.lua&apos; no file &apos;/root/.luarocks/share/lua/5.1/resty/worker/events.lua&apos; no file &apos;/root/.luarocks/share/lua/5.1/resty/worker/events/init.lua&apos; no file &apos;/usr/local/openresty/site/lualib/resty/worker/events.so&apos; no file &apos;/usr/local/openresty/lualib/resty/worker/events.so&apos; no file &apos;./resty/worker/events.so&apos; no file &apos;/usr/local/lib/lua/5.1/resty/worker/events.so&apos; no file &apos;/usr/local/openresty/luajit/lib/lua/5.1/resty/worker/events.so&apos; no file &apos;/usr/local/lib/lua/5.1/loadall.so&apos; no file &apos;/root/.luarocks/lib/lua/5.1/resty/worker/events.so&apos; no file &apos;/usr/local/openresty/site/lualib/resty.so&apos; no file &apos;/usr/local/openresty/lualib/resty.so&apos; no file &apos;./resty.so&apos; no file &apos;/usr/local/lib/lua/5.1/resty.so&apos; no file &apos;/usr/local/openresty/luajit/lib/lua/5.1/resty.so&apos; no file &apos;/usr/local/lib/lua/5.1/loadall.so&apos; no file &apos;/root/.luarocks/lib/lua/5.1/resty.so&apos; æœ€ç»ˆæˆ‘æŠŠé¡¹ç›®ä¸Šä¼ åˆ°äº†/usr/local/share/releas/ç›®å½•ä¸‹ï¼Œå¹¶å°†å…¶è½¯è¿åˆ°äº†/usr/local/share/lua/ä¸‹ï¼Œå¯åŠ¨å¹¶æ²¡æœ‰å‡ºç°æ”¹é—®é¢˜. çº¿ç´¢ï¼šhttps://github.com/Kong/kong/issues/2838","tags":[{"name":"kong","slug":"kong","permalink":"http://yoursite.com/tags/kong/"}]},{"title":"å¦‚ä½•å»ºç«‹ä¸€ä¸ªcomposerç§æœ‰åŒ…","date":"2018-09-28T09:11:00.000Z","path":"2018/09/28/å¦‚ä½•å»ºç«‹ä¸€ä¸ªcomposerç§æœ‰åŒ…/","text":"æœ€è¿‘å‘ç°åˆ†å¸ƒå¼é”åœ¨å¾ˆå¤šé¡¹ç›®éƒ½æœ‰æ‰€ç”¨åˆ°,æ‰€ä»¥æƒ³æŠŠä¹‹å‰å®Œæˆçš„ä»£ç å°è£…æˆpearåŒ…,ä¾›å¤§å®¶ä½¿ç”¨ã€‚ä½†æ˜¯å‘ç°è‡ªå·±å¯¹composerå¹¶ä¸æ˜¯å¾ˆç†Ÿæ‚‰,æ‰€ä»¥å­¦ä¹ ä¸€ç•ª,åœ¨æ­¤è®°å½•ä»¥é˜²è‡ªå·±å¿˜è®°ã€‚ æ–°å»ºä»“åº“$ git clone git@gitlab.renrenche.com:web/jugg.git$ cd jugg conmposer åˆå§‹åŒ–composer init 123456789101112131415161718//åŒ…åPackage name (&lt;vendor&gt;/&lt;name&gt;) [lijian/test_composer]: jugg/jugg//æè¿°Description []: åŸºäºredisçš„åˆ†å¸ƒå¼é”//ä½œè€…Author [, n to skip]: Maxie lj &lt;xiaolijian110@163.com&gt;//æœ€å°ç¨³å®šç‰ˆæœ¬Minimum Stability []: dev//éµå¾ªåè®®License []: MIT//ä¾èµ–Would you like to define your dependencies (require) interactively [yes]? yesSearch for a package: phpEnter the version constraint to require (or leave blank to use the latest version):Using version ^7.0 for php ç”Ÿæˆcomposer.jsonæ–‡ä»¶ 12345678910111213141516171819&#123; &quot;name&quot;: &quot;jugg/jugg&quot;, &quot;description&quot;: &quot;åŸºäºredisçš„åˆ†å¸ƒå¼é”&quot;, &quot;type&quot;: &quot;library&quot;, &quot;require&quot;: &#123; &quot;php&quot;: &quot;^7.0&quot; &#125;, &quot;require-dev&quot;: &#123; &quot;php&quot;: &quot;7&quot; &#125;, &quot;license&quot;: &quot;MIT&quot;, &quot;authors&quot;: [ &#123; &quot;name&quot;: &quot;Maxie lj&quot;, &quot;email&quot;: &quot;xiaolijian110@163.com&quot; &#125; ], &quot;minimum-stability&quot;: &quot;dev&quot;&#125; ç”Ÿæˆè‡ªåŠ¨åŠ è½½ï¼ˆpsr-4ï¼‰åœ¨composer.json æ–‡ä»¶é‡Œæ·»åŠ 123456789101112131415161718&#123; &quot;name&quot;: &quot;jugg/jugg&quot;, &quot;description&quot;: &quot;åŸºäºredisçš„åˆ†å¸ƒå¼é”&quot;, &quot;type&quot;: &quot;library&quot;, &quot;license&quot;: &quot;MIT&quot;, &quot;authors&quot;: [ &#123; &quot;name&quot;: &quot;Maxie lj&quot;, &quot;email&quot;: &quot;xiaolijian110@163.com&quot; &#125; ], &quot;autoload&quot;: &#123; &quot;psr-4&quot;: &#123; &quot;Jugg\\\\&quot;: &quot;jugg&quot; &#125; &#125;, &quot;minimum-stability&quot;: &quot;dev&quot;&#125; æ‰§è¡Œcomposer install å°±ä¼šç”Ÿæˆä¸€ä¸ªè‡ªåŠ¨åŠ è½½æ–‡ä»¶ ç„¶åæˆ‘ä»¬å°±å¯ä»¥æŒ‰ç…§psr-4è§„èŒƒå¼€å‘æˆ‘ä»¬pearåŒ…äº†ã€‚ æµ‹è¯•æˆ‘ä»¬å¯ä»¥åœ¨æµ‹è¯•æ–‡ä»¶é‡Œå¼•å…¥autoload.phpæ–‡ä»¶,è¿™æ ·å°±å®ç°äº†è‡ªåŠ¨åŠ è½½ã€‚ 1require './vendor/autoload.php'; è¿™æ ·å°±å¯ä»¥æ­£å¸¸çš„æµ‹è¯•äº† ä¸Šä¼ ä»£ç åˆ°gitlabæˆ–è€…githubå½“æˆ‘ä»¬å¼€å®Œçš„æ—¶å€™,éœ€è¦å°†æˆ‘ä»¬çš„ä»£ç ä¸Šä¼ åˆ°è¿œç¨‹ä»£ç åº“ã€‚ éœ€è¦æ³¨æ„çš„äº‹ ä¸€å®šä¸è¦è®².gitæ–‡ä»¶ä¸Šä¼ ã€‚ å…¶ä»–é¡¹ç›®å¼•å…¥å› ä¸ºæ²¡æœ‰ä¸Šä¼ åˆ°pagelist,æ‰€ä»¥æˆ‘ä»¬æš‚æ—¶æ˜¯å…¬å¸ç§æœ‰åŒ…ã€‚ å¦‚æœéœ€è¦å†é¡¹ç›®é‡Œå¼•å…¥ç§æœ‰åŒ…,éœ€è¦åœ¨é¡¹ç›®çš„composer.jsonæ–‡ä»¶é‡Œæ·»åŠ ã€‚ 1234567891011121314151617&quot;jugg&quot;: &#123; &quot;type&quot;:&quot;package&quot;, &quot;package&quot;: &#123; &quot;name&quot;: &quot;jugg&quot;, &quot;version&quot;: &quot;v1.1&quot;, &quot;source&quot;: &#123; &quot;type&quot;: &quot;git&quot;, &quot;url&quot;: &quot;git@gitlab.renrenche.com:web/jugg.git&quot;, &quot;reference&quot;: &quot;master&quot; &#125;, &quot;autoload&quot;: &#123; &quot;psr-4&quot;: &#123; &quot;Jugg\\\\&quot;: &quot;jugg&quot; &#125; &#125; &#125; &#125; å®Œæ•´æ–‡ä»¶: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129&#123; &quot;name&quot;: &quot;laravel/lumen&quot;, &quot;description&quot;: &quot;The Laravel Lumen Framework.&quot;, &quot;keywords&quot;: [ &quot;framework&quot;, &quot;laravel&quot;, &quot;lumen&quot; ], &quot;license&quot;: &quot;MIT&quot;, &quot;type&quot;: &quot;project&quot;, &quot;repositories&quot;: &#123; &quot;packagist&quot;: &#123; &quot;type&quot;: &quot;composer&quot;, &quot;url&quot;: &quot;https://packagist.phpcomposer.com&quot; &#125;, &quot;0&quot;: &#123; &quot;type&quot;: &quot;package&quot;, &quot;package&quot;: &#123; &quot;name&quot;: &quot;sdk/clusterproxy&quot;, &quot;version&quot;: &quot;1.0.3&quot;, &quot;source&quot;: &#123; &quot;type&quot;: &quot;git&quot;, &quot;url&quot;: &quot;git@gitlab.renrenche.com:sdk/clusterproxy.git&quot;, &quot;reference&quot;: &quot;master&quot; &#125;, &quot;autoload&quot;: &#123; &quot;psr-4&quot;: &#123; &quot;Cluster\\\\&quot;: &quot;src/Cluster&quot; &#125; &#125; &#125; &#125;, &quot;1&quot;: &#123; &quot;type&quot;: &quot;package&quot;, &quot;package&quot;: &#123; &quot;name&quot;: &quot;sdk/dingtalk-alarm-php-sdk&quot;, &quot;version&quot;: &quot;1.0&quot;, &quot;source&quot;: &#123; &quot;type&quot;: &quot;git&quot;, &quot;url&quot;: &quot;git@gitlab.renrenche.com:sdk/dingtalk-alarm-php-sdk.git&quot;, &quot;reference&quot;: &quot;master&quot; &#125;, &quot;autoload&quot;: &#123; &quot;psr-4&quot;: &#123; &quot;Rrc\\\\&quot;: &quot;src/Rrc/&quot; &#125; &#125; &#125; &#125;, &quot;2&quot;: &#123; &quot;type&quot;:&quot;package&quot;, &quot;package&quot;: &#123; &quot;name&quot;: &quot;sdk/prometheus-php-sdk&quot;, &quot;version&quot;: &quot;1.0&quot;, &quot;source&quot;: &#123; &quot;type&quot;: &quot;git&quot;, &quot;url&quot;: &quot;git@gitlab.renrenche.com:sdk/prometheus-php-sdk.git&quot;, &quot;reference&quot;: &quot;master&quot; &#125;, &quot;autoload&quot;: &#123; &quot;psr-4&quot;: &#123; &quot;Rrc\\\\&quot;: &quot;src/Rrc/&quot; &#125; &#125; &#125; &#125;, &quot;jugg&quot;: &#123; &quot;type&quot;:&quot;package&quot;, &quot;package&quot;: &#123; &quot;name&quot;: &quot;jugg&quot;, &quot;version&quot;: &quot;v1.1&quot;, &quot;source&quot;: &#123; &quot;type&quot;: &quot;git&quot;, &quot;url&quot;: &quot;git@gitlab.renrenche.com:web/jugg.git&quot;, &quot;reference&quot;: &quot;master&quot; &#125;, &quot;autoload&quot;: &#123; &quot;psr-4&quot;: &#123; &quot;Jugg\\\\&quot;: &quot;jugg&quot; &#125; &#125; &#125; &#125; &#125;, &quot;require&quot;: &#123; &quot;php&quot;: &quot;&gt;=7.0&quot;, &quot;laravel/lumen-framework&quot;: &quot;5.5.*&quot;, &quot;vlucas/phpdotenv&quot;: &quot;~2.2&quot;, &quot;guzzlehttp/guzzle&quot;: &quot;^6.2&quot;, &quot;sdk/clusterproxy&quot;: &quot;^1.0&quot;, &quot;illuminate/redis&quot;: &quot;^5.3&quot;, &quot;peixinchen/mns&quot;: &quot;^1.0&quot;, &quot;mockery/mockery&quot;: &quot;^0.9.5&quot;, &quot;firebase/php-jwt&quot;: &quot;^4.0&quot;, &quot;sdk/dingtalk-alarm-php-sdk&quot;: &quot;^1.0&quot;, &quot;sdk/prometheus-php-sdk&quot;: &quot;^1.0&quot;, &quot;predis/predis&quot;: &quot;^1.1&quot;, &quot;solarium/solarium&quot;: &quot;^3.8&quot;, &quot;mongodb/mongodb&quot;: &quot;^1.3&quot;, &quot;jugg&quot;: &quot;^1.0&quot; &#125;, &quot;require-dev&quot;: &#123; &quot;fzaninotto/faker&quot;: &quot;~1.4&quot;, &quot;phpunit/phpunit&quot;: &quot;~6.0&quot;, &quot;mockery/mockery&quot;: &quot;~0.9&quot;, &quot;phpstan/phpstan&quot;: &quot;^0.9.2&quot; &#125;, &quot;autoload&quot;: &#123; &quot;psr-4&quot;: &#123; &quot;Rrc\\\\&quot;: &quot;./&quot; &#125; &#125;, &quot;autoload-dev&quot;: &#123; &quot;classmap&quot;: [ &quot;tests/&quot;, &quot;database/&quot; ] &#125;, &quot;scripts&quot;: &#123; &quot;post-root-package-install&quot;: [ &quot;php -r \\&quot;copy(&apos;.env.example&apos;, &apos;.env&apos;);\\&quot;&quot; ] &#125;, &quot;minimum-stability&quot;: &quot;dev&quot;, &quot;prefer-stable&quot;: true, &quot;config&quot;: &#123; &quot;optimize-autoloader&quot;: true &#125;&#125; ç„¶åæ‰§è¡Œcomposer require jugg&lt;åŒ…å&gt; å°±å¯ä»¥å¼•å…¥åˆ°é¡¹ç›®é‡Œäº†ã€‚","tags":[{"name":"composer","slug":"composer","permalink":"http://yoursite.com/tags/composer/"}]},{"title":"ä½¿ç”¨guzzleå¹¶è¡Œè¯·æ±‚","date":"2018-09-28T09:10:05.000Z","path":"2018/09/28/ä½¿ç”¨guzzleå¹¶è¡Œè¯·æ±‚/","text":"èƒŒæ™¯ç”±äºæ‹å–é¡¹ç›®ç‰¹æœ‰çš„ç‚¹ç‰¹, ä¼šå¯¼è‡´åœ¨å¼€æ‹æ˜¯æœ‰ç¬æ—¶çš„é«˜æµé‡ã€‚åç«¯ç³»ç»Ÿä¼šæ¯ä¸ªå‡ºä»·æ’åº, ç”±äºé«˜qpså¯¼è‡´æ’åºä¼šæœ‰é‡å¤çš„æƒ…å†µ,ã€‚ä¸ºäº†è§£å†³é®æ©æ ·çš„é—®é¢˜,å°±å†™äº†ä¸€ä¸ªåˆ†å¸ƒå¼é”, ç”¨äºè§£å†³æ’åºå†²çªã€‚ç”¨guzzleå†™äº†ä¸€ä¸ªå‹æµ‹è„šæœ¬ã€‚ å®ç°é¦–å…ˆå‹æµ‹æ˜¯ä¸ºäº†åŒä¸€æ—¶åˆ»å‘é€æŒ‡å®šæ•°é‡çš„è¯·æ±‚åˆ°ç›®æ ‡æ¥å£ã€‚æ‰€ä»¥ä¸²è¡Œè¯çš„è¯·æ±‚æ˜¯æ— æ³•guzzle æ”¯æŒç”¨poolå®ç°å¹¶è¡Œçš„è¯·æ±‚ã€‚å®˜æ–¹æ–‡æ¡£ : å®˜æ–¹æ–‡æ¡£æ”¯æŒ æ–‡æ¡£ä¸­å¹¶æ²¡æœ‰æç¤ºå¦‚ä½•å‘é€POSTè¯·æ±‚, é¡¾ç¢ç£¨ä¸€ä¸‹: å¹¶è¡Œæ–¹å¼è¯·æ±‚: 12345678910111213141516171819202122232425262728293031$client = new Client(['base_uri' =&gt; '10.171.22.45:5005', 'timeout' =&gt; 10]); $requests = function ($total) &#123; $uri = 'api/v1/bid'; for ($i = 0; $i &lt; $total; $i++) &#123; yield new Request('POST', $uri, ['Content-type' =&gt; 'application/json'],json_encode([ 'car_dealer_id'=&gt; (string)rand(1,20000), 'bid_price' =&gt; \"4\", 'car_id' =&gt; \"206431344\", 'fr' =&gt; 'bd_other', 'platform' =&gt; 'MO', 'source' =&gt; 'C2Bç«ä»·', 'sale_type' =&gt; 'å–è½¦', 'car_dealer_city' =&gt; 'æ·±åœ³', 'app_version' =&gt; \"3.2\" ])); &#125; &#125;; $pool = new Pool($client, $requests(100), [ 'concurrency' =&gt; 5, 'fulfilled' =&gt; function ($response, $index) &#123; var_dump($response-&gt;getBody()-&gt;getContents()); &#125;, 'rejected' =&gt; function ($reason, $index) &#123; var_dump($reason-&gt;getMessage()); &#125;, ]); $promise = $pool-&gt;promise(); $promise-&gt;wait(); ä¸²è¡Œ: 123456789101112131415161718192021for ($i =1 ; $i&lt;20;$i++) &#123; echo time(); $org_res[] = $this-&gt;client-&gt;request('POST', 'api/v1/bid',['form_params'=&gt; [ 'car_dealer_id'=&gt; rand(1,20000), 'bid_price' =&gt; 4, 'car_id' =&gt; 206431332, 'fr' =&gt; 'bd_other', 'platform' =&gt; 'MO', 'source' =&gt; 'C2Bç«ä»·', 'sale_type' =&gt; 'å–è½¦', 'car_dealer_city' =&gt; 'æ·±åœ³', 'app_version' =&gt; 3.2 ]]);&#125;foreach ($org_res as $val) &#123; $resdata = $val-&gt;getBody()-&gt;getContents();&#125;var_dump($resdata);die; è¯·æ±‚ç»“æœ: ä¸¤è€…åŒºåˆ« ä»æ€§èƒ½ä¸Šæ¥çœ‹,20æ¬¡è¯·æ±‚, å¹¶è¡Œè¯·æ±‚è€—æ—¶2ç§’, ä¸²è¡Œè¯·æ±‚3ç§’ã€‚ å½“è¯·æ±‚åŠ åˆ°100æ¬¡çš„æ—¶å€™, å¹¶è¡Œè¯·æ±‚è€—æ—¶6ç§’, ä¸²è¡Œè¯·æ±‚è€—æ—¶27ç§’,è¿™ä¸ªæ—¶å€™å°±èƒ½ä½“ç°å‡ºå¹¶è¡Œå’Œä¸²è¡Œçš„å´åˆ«ç›¸å·®21ç§’ã€‚ ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¹ˆå·®è·,å†ä¸Šä¸€å¼ å›¾å’Œä»£ç ,æ‰“å°å‡ºæ¥å¼€å§‹ç»“æŸæ—¶é—´ã€‚ å¹¶è¡Œ:1234567891011121314151617181920212223242526272829303132333435363738å¹¶è¡Œè¯·æ±‚ echo 'æ€»çš„å¼€å§‹:'.microtime().'&lt;br&gt;'; $client = new Client(['base_uri' =&gt; '10.171.22.45:5005', 'timeout' =&gt; 10]); $requests = function ($total) &#123; $uri = 'api/v1/bid'; for ($i = 0; $i &lt; $total; $i++) &#123; $car_dealer_id = (string)rand(1,1000000); echo 'å¼€å§‹'.microtime().' car_dealer_id:'.$car_dealer_id.\"&lt;br&gt;\"; yield new Request('POST', $uri, ['Content-type' =&gt; 'application/json'],json_encode([ 'car_dealer_id'=&gt; (string)$car_dealer_id, 'bid_price' =&gt; \"4\", 'car_id' =&gt; \"206431344\", 'fr' =&gt; 'bd_other', 'platform' =&gt; 'MO', 'source' =&gt; 'C2Bç«ä»·', 'sale_type' =&gt; 'å–è½¦', 'car_dealer_city' =&gt; 'æ·±åœ³', 'app_version' =&gt; \"3.2\" ])); &#125; &#125;; $pool = new Pool($client, $requests(100), [ 'concurrency' =&gt; 5, 'fulfilled' =&gt; function ($response, $index) &#123; var_dump($response-&gt;getBody()-&gt;getContents()); echo microtime().\"&lt;br&gt;\"; &#125;, 'rejected' =&gt; function ($reason, $index) &#123; var_dump($reason-&gt;getMessage()); echo microtime(); &#125;, ]); $promise = $pool-&gt;promise(); $promise-&gt;wait(); echo 'æ€»çš„ç»“æŸ:'.microtime().'&lt;br&gt;'; 100æ¬¡è¯·æ±‚çš„è¿”å›ç»“æœ ä¸²è¡Œ: 123456789101112131415161718192021222324 for ($i =1 ; $i&lt;100;$i++) &#123; echo 'å¼€å§‹æ—¶é—´'.microtime().\"&lt;br&gt;\"; $ret = $this-&gt;client-&gt;request('POST', 'api/v1/bid',['form_params'=&gt; [ 'car_dealer_id'=&gt; rand(1,2000000), 'bid_price' =&gt; 4, 'car_id' =&gt; 206431332, 'fr' =&gt; 'bd_other', 'platform' =&gt; 'MO', 'source' =&gt; 'C2Bç«ä»·', 'sale_type' =&gt; 'å–è½¦', 'car_dealer_city' =&gt; 'æ·±åœ³', 'app_version' =&gt; 3.2 ]]); $org_res[] = $ret; echo 'ç»“æŸæ—¶é—´'.microtime().\"&lt;br&gt;\"; var_export($ret-&gt;getBody()-&gt;getContents()); &#125;// foreach ($org_res as $val) &#123;// $resdata[] = $val-&gt;getBody()-&gt;getContents();// &#125;// var_dump($resdata); die; 100æ¬¡è¯·æ±‚çš„è¿”å›ç»“æœ æ‰€ä»¥å¯ä»¥çœ‹å‡º,å¹¶è¡Œè¯·æ±‚æ˜¯å…ˆç”Ÿæˆæ‰€æœ‰è¯·æ±‚ï¼ˆè¿™ä¸ªä¸Šé™å’Œconcurrency å‚æ•°æœ‰å…³ï¼‰,å†ç­‰å¾…ç»“æœã€‚å¦‚æœè¾¾åˆ°å½“å‰å¹¶è¡Œçš„ä¸Šçº¿,å°±ç­‰å¾…è¯·æ±‚ç»“æŸå†ç”Ÿæˆæ–°çš„è¯·æ±‚ã€‚ ä¸²è¡Œè¯·æ±‚ä¸ºè¯·æ±‚,ç­‰å¾…ç»“æœç„¶ååœ¨è¯·æ±‚ã€‚ æ‰€ä»¥å¦‚æœè¯·æ±‚é‡å¾ˆå¤§çš„è¯,å°½é‡è¿˜æ˜¯ç”¨å¹¶è¡Œè¯·æ±‚ã€‚","tags":[{"name":"php","slug":"php","permalink":"http://yoursite.com/tags/php/"}]},{"title":"phpåƒåœ¾å›æ”¶","date":"2018-09-12T13:28:00.000Z","path":"2018/09/12/phpåƒåœ¾å›æ”¶/","text":"phpæ˜¯å¦‚ä½•å®ç°å†…å­˜ç®¡ç†çš„?å†…å­˜ç®¡ç†æ— éåŒ…æ‹¬å†…å­˜åˆ†é…ã€å†…å­˜å›æ”¶ã€ä»¥åŠå†…å­˜ä½¿ç”¨ä¼˜åŒ–ã€‚ å†…å­˜ä½¿ç”¨çš„ä¼˜åŒ– åƒåœ¾å›æ”¶æœºåˆ¶ åº•å±‚å†…å­˜åˆ†é… å†…å­˜ä½¿ç”¨çš„ä¼˜åŒ–å¼•ç”¨è®¡æ•°phpçš„å¼•ç”¨ä¸­æœ‰ä¸ªå¼•ç”¨ç»“æ„ä½“ 12345```cstruct _zend_reference &#123; zend_refcondted_h gc; zval val; æŒ‡å‘åŸæ¥çš„value.&#125;; 123456789101112131415161718å…¶ä¸­`zend_refcondted_h` ä¾¿æ˜¯gcä¾¿æ˜¯å½“å‰å˜é‡è¢«å¼•ç”¨çš„æ¬¡æ•°,è¿™ä¸ªå‚æ•°ä¼šåœ¨å˜é‡å›æ”¶çš„æ—¶å€™ç”¨åˆ°ã€‚zend_refcondted_h :```ctypedef struct _zend_refcounted_h &#123; uint32_t refcount; /* reference counter 32-bit */ union &#123; struct &#123; ZEND_ENDIAN_LOHI_3( zend_uchar type, zend_uchar flags, /* used for strings &amp; objects */ uint16_t gc_info) /* keeps GC root number (or 0) and color */ &#125; v; uint32_t type_info; &#125; u;&#125; zend_refcounted_h; åœ¨å®é™…ä¸­è¿™ä¸ªç»“æ„ä½“åˆ°åº•æ˜¯ä»€ä¹ˆæ ·çš„? å…·ä½“å¯ä»¥ä¸¾ä¾‹æ¥çœ‹ã€‚ 1234$a = 'this is string'; // zend_array (refcount = 1) åªæœ‰$aå¼•ç”¨äº†zend_array$b = &amp;$a; // zend_array (refcount = 2) $aã€$bå¼•ç”¨äº†zend_array$c = $b; // zend_array (refcount = 3) $aã€$bã€$cå¼•ç”¨äº†zend_arrayunset($b); // zend_array (refcount = 2) $aã€$cå¼•ç”¨äº†zend_array å¹¶ä¸æ˜¯æ‰€æœ‰çš„å˜é‡ç±»å‹éƒ½ä¼šä½¿ç”¨å¼•ç”¨è®¡æ•°, ä¾‹å¦‚ æ•´å½¢ã€æµ®ç‚¹å‹ã€å¸ƒå°”å‹ã€NUll(åœ¨phpä¸­è¿™æ˜¯ä¸€ä¸ªå˜é‡ç±»å‹)ç­‰é‡‡ç”¨äº†æ·±æ‹·è´,å³åªè¦è¿™å‡ ç§å˜é‡èµ‹å€¼, å°±ä¼šç”³è¯·ä¸€æ¬¾ä¸€å—å†…å­˜å†™å…¥ä¸€ä¸ªæ–°çš„å˜é‡ç»“æ„ï¼ˆæ³¨æ„è¿™é‡Œä¸æ˜¯å¼•ç”¨ç»“æ„ï¼‰,å½“ç„¶è¿™äº›ç±»å‹ä¸ä¼šå…¬ç”¨valueã€‚ å†™æ—¶å¤åˆ¶å½“ç„¶åªæœ‰å¼•ç”¨è®¡æ•°æ˜¯ä¸å¤Ÿçš„, å› ä¸ºå˜é‡ä¼šå‘ç”Ÿèµ‹å€¼çš„æƒ…å†µã€‚æ‰€ä»¥åœ¨æ›´æ”¹æŸä¸€ä¸ªå˜é‡æ—¶, ä¼šå¯¹åŸæ¥çš„å˜é‡è¿›è¡Œæ‹·è´å¹¶èµ‹å€¼ã€‚ ä¸¾ä¸ªæ —å­: 12345$foo = time();$bar = &amp;$b;$si = $a;$c = &apos;123&apos;; å…·ä½“æ•°æ®ç»“æ„çš„å¼•ç”¨è®¡æ•°æƒ…å†µå¦‚ä¸‹å›¾: å†…å­˜å›æ”¶è‡ªåŠ¨gcåœ¨zendæ•°æ®æ¥å£ä¸­æœ‰ä¸€ä¸ªgc.refount,ä»–æ˜¯è‡ªåŠ¨gcçš„å…³é”®ã€‚ åœ¨è‡ªåŠ¨gcæœºåˆ¶ä¸­,å¦‚æœzvalä¸åœ¨æŒ‡å‘valueä¸”å½“å‰valueçš„gc.refountä¸º0æ—¶,ä¼šç›´æ¥é‡Šæ”¾valueã€‚è¿™ç§æƒ…å†µå¤šå‘ç”Ÿäºå‡½æ•°è¿”å›æ—¶ï¼ˆé”€æ¯æ‰€æœ‰å±€éƒ¨å˜é‡ï¼‰ã€å˜é‡ä¿®æ”¹æ—¶ã€ä»¥åŠunsetæ“ä½œçš„æ—¶å€™ã€‚ è¾£é¸¡å›æ”¶é™¤äº†è‡ªåŠ¨gc,è¿˜æœ‰ä¸€ç§æ˜¯è‡ªåŠ¨gcæ— æ³•å¤„ç†çš„åƒåœ¾, è¿™ç§æƒ…å†µç§°ä¸ºå¾ªç¯å¼•ç”¨ã€‚é¡¾åæ€ä¹‰ä¹Ÿå°±æ˜¯è‡ªèº«å†…éƒ¨å˜é‡å¼•ç”¨äº†è‡ªèº«, è¿™ç§æƒ…å†µå¸¸å‡ºç°ä¸objectå’Œarrayã€‚å½“æˆ‘è¯¥å˜é‡zvalè¢«é”€æ¯æ˜¯, ä¸å…¶å¯¹åº”çš„value gc.refcount -1,ä½†æ˜¯å› ä¸ºæœ‰è‡ªèº«å˜é‡æŒ‡å‘è‡ªèº«, æ‰€ä»¥å°±é™·å…¥äº†ä¸€ä¸ªå¾ªç¯:å¦‚æœä¸é”€æ¯è‡ªèº«å˜é‡ value gc.refcountå°±æ— æ³•è‡ªåŠ¨gc, åªæœ‰è‡ªåŠ¨gcæ‰ä¼šé”€æ¯valueã€‚ 1234$a = [1];$a[] = &amp;$a;unset($a); unset($a)æ‰§è¡Œä»¥å ç”±äº\bä¸Šè¿°æƒ…å†µå¯¼è‡´æ— æ³•è‡ªåŠ¨gc,æ‰€ä»¥éœ€è¦å¼•å…¥å¦å¤–ä¸€é’Ÿåƒåœ¾å›æ”¶æœºåˆ¶-åƒåœ¾å›æ”¶å™¨ã€‚ç°åœ¨ä¼šå­˜åœ¨ä¸¤ç§æƒ…å†µçš„æ•°æ®éœ€è¦å›æ”¶ï¼š å½“valueçš„gc.refcount =0 æ˜¯éœ€è¦å›æ”¶ã€‚ å½“valueçš„gc.refcount å‡å°‘ä¸ç­‰äº0ï¼Œä½†æ˜¯å­˜åœ¨å¾ªç¯å¼•ç”¨æ—¶ã€‚ å›æ”¶æœºåˆ¶å½“å‘ç”Ÿvalue gc.refcountå‡å°‘æ—¶ï¼Œåƒåœ¾å›æ”¶æœºåˆ¶ä¼šæŠŠå¯èƒ½æ˜¯åƒåœ¾çš„valueå­˜èµ·æ¥ï¼Œ å½“å¯èƒ½æ˜¯è¾£é¸¡çš„valueåˆ°è¾¾ä¸€å®šæ•°é‡çš„æ—¶å€™å¯åŠ¨åƒåœ¾é‰´åˆ«ç¨‹åºï¼Œç»Ÿä¸€å¤„ç†åƒåœ¾ã€‚å½“ç„¶è¿™é‡Œçš„valueç±»å‹åªæœ‰objectå’Œarrayã€‚ åƒåœ¾å…¼å¤‡ç¨‹åºï¼šå…¶å®åƒåœ¾é‰´åˆ«ç¨‹åºå¾ˆç®€å•ï¼Œé€’å½’éå†è‡ªèº«valueï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨æŒ‡å‘è‡ªèº«çš„å³å¯ã€‚ code:gc åˆå§‹åŒ–1234567891011ZEND_API void gc_init(void)&#123; if (GC_G(buf) == NULL &amp;&amp; GC_G(gc_enabled)) &#123; //åˆå§‹åŒ–buf\bå†…å­˜åŒºåŸŸï¼Œå¤§å°ä¸ºsizeof(gc_root_buffer) * //GC_ROOT_BUFFER_MAX_ENTRIES GC_G(buf) = (gc_root_buffer*) malloc(sizeof(gc_root_buffer) * GC_ROOT_BUFFER_MAX_ENTRIES); //è®¾ç½®_zend_gc_globals.last_unusedä¸º\b\bbugå…¥å£ä½ç½® GC_G(last_unused) = &amp;GC_G(buf)[GC_ROOT_BUFFER_MAX_ENTRIES]; //åˆå§‹åŒ–_zend_gc_globalsçš„å‚æ•° gc_reset(); &#125;&#125; åƒåœ¾å›æ”¶åŠå…¶ä¾èµ– _zend_gc_globals _zend_gc_globals1234567891011121314151617181920212223242526272829typedef struct _zend_gc_globals &#123; zend_bool gc_enabled; zend_bool gc_active; zend_bool gc_full; gc_root_buffer *buf; /* preallocated arrays of buffers */ gc_root_buffer roots; /* list of possible roots of cycles */ gc_root_buffer *unused; /* list of unused buffers */ gc_root_buffer *first_unused; /* pointer to first unused buffer */ gc_root_buffer *last_unused; /* pointer to last unused buffer */ gc_root_buffer to_free; /* list to free */ gc_root_buffer *next_to_free; uint32_t gc_runs; uint32_t collected;#if GC_BENCH uint32_t root_buf_length; uint32_t root_buf_peak; uint32_t zval_possible_root; uint32_t zval_buffered; uint32_t zval_remove_from_buffer; uint32_t zval_marked_grey;#endif gc_additional_buffer *additional_buffer;&#125; zend_gc_globals; gc_enabled æ˜¯å¦ä½¿ä½¿ç”¨gc gc_active æ˜¯å¦åœ¨åƒåœ¾æ£€æŸ¥çš„è¿‡ç¨‹ä¸­ gc_full bufç¼“å†²åŒºæ˜¯å¦å·²æ»¡ *buf ä¸åˆ†é…ç”¨äºä¿å­˜å¯èƒ½ä¸ºåƒåœ¾çš„value roots æŒ‡å‘bufæœ€æ–°åŠ å…¥çš„ä¸€ä¸ªå¯èƒ½åƒåœ¾ unused æŒ‡å‘ç¬¬æœªä½¿ç”¨çš„buffer *first_unused æŒ‡å‘ç¬¬ä¸€ä¸ªæ²¡ç”¨ä½¿ç”¨buffer *last_unused æŒ‡å‘bufferçš„å°¾éƒ¨ to_free ç­‰å¾…é‡Šæ”¾çš„buffer gc_runs ç»Ÿè®¡gcè¿è¡Œçš„æ¬¡æ•° collected ç»Ÿè®¡å·²ç»é‡Šæ”¾çš„åƒåœ¾æ•° phpåƒåœ¾å›æ”¶ä¸­å‡ ä¸ªé‡è¦çš„é¢œè‰²å†™åœ¨zeng_gcçš„å¤‡æ³¨ä¸­ã€‚1234* BLACK (GC_BLACK) - In use or free.* GREY (GC_GREY) - Possible member of cycle.* WHITE (GC_WHITE) - Member of garbage cycle.* PURPLE (GC_PURPLE) - Possible root of cycle. GC_WHITE ç™½è‰²è¡¨ç¤ºåƒåœ¾ GC_PURPLE ç´«è‰²è¡¨ç¤ºå·²æ”¾å…¥ç¼“å†²åŒº GC_GREY ç°è‰²è¡¨ç¤ºå·²ç»è¿›è¡Œäº†ä¸€æ¬¡refcountçš„å‡ä¸€æ“ä½œ GC_BLACK é»‘è‰²æ˜¯é»˜è®¤é¢œè‰²ï¼Œæ­£å¸¸ gcè¿‡ç¨‹ä¸­ä¸»è¦å¤„ç†åŠŸèƒ½çš„å‡½æ•°zend_gc_collect_cycles 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657ZEND_API void ZEND_FASTCALL gc_possible_root(zend_refcounted *ref)&#123; gc_root_buffer *newRoot; if (UNEXPECTED(CG(unclean_shutdown)) || UNEXPECTED(GC_G(gc_active))) &#123; return; &#125; ZEND_ASSERT(GC_TYPE(ref) == IS_ARRAY || GC_TYPE(ref) == IS_OBJECT); ZEND_ASSERT(EXPECTED(GC_REF_GET_COLOR(ref) == GC_BLACK)); ZEND_ASSERT(!GC_ADDRESS(GC_INFO(ref))); GC_BENCH_INC(zval_possible_root); newRoot = GC_G(unused); if (newRoot) &#123; GC_G(unused) = newRoot-&gt;prev; &#125; else if (GC_G(first_unused) != GC_G(last_unused)) &#123; newRoot = GC_G(first_unused); GC_G(first_unused)++; &#125; else &#123; //åƒåœ¾å¤„ç†ï¼Œå½“ç¼“å†²åŒºæ»¡æ—¶ï¼Œç¨‹åºè°ƒç”¨gc_collect_cycleså‡½æ•°ï¼Œæ‰§è¡Œåƒåœ¾å›æ”¶æ“ä½œã€‚ å…¶ä¸­æœ€å…³é”®çš„å‡ æ­¥å°±æ˜¯ //å¦‚æœå½“å‰å¤„äºå¯ä»¥gcçš„çŠ¶æ€ if (!GC_G(gc_enabled)) &#123; return; &#125; GC_REFCOUNT(ref)++; //åƒåœ¾å›æ”¶ gc_collect_cycles(); GC_REFCOUNT(ref)--; if (UNEXPECTED(GC_REFCOUNT(ref)) == 0) &#123; zval_dtor_func(ref); return; &#125; if (UNEXPECTED(GC_INFO(ref))) &#123; return; &#125; newRoot = GC_G(unused); if (!newRoot) &#123; return; &#125; GC_G(unused) = newRoot-&gt;prev; &#125; GC_TRACE_SET_COLOR(ref, GC_PURPLE); GC_INFO(ref) = (newRoot - GC_G(buf)) | GC_PURPLE; newRoot-&gt;ref = ref; newRoot-&gt;next = GC_G(roots).next; newRoot-&gt;prev = &amp;GC_G(roots); GC_G(roots).next-&gt;prev = newRoot; GC_G(roots).next = newRoot; GC_BENCH_INC(zval_buffered); GC_BENCH_INC(root_buf_length); GC_BENCH_PEAK(root_buf_peak, root_buf_length);&#125; \bdebugä»£ç å·²åˆ é™¤ \bæ·±åº¦ä¼˜å…ˆå¯¹å¯¹è±¡æˆ–è€…æ•°æ®çš„æ¯ä¸€ä¸ªå…ƒç´ çš„refcount--å¹¶å°†å…¶æ ‡è®°ä¸ºç°è‰² æ·±åº¦éå†rootçš„æ¯ä¸ªæ¯ä¸ªå˜é‡ï¼Œå¦‚æœæ­¤æ—¶å˜é‡çš„refcountä¸º0ï¼Œåˆ™ä»£è¡¨ç€æ”¹å˜é‡ä¸ºåƒåœ¾ï¼Œå°†å…¶æ ‡è®°ä¸ºåƒåœ¾ï¼Œå¦‚æœä¸ä¸º0ï¼Œåˆ™å°†å…¶æ ‡è®°ä¸ºé»‘è‰²ï¼ˆæ­£å¸¸ï¼‰ã€‚ æ£€æŸ¥rootsæ¸…é™¤æ ‡è®°ä¸ºç™½è‰²çš„åƒåœ¾ã€‚ //TODO åƒåœ¾å›æ”¶æŠ½å‡ºæ¥å‡ºæ¥å†™ã€‚ å…·ä½“ä»£ç ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164ZEND_API int zend_gc_collect_cycles(void)&#123; int count = 0; if (GC_G(roots).next != &amp;GC_G(roots)) &#123; gc_root_buffer *current, *next, *orig_next_to_free; zend_refcounted *p; gc_root_buffer to_free; uint32_t gc_flags = 0; gc_additional_buffer *additional_buffer_snapshot; if (GC_G(gc_active)) &#123; return 0; &#125; GC_TRACE(\"Collecting cycles\"); //æ ‡è¯†gcè¿è¡Œäº†å¤šå°‘æ¬¡ GC_G(gc_runs)++; //æ ‡è¯†å½“å‰æ­£åœ¨gc GC_G(gc_active) = 1; GC_TRACE(\"Marking roots\"); //é‡ç‚¹ gc_mark_roots(); GC_TRACE(\"Scanning roots\"); //é‡ç‚¹ gc_scan_roots(); GC_TRACE(\"Collecting roots\"); additional_buffer_snapshot = GC_G(additional_buffer); count = gc_collect_roots(&amp;gc_flags); GC_G(gc_active) = 0; if (GC_G(to_free).next == &amp;GC_G(to_free)) &#123; /* nothing to free */ GC_TRACE(\"Nothing to free\"); return 0; &#125; /* Copy global to_free list into local list */ to_free.next = GC_G(to_free).next; to_free.prev = GC_G(to_free).prev; to_free.next-&gt;prev = &amp;to_free; to_free.prev-&gt;next = &amp;to_free; /* Free global list */ GC_G(to_free).next = &amp;GC_G(to_free); GC_G(to_free).prev = &amp;GC_G(to_free); orig_next_to_free = GC_G(next_to_free); if (gc_flags &amp; GC_HAS_DESTRUCTORS) &#123; GC_TRACE(\"Calling destructors\"); /* Remember reference counters before calling destructors */ current = to_free.next; while (current != &amp;to_free) &#123; current-&gt;refcount = GC_REFCOUNT(current-&gt;ref); current = current-&gt;next; &#125; /* Call destructors */ current = to_free.next; while (current != &amp;to_free) &#123; p = current-&gt;ref; GC_G(next_to_free) = current-&gt;next; if (GC_TYPE(p) == IS_OBJECT) &#123; zend_object *obj = (zend_object*)p; if (!(GC_FLAGS(obj) &amp; IS_OBJ_DESTRUCTOR_CALLED)) &#123; GC_TRACE_REF(obj, \"calling destructor\"); GC_FLAGS(obj) |= IS_OBJ_DESTRUCTOR_CALLED; if (obj-&gt;handlers-&gt;dtor_obj &amp;&amp; (obj-&gt;handlers-&gt;dtor_obj != zend_objects_destroy_object || obj-&gt;ce-&gt;destructor)) &#123; GC_REFCOUNT(obj)++; obj-&gt;handlers-&gt;dtor_obj(obj); GC_REFCOUNT(obj)--; &#125; &#125; &#125; current = GC_G(next_to_free); &#125; /* Remove values captured in destructors */ current = to_free.next; while (current != &amp;to_free) &#123; GC_G(next_to_free) = current-&gt;next; if (GC_REFCOUNT(current-&gt;ref) &gt; current-&gt;refcount) &#123; gc_remove_nested_data_from_buffer(current-&gt;ref, current); &#125; current = GC_G(next_to_free); &#125; &#125; /* Destroy zvals */ GC_TRACE(\"Destroying zvals\"); GC_G(gc_active) = 1; current = to_free.next; while (current != &amp;to_free) &#123; p = current-&gt;ref; GC_G(next_to_free) = current-&gt;next; GC_TRACE_REF(p, \"destroying\"); if (GC_TYPE(p) == IS_OBJECT) &#123; zend_object *obj = (zend_object*)p; EG(objects_store).object_buckets[obj-&gt;handle] = SET_OBJ_INVALID(obj); GC_TYPE(obj) = IS_NULL; if (!(GC_FLAGS(obj) &amp; IS_OBJ_FREE_CALLED)) &#123; GC_FLAGS(obj) |= IS_OBJ_FREE_CALLED; if (obj-&gt;handlers-&gt;free_obj) &#123; GC_REFCOUNT(obj)++; obj-&gt;handlers-&gt;free_obj(obj); GC_REFCOUNT(obj)--; &#125; &#125; SET_OBJ_BUCKET_NUMBER(EG(objects_store).object_buckets[obj-&gt;handle], EG(objects_store).free_list_head); EG(objects_store).free_list_head = obj-&gt;handle; p = current-&gt;ref = (zend_refcounted*)(((char*)obj) - obj-&gt;handlers-&gt;offset); &#125; else if (GC_TYPE(p) == IS_ARRAY) &#123; zend_array *arr = (zend_array*)p; GC_TYPE(arr) = IS_NULL; /* GC may destroy arrays with rc&gt;1. This is valid and safe. */ HT_ALLOW_COW_VIOLATION(arr); zend_hash_destroy(arr); &#125; current = GC_G(next_to_free); &#125; /* Free objects */ current = to_free.next; while (current != &amp;to_free) &#123; next = current-&gt;next; p = current-&gt;ref; if (EXPECTED(current &gt;= GC_G(buf) &amp;&amp; current &lt; GC_G(buf) + GC_ROOT_BUFFER_MAX_ENTRIES)) &#123; current-&gt;prev = GC_G(unused); GC_G(unused) = current; &#125; efree(p); current = next; &#125; while (GC_G(additional_buffer) != additional_buffer_snapshot) &#123; gc_additional_buffer *next = GC_G(additional_buffer)-&gt;next; efree(GC_G(additional_buffer)); GC_G(additional_buffer) = next; &#125; GC_TRACE(\"Collection finished\"); GC_G(collected) += count; GC_G(next_to_free) = orig_next_to_free; GC_G(gc_active) = 0; &#125; return count;&#125; 123456789101112static void gc_mark_roots(void)&#123; gc_root_buffer *current = GC_G(roots).next; while (current != &amp;GC_G(roots)) &#123; //GC_PURPLE æ ‡è¯†åœ¨ç¼“å†²åŒº if (GC_REF_GET_COLOR(current-&gt;ref) == GC_PURPLE) &#123; gc_mark_grey(current-&gt;ref); &#125; current = current-&gt;next; &#125;&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104static void gc_mark_grey(zend_refcounted *ref)&#123; HashTable *ht; Bucket *p, *end; zval *zv;tail_call: if (GC_REF_GET_COLOR(ref) != GC_GREY) &#123; ht = NULL; GC_BENCH_INC(zval_marked_grey); GC_REF_SET_COLOR(ref, GC_GREY); if (GC_TYPE(ref) == IS_OBJECT) &#123; zend_object_get_gc_t get_gc; zend_object *obj = (zend_object*)ref; if (EXPECTED(!(GC_FLAGS(ref) &amp; IS_OBJ_FREE_CALLED) &amp;&amp; (get_gc = obj-&gt;handlers-&gt;get_gc) != NULL)) &#123; int n; zval *zv, *end; zval tmp; ZVAL_OBJ(&amp;tmp, obj); ht = get_gc(&amp;tmp, &amp;zv, &amp;n); end = zv + n; if (EXPECTED(!ht)) &#123; if (!n) return; while (!Z_REFCOUNTED_P(--end)) &#123; //è¡¨æ˜å½“å‰object sizeä¸º0 if (zv == end) return; &#125; &#125; while (zv != end) &#123; //å¾ªç¯å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œ-- if (Z_REFCOUNTED_P(zv)) &#123; ref = Z_COUNTED_P(zv); GC_REFCOUNT(ref)--; //refcountå·²ç»å‡è¿‡ï¼Œæ ‡è®°ä¸ºç°è‰² gc_mark_grey(ref); &#125; zv++; &#125; if (EXPECTED(!ht)) &#123; ref = Z_COUNTED_P(zv); GC_REFCOUNT(ref)--; goto tail_call; &#125; &#125; else &#123; return; &#125; &#125; else if (GC_TYPE(ref) == IS_ARRAY) &#123; if (((zend_array*)ref) == &amp;EG(symbol_table)) &#123; //æ ‡è¯†æ˜¯æ­£å¸¸éåƒåœ¾ GC_REF_SET_BLACK(ref); return; &#125; else &#123; ht = (zend_array*)ref; &#125; &#125; else if (GC_TYPE(ref) == IS_REFERENCE) &#123; if (Z_REFCOUNTED(((zend_reference*)ref)-&gt;val)) &#123; ref = Z_COUNTED(((zend_reference*)ref)-&gt;val); GC_REFCOUNT(ref)--; goto tail_call; &#125; return; &#125; else &#123; return; &#125; if (!ht-&gt;nNumUsed) return; p = ht-&gt;arData; end = p + ht-&gt;nNumUsed; while (1) &#123; end--; zv = &amp;end-&gt;val; if (Z_TYPE_P(zv) == IS_INDIRECT) &#123; zv = Z_INDIRECT_P(zv); &#125; if (Z_REFCOUNTED_P(zv)) &#123; break; &#125; if (p == end) return; &#125; while (p != end) &#123; zv = &amp;p-&gt;val; if (Z_TYPE_P(zv) == IS_INDIRECT) &#123; zv = Z_INDIRECT_P(zv); &#125; if (Z_REFCOUNTED_P(zv)) &#123; ref = Z_COUNTED_P(zv); GC_REFCOUNT(ref)--; gc_mark_grey(ref); &#125; p++; &#125; zv = &amp;p-&gt;val; if (Z_TYPE_P(zv) == IS_INDIRECT) &#123; zv = Z_INDIRECT_P(zv); &#125; ref = Z_COUNTED_P(zv); GC_REFCOUNT(ref)--; goto tail_call; &#125;&#125; 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798static void gc_scan(zend_refcounted *ref)&#123; HashTable *ht; Bucket *p, *end; zval *zv;tail_call: if (GC_REF_GET_COLOR(ref) == GC_GREY) &#123; if (GC_REFCOUNT(ref) &gt; 0) &#123; //æ‰€æœ‰refount--ä»¥åå¦‚æœè¿˜&gt;0ï¼Œè¯´æ˜éåƒåœ¾ gc_scan_black(ref); &#125; else &#123; //å¦åˆ™åˆ™ä¸ºåƒåœ¾ GC_REF_SET_COLOR(ref, GC_WHITE); if (GC_TYPE(ref) == IS_OBJECT) &#123; zend_object_get_gc_t get_gc; zend_object *obj = (zend_object*)ref; if (EXPECTED(!(GC_FLAGS(ref) &amp; IS_OBJ_FREE_CALLED) &amp;&amp; (get_gc = obj-&gt;handlers-&gt;get_gc) != NULL)) &#123; int n; zval *zv, *end; zval tmp; ZVAL_OBJ(&amp;tmp, obj); ht = get_gc(&amp;tmp, &amp;zv, &amp;n); end = zv + n; if (EXPECTED(!ht)) &#123; if (!n) return; while (!Z_REFCOUNTED_P(--end)) &#123; if (zv == end) return; &#125; &#125; while (zv != end) &#123; if (Z_REFCOUNTED_P(zv)) &#123; ref = Z_COUNTED_P(zv); gc_scan(ref); &#125; zv++; &#125; if (EXPECTED(!ht)) &#123; ref = Z_COUNTED_P(zv); goto tail_call; &#125; &#125; else &#123; return; &#125; &#125; else if (GC_TYPE(ref) == IS_ARRAY) &#123; if ((zend_array*)ref == &amp;EG(symbol_table)) &#123; GC_REF_SET_BLACK(ref); return; &#125; else &#123; ht = (zend_array*)ref; &#125; &#125; else if (GC_TYPE(ref) == IS_REFERENCE) &#123; if (Z_REFCOUNTED(((zend_reference*)ref)-&gt;val)) &#123; ref = Z_COUNTED(((zend_reference*)ref)-&gt;val); goto tail_call; &#125; return; &#125; else &#123; return; &#125; if (!ht-&gt;nNumUsed) return; p = ht-&gt;arData; end = p + ht-&gt;nNumUsed; while (1) &#123; end--; zv = &amp;end-&gt;val; if (Z_TYPE_P(zv) == IS_INDIRECT) &#123; zv = Z_INDIRECT_P(zv); &#125; if (Z_REFCOUNTED_P(zv)) &#123; break; &#125; if (p == end) return; &#125; while (p != end) &#123; zv = &amp;p-&gt;val; if (Z_TYPE_P(zv) == IS_INDIRECT) &#123; zv = Z_INDIRECT_P(zv); &#125; if (Z_REFCOUNTED_P(zv)) &#123; ref = Z_COUNTED_P(zv); gc_scan(ref); &#125; p++; &#125; zv = &amp;p-&gt;val; if (Z_TYPE_P(zv) == IS_INDIRECT) &#123; zv = Z_INDIRECT_P(zv); &#125; ref = Z_COUNTED_P(zv); goto tail_call; &#125; &#125;&#125; ä¸»è¦ä¸ºä¸‰ä¸ªå‡½æ•°ï¼š gc_mark_rootsé˜Ÿè§„éå†ï¼Œå¯¹objectã€arrayæ‰€æœ‰å…ƒç´ çš„refcountâ€“å¹¶å°†å…¶æ ‡è®°ä¸ºç°è‰² gc_scan_rootsè¿™ä¸ªå‡½æ•°å¯¹èŠ‚ç‚¹ä¿¡æ¯çš„é“¾è¡¨å†æ¬¡è¿›è¡Œæ·±åº¦ä¼˜å…ˆéå†ï¼Œå¦‚æœå‘ç°zvalçš„refcountå¤§äºç­‰äº1ï¼Œåˆ™å¯¹è¯¥zvalå’Œå…¶åŒ…å«çš„zvalçš„refcountåŠ 1æ“ä½œï¼Œè¿™ä¸ªæ˜¯å¯¹éåƒåœ¾çš„ä¸€ä¸ªä¿¡æ¯è¿˜åŸï¼Œç„¶åå°†è¿™äº›zvalé¢œè‰²å±æ€§å»æ‰(è®¾ç½®æˆblack)ã€‚å¦‚æœå‘ç°zvalçš„refcountç­‰äº0ï¼Œåˆ™å°±æ ‡è®°æˆç™½è‰²ï¼Œè¿™äº›æ˜¯åé¢å°†è¦æ¸…ç†æ‰çš„åƒåœ¾ã€‚ gc_collect_roots éå†èŠ‚ç‚¹ä¿¡æ¯é“¾è¡¨,å°†å‰é¢ä¸€ä¸ªæ­¥éª¤ä¸­æ ‡è®°ä¸ºç™½è‰²çš„èŠ‚ç‚¹ä¿¡æ¯æ”¾åˆ°GC_G(zval_to_free)ä¸ºå…¥å£çš„é“¾è¡¨ä¸­ï¼Œè¿™ä¸ªé“¾è¡¨ç”¨æ¥å­˜æ”¾å°†è¦é‡Šæ”¾çš„åƒåœ¾ã€‚ ç„¶åé‡Šæ”¾æ‰å…¨éƒ¨çš„èŠ‚ç‚¹ä¿¡æ¯ï¼Œç¼“å†²åŒºè¢«æ¸…ç©ºã€‚åˆ†æç»“æŸåå°†é‡æ–°æ”¶é›†èŠ‚ç‚¹ä¿¡æ¯ã€‚","tags":[{"name":"phpæºç ","slug":"phpæºç ","permalink":"http://yoursite.com/tags/phpæºç /"}]},{"title":"å¾®æœåŠ¡æ•°æ®ä¸€è‡´æ€§å’ŒæœåŠ¡å¯é æ€§","date":"2018-09-12T13:28:00.000Z","path":"2018/09/12/å¾®æœåŠ¡æ•°æ®ä¸€è‡´æ€§å’ŒæœåŠ¡å¯é æ€§/","text":"å­˜åœ¨é—®é¢˜ æˆ‘ä»¬çš„ä¿è¯é‡‘æœåŠ¡ç°æœ‰ç»“æ„æ˜¯è¿™ä¸ªæ ·å­ã€‚åœ¨ 1ã€2ã€3ã€4ã€5ã€6 å„ä¸ªé˜¶æ®µéƒ½ä¼šå­˜åœ¨è¶…æ—¶å’Œå¼‚å¸¸é—®é¢˜ï¼Œå½“è´Ÿè½½å°‘æ—¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ‰‹åŠ¨äººå·¥å¤„ç†ï¼Œä½†æ˜¯å½“æ•°æ®é‡å¤§çš„æ—¶å€™ï¼Œé—®é¢˜æˆ–å¤šçš„ä»¤äººå‘æŒ‡ï¼Œæ²‰æµ¸äºæ´—æ•°æ®ï¼Œæ— æ³•è‡ªæ‹”ã€‚ã€‚è¶…æ—¶å­˜åœ¨é—®é¢˜ï¼š1.å½“1ã€2ã€3 æ­¥éª¤è¶…æ—¶æ—¶ï¼Œä¸‹æ¸¸æœåŠ¡å¯ä»¥å¿½ç•¥ï¼Œå½“åšæ‰§è¡Œå¤±è´¥ï¼Œé‡è¯•ã€‚2.å½“åœ¨ç¯èŠ‚4ã€5ã€6è¶…æ—¶æ—¶ï¼Œå¯¹äºä¸‹æ¸¸æœåŠ¡æ˜¯ä¹Ÿæ˜¯æ‰§è¡Œå¤±è´¥ï¼Œä½†æ˜¯è¿˜å¯ä»¥é‡è¯•ä¹ˆï¼Ÿ å¦‚ä½•æé«˜æœåŠ¡å¯é æ€§å¯¹äºä¸Šæ¸¸æœåŠ¡ï¼Œå¦‚ä½•ä¿è¯å¯¹ä¸‹æ¸¸æä¾›å¯é çš„æœåŠ¡ã€‚ è¡¥å¿æœºåˆ¶ åœ¨æœåŠ¡é—´çš„è°ƒç”¨å¤±è´¥æ—¶ï¼Œå¯ä»¥è®°å½•å¤±è´¥è°ƒç”¨ï¼Œå¦‚é˜Ÿåˆ—ï¼Œæ¶ˆè´¹é‡è¯•ã€‚ä½†æ˜¯å‰æä¸€å®šæ˜¯æ¥å£å¹‚ç­‰ã€‚ ä½†æ˜¯è¿™æ ·å¹¶ä¸èƒ½è§£å†³æ ¹æœ¬æ€§é—®é¢˜ï¼Œå¦‚æœæˆ‘ä»¬åœ¨è°ƒç”¨ä¿è¯é‡‘å†»ç»“æœåŠ¡æ—¶ï¼Œå¤±è´¥æ­¤æ—¶æˆ‘ä»¬å†»ç»“æ—¶æŠ¥æ“ä½œå…¥é˜Ÿåˆ—ï¼Œè®©é˜Ÿåˆ—å¼‚æ­¥æ¶ˆè´¹ï¼Œå¦‚æœæ­¤æ—¶è¦è§£å†»ä¿è¯é‡‘ï¼Œå°±ä¼šå‡ºç°ä¸šåŠ¡å¼‚å¸¸ã€‚ æ‰€ä»¥è¡¥å¿æœºåˆ¶å»ºè®®ä½¿ç”¨åœ¨ ä¸å¯é¿å…çš„ä¸šåŠ¡å¼‚å¸¸æƒ…å†µä¸‹ä½¿ç”¨ï¼Œæˆ‘ä»¬åº”è¯¥å°½å¯èƒ½çš„ä¼˜åŒ–æŠ€æœ¯æ–¹æ¡ˆï¼Œæ¥ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Œæœ€åå†é‡‡ç”¨è¡¥å¿æœºåˆ¶ã€‚ ä¸¤æ®µæäº¤åè®®ï¼ˆ2pcï¼‰ preOperation æ‰§è¡Œè¯·æ±‚ï¼Œåœ¨è°ƒç”¨å¾®æœåŠ¡å‰ï¼Œæ‰§è¡Œé¢„æ“ä½œæˆåŠŸåˆ™è¡¨ç¤ºæ­¤æ¬¡æ“ä½œå¯è¡Œã€‚å¦‚æœcommitå¤±è´¥è¯¥å¦‚ä½•å¤„ç†ï¼Ÿé‡æ–°preOperetionå˜›ï¼Ÿå¦‚æœæ¥å£å¹‚ç­‰æ˜¯å¦å¯ä»¥é‡å¤ï¼Œcommitï¼Ÿå¦‚ä½•ä¿è¯é¿å…é‡å¤æäº¤ï¼Ÿåœ¨preOperationæ—¶ï¼Œè¿”å›å”¯ä¸€æ“ä½œIDï¼Œä¸šåŠ¡é€»è¾‘æ¯ä¸ªæ“ä½œå¯¹åº”ä¸€ä¸ªæ“ä½œIDï¼Œcommitå¤±è´¥å°±é‡è¯•ï¼Œå½“ç„¶å‰ææ˜¯æˆ‘ä»¬çš„ä¸Šæœ‰æœåŠ¡æ¥å£å¹‚ç­‰ã€‚ å³ä½¿æ˜¯è¿™æ ·ä¹Ÿä¼šå­˜åœ¨é—®é¢˜ï¼Œå¦‚æœä¿è¯é‡‘é¢„æ“ä½œæˆåŠŸï¼Œä½†æ˜¯æ‰§è¡Œä¸€ç›´å¤±è´¥å‘¢ï¼Ÿæˆ‘ä»¬å¿…é¡»æä¾›å›æ»šæœºåˆ¶ã€‚ å¤§é‡åŒæ­¥RPCä¾èµ–ï¼Œå¦‚ä½•ä¿è¯è‡ªèº«æœåŠ¡å¯é æ€§ï¼Ÿ æœåŠ¡ä¹‹é—´åœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šå­˜åœ¨å¤§é‡å¼‚å¸¸ã€è¶…æ—¶ã€‚æˆ‘è¯¥å¦‚ä½•å¤„ç†ï¼Œè®¤ä¸ºè¿™æ¬¡æ˜¯å¤±è´¥çš„ï¼Ÿè¿˜æ˜¯æˆåŠŸçš„ï¼Ÿå¦‚æœä¾èµ–çš„æœåŠ¡è¿”å›æˆåŠŸï¼Œæ‰ç®—æˆåŠŸçš„è¯ï¼Œæˆ‘æ”¹å¦‚ä½•ä¿è¯æœåŠ¡å¯é æ€§ï¼Œè¯¥å¦‚ä½•å¯¹æˆ‘çš„ä¸‹æ¸¸æœåŠ¡æä¾›å¯é çš„æœåŠ¡ã€‚ è°ƒç”¨ä¾èµ–æœåŠ¡å¤±è´¥ï¼Œå¦‚ä½•é™çº§å¤„ç†ï¼Ÿ åœ¨æœåŠ¡è°ƒç”¨å¤±è´¥çš„æ—¶å€™ï¼Œæˆ‘çš„ä¸Šæ¸¸å‡ºé”™äº†ï¼Œæˆ‘è¯¥å¦‚ä½•é™çº§å¤„ç†ï¼Œæˆ‘è¯¥é‡è¯•ï¼Ÿè¿˜æ˜¯ç›´æ¥è·³è¿‡ï¼Œè·³è¿‡åæ˜¯å¦ä¼šé€ æˆå¾®æœåŠ¡ä¹‹é—´æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚å¦‚æœé‡è¯•æ˜¯å¦ä¼šé€ æˆé‡å¤æäº¤ï¼Œæ¥å£æ˜¯å¦å¹‚ç­‰ï¼Ÿ æ˜¯å¦è¿˜æ¬ ç¼ºå›æ»šæœºåˆ¶ï¼Ÿ","tags":[{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"http://yoursite.com/tags/å¾®æœåŠ¡/"}]},{"title":"phpé—­åŒ…","date":"2018-08-25T06:50:55.000Z","path":"2018/08/25/phpé—­åŒ…/","text":"åœ¨çœ‹guzzleåŒ…çš„æ—¶å€™çœ‹å¤§åˆ°äº†ä¸€æ®µæœ‰æ„æ€çš„ä»£ç , ç®€åŒ–ä»¥åç±»ä¼¼äºä¸‹è¾¹: 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?php/*** */class test &#123; public $handler; public function __construct(callable $handler = null) &#123; $this-&gt;handler = $handler; &#125; public static function create(callable $handler) &#123; return new self($handler); &#125; public function __invoke($request,$options) &#123; $func = $this-&gt;handler; return $func($request, $options); &#125; public function test1() &#123; return [$this, 'exec1']; &#125; public function exec1($a,$b) &#123; echo ($a+$b); &#125;&#125;$test = new test();$obj = test::create($test-&gt;test1());$obj(1,4); phpæ–‡æ¡£æ˜¯è¿™æ ·æè¿°é—­åŒ…çš„ `PHPæ˜¯å°†å‡½æ•°ä»¥stringå½¢å¼ä¼ é€’çš„ã€‚ å¯ä»¥ä½¿ç”¨ä»»ä½•å†…ç½®æˆ–ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼Œä½†é™¤äº†è¯­è¨€ç»“æ„ä¾‹å¦‚ï¼šarray()ï¼Œechoï¼Œempty()ï¼Œeval()ï¼Œexit()ï¼Œisset()ï¼Œlist()ï¼Œprint æˆ– unset()ã€‚ ä¸€ä¸ªå·²å®ä¾‹åŒ–çš„ object çš„æ–¹æ³•è¢«ä½œä¸º array ä¼ é€’ï¼Œä¸‹æ ‡ 0 åŒ…å«è¯¥ objectï¼Œä¸‹æ ‡ 1 åŒ…å«æ–¹æ³•åã€‚ åœ¨åŒä¸€ä¸ªç±»é‡Œå¯ä»¥è®¿é—® protected å’Œ private æ–¹æ³•ã€‚ é™æ€ç±»æ–¹æ³•ä¹Ÿå¯ä¸ç»å®ä¾‹åŒ–è¯¥ç±»çš„å¯¹è±¡è€Œä¼ é€’ï¼Œåªè¦åœ¨ä¸‹æ ‡ 0 ä¸­åŒ…å«ç±»åè€Œä¸æ˜¯å¯¹è±¡ã€‚è‡ª PHP 5.2.3 èµ·ï¼Œä¹Ÿå¯ä»¥ä¼ é€’ â€˜ClassName::methodNameâ€™ã€‚ é™¤äº†æ™®é€šçš„ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°å¤–ï¼Œä¹Ÿå¯ä¼ é€’ åŒ¿åå‡½æ•° ç»™å›è°ƒå‚æ•°ã€‚` é™¤äº†ä¸Šè¾¹çš„è¿™äº›å¯ä»¥ä½œä¸ºcallableå‚æ•°çš„ç±»å‹,è¿˜æœ‰ä¸€ä¸ªæ˜¯æ‹¥æœ‰__invoke()çš„å®ä¾‹åŒ–å¯¹è±¡ã€‚ æ‰€ä»¥å®ä¾‹åŒ–çš„å¯¹è±¡å¯ä»¥ä½¿ç”¨ [$obj,&#39;functionName&#39;] å½“åšé—­åŒ…å»ä¼ é€’ã€‚$obj = test::create($test-&gt;test1());å°†æˆ‘ä»¬çš„test1æ–¹æ³•èµ‹å€¼ç»™æ–°å®ä¾‹åŒ–çš„å¯¹è±¡é‡Œã€‚ é­”æœ¯æ–¹æ³•__invoke()è¡¨ç¤º: å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œ__invoke() æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚ æ‰€ä»¥æˆ‘ä»¬è°ƒç”¨$obj()å‡½æ•°æ—¶ä¼šè°ƒç”¨åˆ°__invoke()é‡Œ,æœ€åè°ƒç”¨åˆ°æˆ‘ä»¬ä¸€å¼€å§‹æ³¨å†Œçš„å‡½æ•°ã€‚ ps1234567891011121314151617181920212223242526272829303132333435363738394041class test &#123; public $handler; public function __construct(callable $handler = null) &#123; $this-&gt;handler = $handler; &#125; public static function create(callable $handler) &#123; return new self($handler); &#125; public function __invoke($request,$options) &#123; $func = $this-&gt;handler; return $func($request, $options); &#125; public function test1() &#123; return [$this, &apos;exec1&apos;]; &#125; public function exec1($a,$b) &#123; echo ($a+$b); &#125;&#125;$test = new test();$blj = test::create($test-&gt;test1());$blj(1,4);//æµ‹è¯•å¯¹è±¡æ˜¯å¦å¯ä»¥ä½œä¸ºcallableç±»å‹å‚æ•°$test = test::create(new test());","tags":[{"name":"php","slug":"php","permalink":"http://yoursite.com/tags/php/"}]},{"title":"phpæ•°ç»„å®ç°","date":"2018-08-20T12:00:08.000Z","path":"2018/08/20/phpæ•°ç»„å®ç°/","text":"phpçš„æ•°ç»„ä¾èµ–äºhashtableå®ç°çš„ã€‚ Times33çš„ç®—æ³•å¾ˆç®€å•ï¼Œå°±æ˜¯ä¸æ–­çš„ä¹˜33,ä¸‹è¾¹æ˜¯times33ç®—æ³•: Times33(hash)12345678910111213141516&lt;?phpfunction myHash($str) &#123; // hash(i) = hash(i-1) * 33 + str[i] $hash = 5381; $s = md5($str); //ç›¸æ¯”å…¶å®ƒç‰ˆæœ¬ï¼Œè¿›è¡Œäº†md5åŠ å¯† $seed = 5; $len = 32;//åŠ å¯†åé•¿åº¦32 for ($i = 0; $i &lt; $len; $i++) &#123; // (hash &lt;&lt; 5) + hash ç›¸å½“äº hash * 33 //$hash = sprintf(\"%u\", $hash * 33) + ord($s&#123;$i&#125;); //$hash = ($hash * 33 + ord($s&#123;$i&#125;)) &amp; 0x7FFFFFFF; $hash = ($hash &lt;&lt; $seed) + $hash + ord($s&#123;$i&#125;); &#125; return $hash &amp; 0x7FFFFFFF;&#125; å…¶ä¸­&lt;&lt; è¡¨ç¤ºå·¦ç§»,æ¯æ¬¡å·¦ç§»è¡¨ç¤ºx2ä¾‹å¦‚: 1234&lt;?php$num = 2;echo $num &lt;&lt; 2; æ‰€ä»¥($hash &lt;&lt; $seed)è¡¨ç¤º $hash * 32 ,åŒæ—¶åŠ ä¸Š$hash,ä¹Ÿå°±è¡¨ç¤º $hash * 33äº†ã€‚ord()å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„é¦–ä¸ªå­—ç¬¦çš„ ASCII å€¼ã€‚æœ€å$hash &amp; 0x7FFFFFFF è¡¨ç¤ºä¸æ•´å½¢çš„æœ€å¤§å€¼ä¸æ“ä½œ(0x7FFFF111FFFäºŒè¿›åˆ¶ä¸º1111111111111111111111111111),è¿™ä¸ªä¸æ“ä½œä¼šæˆªå–è¶…è¿‡æ•´å½¢äºŒè¿›åˆ¶éƒ¨åˆ†,æ‰€ä»¥times33è®¡ç®—å‡ºæ¥çš„å€¼ä¸ä¼šè¶…è¿‡æ•´å½¢çš„æœ€å¤§å€¼ã€‚ ä¸ºä»€ä¹ˆè¦ç”¨hashtableå®ç°phpæ•°ç»„?å› ä¸ºæ•£åˆ—è¡¨æ˜¯æ ¹æ®å…³é”®å»ºç å€¼ç›´æ¥è¿›é¡¹è®¿é—®çš„æ•°æ®ç»“æ„ã€‚åœ¨keyå’Œvalueä¹‹é—´æœ‰ä¸€ä¸ªæ˜ å°„å‡½æ•°,å¯ä»¥æ ¹æ®keyç›´æ¥ç´¢å¼•åˆ°å¯¹åº”çš„valueå€¼,å®ƒå¹¶ä¸ä¼šä½¿ç”¨ä¸€èˆ¬çš„å¯¹æ¯”æ“ä½œ,è€Œæ˜¯ç›´æ¥ä½¿ç”¨å†…å­˜çš„èµ·å§‹ä½ç½®å’Œåç§»ä½ç½®è¿›è¡Œå¯»å€,æ‰€ä»¥ä¼šæ¯”æ­£å¸¸çš„å¯»å€è¦å¿«ã€‚ æ•£åˆ—è¡¨ç»“æ„123456789101112131415161718192021struct _zend_array &#123; zend_refcounted_h gc; union &#123; struct &#123; ZEND_ENDIAN_LOHI_4( zend_uchar flags, zend_uchar nApplyCount, zend_uchar nIteratorsCount, zend_uchar reserve) &#125; v; uint32_t flags; &#125; u; uint32_t nTableMask; Bucket *arData; uint32_t nNumUsed; uint32_t nNumOfElements; uint32_t nTableSize; uint32_t nInternalPointer; zend_long nNextFreeElement; dtor_func_t pDestructor;&#125;; ä¸»è¦å­—æ®µä»‹ç»: gc å¼•ç”¨æ¬¡æ•°,åƒåœ¾å›æ”¶æ—¶ä¼šç”¨åˆ°ã€‚ union u å°±ä¸ä»‹ç»äº†ã€‚ arData å­˜å‚¨å…ƒç´ çš„æ•°ç»„,å†…å­˜æ˜¯è¿ç»­çš„,arDataæŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ nTableMask nTableSizeçš„è´Ÿæ•°ã€‚ nTableSize æ•°ç»„é•¿åº¦,ä¸º2çš„næ­¤æˆ¿ã€‚ nNumUsed å½“å‰ä½¿ç”¨çš„Bucketæ•°ã€‚ nNumOfElements å½“å‰æ‰€æœ‰çš„Bucketæ•°ã€‚ nNextFreeElement ä¸‹ä¸€ä¸ªè¢«ä½¿ç”¨çš„Bucket($a[] = â€˜â€™) pDestructor åˆ é™¤æŸä¸ªå…ƒç´ æ˜¯ä¼šä½¿ç”¨ Bucketç»“æ„12345typedef struct _Bucket &#123; zval val; zend_ulong h; /* hash value (or numeric index) */ zend_string *key; /* string key or NULL for numerics */&#125; Bucket; h hashå‡ºæ¥çš„å€¼(times33) *key å­˜å‚¨å…ƒç´ çš„key val å…·ä½“å€¼,æ˜¯ä¸ªzval å¦‚ä½•å®ç°phpä¸­å®ç°æ•£åˆ—è¡¨å®ç°ä¸»è¦ä½¿ç”¨å­˜å‚¨å…ƒç´ æ•°ç»„å’Œ æ˜ å°„å‡½æ•°ï¼ˆä¹Ÿå¯ä»¥ç§°ä½œæ•£åˆ—å‡½æ•°ï¼‰å’Œæ˜ å°„è¡¨ ä¸¾ä¸ªå…·ä½“çš„æ —å­: å¦‚æœæˆ‘ä»¬è¦åœ¨phpä»£ç ä¸­å£°æ˜ä¸€ä¸ªæ•°ç»„ä¼šå‘ç”Ÿä»€ä¹ˆ?ä¸‹è¾¹åˆ†æä¸‹phpæ˜¯å¦‚ä½•å®ç°æ•°ç»„çš„ã€‚ 123456&lt;?php$arr= [ 'a' =&gt; '111', 'b' =&gt; '222', 'c' =&gt; 'ccc']; é¦–å…ˆè‚¯å®šæ˜¯åˆå§‹åŒ–ã€‚ æ¥ä¸‹æ¥å°†æ¯ä¸ªå…ƒç´ å¯¹åº”çš„å€¼ä¾ç…§é¡ºåºæ‹·è´åˆ° Bucketé‡Œã€‚ ç„¶ååˆ©ç”¨æ˜ å°„å‡½æ•°å¯¹æ±‚å€¼,æ ¹æ®ç®—å‡ºæ¥çš„å€¼å°†å…¶å¯¹åº”çš„bucketçš„åœ°å€å†™åˆ°è¯¥å€¼å¯¹åº”çš„æ˜ å°„è¿™è¡¨é‡Œã€‚ å…·ä½“æ“ä½œå¦‚ä¸‹å›¾: å½“ç„¶æˆ‘ä»¬è¿™é‡Œçš„æ˜ å°„æ˜¯ç†æƒ³æ˜ å°„,å› ä¸ºåœ¨æ˜ å°„çš„è®¡ç®—è¿‡ç¨‹ä¸­å¯èƒ½å­˜åœ¨å†²çª,åç»­ä¼šä»‹ç»æ˜ å°„å‡½æ•°,ä»¥åŠå¦‚ä½•è§£æ˜ å°„å‡½æ•°è®¡ç®—åçš„å†²çªã€‚ åˆå§‹åŒ–1234567891011121314ZEND_API void ZEND_FASTCALL _zend_hash_init(HashTable *ht, uint32_t nSize, dtor_func_t pDestructor, zend_bool persistent ZEND_FILE_LINE_DC)&#123; GC_REFCOUNT(ht) = 1; //è®¾ç½®å¼•ç”¨æ¬¡æ•° GC_TYPE_INFO(ht) = IS_ARRAY; //è®¾ç½®æ•°æ®ç±»å‹ ht-&gt;u.flags = (persistent ? HASH_FLAG_PERSISTENT : 0) | HASH_FLAG_APPLY_PROTECTION | HASH_FLAG_STATIC_KEYS; ht-&gt;nTableMask = HT_MIN_MASK; HT_SET_DATA_ADDR(ht, &amp;uninitialized_bucket); ht-&gt;nNumUsed = 0; ht-&gt;nNumOfElements = 0; ht-&gt;nInternalPointer = HT_INVALID_IDX; ht-&gt;nNextFreeElement = 0; ht-&gt;pDestructor = pDestructor; ht-&gt;nTableSize = zend_hash_check_size(nSize);&#125; åˆå§‹åŒ–çš„æ—¶å€™ä¸»è¦æ˜¯å¯¹hashtableä¸­å„ä¸ªæˆå‘˜çš„è¿›è¡Œåˆå§‹åŒ–è®¾ç½®,è€Œä¸”åœ¨è¿™ä¸ªæ—¶å€™ä¸ä¼šç»™arDataåˆ†é…å†…å­˜,åªæœ‰åœ¨å¼€å§‹æ’å…¥æ•°æ®çš„æ—¶å€™æ‰ä¼šä¸ºarDataåˆ†é…å†…å­˜ã€‚ æ˜ å°„å‡½æ•°æ˜ å°„å‡½æ•°å…¶å®å°±æ˜¯ä¸€æ¬¡hashæ“ä½œå’Œå’Œä¸€æ¬¡|æ“ä½œ.hashæ“ä½œå°±æ˜¯ä¸Šè¾¹é”æåˆ°å¾—åˆ°times33æ“ä½œ,|æ“ä½œæ˜¯è®¡ç®—å‡ºæ¥çš„hashå€¼ä¸nTableSizeè¿›è¡Œè®¡ç®—ã€‚1nIndex = ket-&gt;h | nTableMask; å› ä¸ºnTableMaskæ˜¯nTableSizeçš„è´Ÿæ•°,æ‰€ä»¥è®¡ç®—å‡ºæ¥çš„nIndexå€¼åŒºé—´åº”è¯¥ä¸º[-1,nTableMask]ã€‚ æ­¤å¤„å¾…è¡¥å…… ä¸ºä»€ä¹ˆä¼šåœ¨[-1, nTableMask] åŒºé—´å†…ã€‚ å†™å…¥æ•°æ®åœ¨åˆå§‹åŒ–çš„æ—¶å€™å¹¶ä¸ä¼šå¯¹arDataåˆ†é…å†…å­˜,åªæœ‰åœ¨å†™å…¥çš„æ—¶å€™æ‰ä¼šçœŸæ­£åˆ†é…å†…å­˜ 12345678910111213141516171819202122232425262728static void zend_always_inline zend_hash_real_init_ex(HashTable *ht, int packed)&#123; HT_ASSERT(GC_REFCOUNT(ht) == 1); ZEND_ASSERT(!((ht)-&gt;u.flags &amp; HASH_FLAG_INITIALIZED)); if (packed) &#123; HT_SET_DATA_ADDR(ht, pemalloc(HT_SIZE(ht), (ht)-&gt;u.flags &amp; HASH_FLAG_PERSISTENT)); (ht)-&gt;u.flags |= HASH_FLAG_INITIALIZED | HASH_FLAG_PACKED; HT_HASH_RESET_PACKED(ht); &#125; else &#123; (ht)-&gt;nTableMask = -(ht)-&gt;nTableSize; HT_SET_DATA_ADDR(ht, pemalloc(HT_SIZE(ht), (ht)-&gt;u.flags &amp; HASH_FLAG_PERSISTENT)); (ht)-&gt;u.flags |= HASH_FLAG_INITIALIZED; if (EXPECTED(ht-&gt;nTableMask == -8)) &#123; Bucket *arData = ht-&gt;arData; HT_HASH_EX(arData, -8) = -1; HT_HASH_EX(arData, -7) = -1; HT_HASH_EX(arData, -6) = -1; HT_HASH_EX(arData, -5) = -1; HT_HASH_EX(arData, -4) = -1; HT_HASH_EX(arData, -3) = -1; HT_HASH_EX(arData, -2) = -1; HT_HASH_EX(arData, -1) = -1; &#125; else &#123; HT_HASH_RESET(ht); &#125; &#125;&#125; åˆ†é…å…·ä½“çš„å†…å­˜ 12#define HT_SIZE_EX(nTableSize, nTableMask) \\ (HT_DATA_SIZE((nTableSize)) + HT_HASH_SIZE((nTableMask))) 12345#define HT_HASH_SIZE(nTableMask) \\ (((size_t)(uint32_t)-(int32_t)(nTableMask)) * sizeof(uint32_t))#define HT_DATA_SIZE(nTableSize) \\ ((size_t)(nTableSize) * sizeof(Bucket)) å¯ä»¥çœ‹åˆ°åœ¨åˆ†é…å…·ä½“åˆ†é…å†…å­˜çš„æ—¶å€™ä¼šåˆ†é… nTableSize(Bucket+uint32_t)å¤§å°çš„å†…å­˜ã€‚è®²é“ç†åªéœ€è¦åˆ†é…nTableSizeBucketå¤§å°å†…å­˜å°±å¯ä»¥äº†,ä¸ºä»€ä¹ˆä¼šå¤šä½™å‡ºæ¥ nTableSizeuint32_tå†…å­˜å‘¢?å› ä¸ºnTableSizeuint32_tå°±æ˜¯æ˜ å°„è¡¨æ‰€å å†…å­˜å¤§å°ã€‚æ‰€ä»¥è¯´Bucketä¼šå’Œæ˜ å°„è¡¨ä¸€æ¬¡ç”³è¯·å†…å­˜ã€‚å†™å®Œæˆå†™å…¥æ“ä½œä»¥åä¼šå°†*arData æŒ‡å‘ç¬¬ä¸€ä¸ªBucketã€‚ å…·ä½“åœ¨å†…å­˜é‡Œçš„ç»“æœå¦‚å›¾æ‰€ç¤º: æ˜ å°„è¡¨åœ¨åˆå§‹åŒ–çš„æ—¶å€™æ‰€æœ‰å€¼éƒ½æ˜¯-1,åªæœ‰åœ¨è¢«èµ‹å€¼æ—¶å€™ä¼šå†™å…¥å¯¹åº”Bucketæ‰€åœ¨é“¾è¡¨çš„åç§»é‡ã€‚;ht-&gt;arData æŒ‡å‘ç¬¬ä¸€ä¸ªBucketçš„ä½ç½®,åœ¨èµ‹å€¼çš„æ—¶å€™ä¼šæŒ‰ç…§åˆ—è¡¨é¡ºåº,å°†å€¼å†™å…¥Bucketçš„valueé‡Œ,ç„¶åä¼šæ ¹æ®æ˜ å°„å‡½æ•°ç®—å‡ºå€¼å½“åšåç§»é‡æ‰¾åˆ°å¯¹åº”æ˜ å°„è¡¨çš„å…ƒç´ ,ç„¶åå°†å½“å‰Bucketå†™å…¥æ­¤å…ƒç´ ã€‚ ps nTableSize ä¸º2çš„æ¬¡æ–¹å€ã€‚ å†²çªå¦‚æœnIndex = ket-&gt;h | nTableMask ç®—å‡ºæ¥çš„å€¼å†²çªäº†æ€ä¹ˆåŠ? é¦–å…ˆæ˜ å°„è¡¨çš„æ¯ä¸ªå…ƒç´ ä¸æ˜¯é“¾è¡¨,æ‰€ä»¥å¯¼è‡´æ— æ³•å­˜å‚¨å¤šä¸ªå…ƒç´ ã€‚åœ¨phpä¸­æ˜¯è¿™æ ·å¤„ç†å†²çªçš„:é¦–å…ˆæ˜ å°„è¡¨çš„æ‰€æœ‰å…ƒç´ åˆå§‹åŒ–å€¼ä¸º -1 ,å½“å‰å¦‚æœç”¨å†²çªä¼šå°†æ–°ç®—å‡ºæ¥çš„å€¼å¯¹åº”çš„Bucketè¦†ç›–åŸæ¥æ—§çš„Bucket,ç„¶åå°†æ—§çš„Bucketè¿ç§»åˆ°æ–°çš„Bucket,å¹¶å°†æ—§çš„Bucketçš„u2.next(é»˜è®¤ä¸º-1) æŒ‡å‘æ–°Bucketã€‚ å¦‚å›¾ æŸ¥æ‰¾phpå†æŸ¥æ‰¾ä¸€ä¸ªæ•°ç»„å…ƒç´ æ˜¯,é¦–å…ˆä¼šæ ¹æ®å…¶key è·å–åˆ°è®¡ç®—åhashå€¼â€™ket-&gt;hâ€™,ç„¶åæ ¹æ®æ˜ å°„å‡½æ•°ç®—å‡ºå½“å‰å…ƒç´ åœ¨æ˜ å°„è¡¨ä¸­çš„åç§»é‡,åˆ©ç”¨å½“å‰ä½ç½®+åç§»é‡æ‰¾åˆ°æ˜ å°„è¡¨çš„å…ƒç´ ,å†æ ¹æ®å…¶å†…çš„åé‡æ‰¾åˆ°å¯¹åº”Bucketé“¾è¡¨çš„é¦–ä¸ªå…ƒç´ ä½ç½®,æœ€åéå†è¯¥é“¾è¡¨æ ¸å¯¹keyå€¼,æ‰¾åˆ°å¯¹åº”çš„å€¼ã€‚ å…·ä½“å®ç°å‡½æ•°:12345678910111213141516171819202122232425static zend_always_inline Bucket *zend_hash_find_bucket(const HashTable *ht, zend_string *key)&#123; zend_ulong h; uint32_t nIndex; uint32_t idx; Bucket *p, *arData; h = zend_string_hash_val(key); arData = ht-&gt;arData; nIndex = h | ht-&gt;nTableMask; idx = HT_HASH_EX(arData, nIndex); while (EXPECTED(idx != HT_INVALID_IDX)) &#123; p = HT_HASH_TO_BUCKET_EX(arData, idx); if (EXPECTED(p-&gt;key == key)) &#123; /* check for the same interned string */ return p; &#125; else if (EXPECTED(p-&gt;h == h) &amp;&amp; EXPECTED(p-&gt;key) &amp;&amp; EXPECTED(ZSTR_LEN(p-&gt;key) == ZSTR_LEN(key)) &amp;&amp; EXPECTED(memcmp(ZSTR_VAL(p-&gt;key), ZSTR_VAL(key), ZSTR_LEN(key)) == 0)) &#123; return p; &#125; idx = Z_NEXT(p-&gt;val); &#125; return NULL;&#125; æ‰©å®¹æ•°ç»„çš„å®¹é‡åœ¨åˆå§‹åŒ–çš„æ—¶å€™å·²ç»ç¡®å®šäº†å¤§å°,å°±æ˜¯nTableSizeã€‚å½“ç„¶æ˜ å°„å‡½æ•°ä¹Ÿæ˜¯æ ¹æ® nTableMask æ¥è®¡ç®—çš„ã€‚æ‰€ä»¥æˆ‘ä»¬æ‰©å®¹æ—¶å€™å¿…é¡»é‡æ–°è®¡ç®—ç´¢å¼•,ä¹Ÿå°±æ˜¯æ˜ å°„è¡¨é‡Œçš„å€¼ã€‚å…·ä½“æ‰©å®¹è§„åˆ™:é¦–å…ˆå½“éœ€è¦æ‰©å®¹æ—¶,ä¼šè®¡ç®—å½“å‰Bucketé“¾è¡¨é‡Œåˆ é™¤å…ƒç´ æ•°é‡å æ€»è¡¨å…ƒç´ æ•°é‡çš„æ¯”ä¾‹,å¦‚æœæ²¡æœ‰è¶…è¿‡é˜ˆå€¼åˆ™ç”³è¯·åˆ†é…ä¸€ä¸ªåŸæ¥æ•°ç»„å¤§å°ä¸¤å€çš„æ–°ç´ ç»„,æŠŠå…ƒç´ å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸Š,ç„¶åé‡æ–°å»ºç«‹ç´¢å¼•ã€‚ é˜ˆå€¼åˆ¤æ–­:1ht-&gt;nNumUsed &gt; ht-&gt;nNumOfElements + (ht-&gt;nNumOfElements &gt;&gt; 5 å¤„ç†è¿‡ç¨‹:12345678910111213141516171819202122232425262728static void ZEND_FASTCALL zend_hash_do_resize(HashTable *ht)&#123; IS_CONSISTENT(ht); HT_ASSERT(GC_REFCOUNT(ht) == 1); if (ht-&gt;nNumUsed &gt; ht-&gt;nNumOfElements + (ht-&gt;nNumOfElements &gt;&gt; 5)) &#123; /* additional term is there to amortize the cost of compaction */ HANDLE_BLOCK_INTERRUPTIONS(); zend_hash_rehash(ht); HANDLE_UNBLOCK_INTERRUPTIONS(); &#125; else if (ht-&gt;nTableSize &lt; HT_MAX_SIZE) &#123; /* Let's double the table size */ void *new_data, *old_data = HT_GET_DATA_ADDR(ht); uint32_t nSize = ht-&gt;nTableSize + ht-&gt;nTableSize; Bucket *old_buckets = ht-&gt;arData; HANDLE_BLOCK_INTERRUPTIONS(); new_data = pemalloc(HT_SIZE_EX(nSize, -nSize), ht-&gt;u.flags &amp; HASH_FLAG_PERSISTENT); ht-&gt;nTableSize = nSize; ht-&gt;nTableMask = -ht-&gt;nTableSize; HT_SET_DATA_ADDR(ht, new_data); memcpy(ht-&gt;arData, old_buckets, sizeof(Bucket) * ht-&gt;nNumUsed); pefree(old_data, ht-&gt;u.flags &amp; HASH_FLAG_PERSISTENT); zend_hash_rehash(ht); HANDLE_UNBLOCK_INTERRUPTIONS(); &#125; else &#123; zend_error_noreturn(E_ERROR, \"Possible integer overflow in memory allocation (%zu * %zu + %zu)\", ht-&gt;nTableSize * 2, sizeof(Bucket) + sizeof(uint32_t), sizeof(Bucket)); &#125;&#125; åœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­è¿˜ä¼šæŠŠå·²ç»åˆ é™¤çš„Bucketç»™åˆ é™¤ã€‚ å…·ä½“çš„æ“ä½œåœ¨zend_hash.cæ–‡ä»¶é‡Œã€‚å¦‚æœè¶…è¿‡é˜ˆå€¼,åˆ™ä¼šæŠŠå·²ç»åˆ é™¤Bucketç§»é™¤,ç„¶åæŠŠåˆæœ‰åè¾¹çš„å…ƒç´ å¾€å‰ç§»åŠ¨,è¡¥ä¸Šç©ºç¼ºçš„Bucket,å½“ç„¶ç´¢å¼•ä¹Ÿä¼šé‡å»ºã€‚ å‚è€ƒ time33 2.1 å˜é‡çš„å†…éƒ¨å®ç°","tags":[{"name":"phpæºç ","slug":"phpæºç ","permalink":"http://yoursite.com/tags/phpæºç /"}]},{"title":"phpæ•°æ®ç»“æ„","date":"2018-08-19T12:30:34.000Z","path":"2018/08/19/phpæ•°æ®ç»“æ„/","text":"å˜é‡phpæ˜¯å¦‚ä½•ç»Ÿä¸€å®ç°å„ç§å˜é‡ç±»å‹çš„? è¿™å’Œphpå˜é‡ç±»å‹çš„å®ç°æ˜¯å¯†ä¸å¯åˆ†çš„ã€‚ä¸€ä¸ªå˜é‡ä¸»è¦æœ‰ä¸‰ä¸ªè¦ç´ :å˜é‡å``å˜é‡ç±»å‹``å˜é‡å€¼,ä»–ä»¬åœ¨phpå˜é‡ç±»å‹å®ç°ä¸­ä¸»è¦å¯¹åº” zval zend_value å’Œzendçš„å„ç§æ•°æ®ç±»å‹ã€‚phpä¸­ç”¨$å»å£°æ˜ä¸€ä¸ªå˜é‡,åœ¨å£°æ˜çš„æ—¶å€™å¯ä»¥è¿›è¡Œåˆå§‹åŒ–,å½“ç„¶ä¹Ÿå¯ä»¥ä¸å£°æ˜ç›´æ¥ä½¿ç”¨ã€‚ä¸€èˆ¬æ¥è¯´,ä¸€ä¸ªå˜é‡çš„å®šä¹‰åŒ…å«ä¸¤æ­¥:å˜é‡å®šä¹‰å’Œå˜é‡åˆå§‹åŒ–,åœ¨phpä¸­åªå®šä¹‰ä¸åˆå§‹åŒ–æ˜¯å¯ä»¥çš„ã€‚ å˜é‡ç»“æ„ä½“1234567891011121314151617181920212223// php zvalç»“æ„struct _zval_struct &#123; zend_value value; æŒ‡å‘å…·ä½“çš„value /* value */ union &#123; struct &#123; ZEND_ENDIAN_LOHI_4( zend_uchar type, /* active type */ zend_uchar type_flags, zend_uchar const_flags, zend_uchar reserved) /* call info for EX(This) */ &#125; v; uint32_t type_info; &#125; u1; union &#123; uint32_t var_flags; uint32_t next; /* hash collision chain */ uint32_t cache_slot; /* literal cache slot */ uint32_t lineno; /* line number (for ast nodes) */ uint32_t num_args; /* arguments number for EX(This) */ uint32_t fe_pos; /* foreach position */ uint32_t fe_iter_idx; /* foreach iterator index */ &#125; u2;&#125;; å˜é‡ç±»å‹å…¶ä¸­type è¡¨ç¤ºå½“å‰å˜é‡çš„ç±»å‹,ä¾‹å¦‚string array intç­‰,ä»¥ä¸‹ä¸ºphpä¸­å…¨éƒ¨å˜é‡ç±»å‹ã€‚å…¶ä¸­type æ˜¯ä¸€ä¸ªæ— ç¬¦å·ç±»å‹çš„char,ä»–çš„å®šä¹‰æ˜¯è¿™æ ·çš„1typedef unsigned char zend_uchar; 12345678910111213141516171819typedef union _zend_value &#123; zend_long lval; /* long value */ double dval; /* double value */ zend_refcounted *counted; zend_string *str; zend_array *arr; zend_object *obj; zend_resource *res; zend_reference *ref; zend_ast_ref *ast; zval *zv; void *ptr; zend_class_entry *ce; zend_function *func; struct &#123; uint32_t w1; uint32_t w2; &#125; ww; &#125; zend_value; åœ¨è¿™äº›ç±»å‹é‡Œä¸å­˜åœ¨booleanç±»å‹,å› ä¸ºåœ¨php7ä¸­å·²ç»å°†booleanæ‹†åˆ†ä¸ºtrueå’Œfalse.ç›´æ¥ä¿å­˜åœ¨typeä¸­,ä¹Ÿå°±æ˜¯è¯´booleanæ²¡æœ‰_zend_valueç»“æ„,ç›´æ¥é€šè¿‡typeå­—æ®µå°±å¯ä»¥ç¡®å®šbooleançš„å€¼ã€‚ ä»ä¸Šè¾¹çš„ç»“æ„ä½“å¯ä»¥çœ‹å‡ºæ¥ zend_longã€double ç±»å‹ä¸æ˜¯æŒ‡é’ˆç±»å‹,ä¹Ÿå°±æ˜¯è¯´æ•´å½¢å’Œæµ®ç‚¹å‹æ­£èƒ½è¿›è¡Œæ·±æ‹·è´,å¹¶ä¸èƒ½å’Œå…¶ä»–è¯´å¥ç±»å‹ä¸€æ ·è¿›è¡Œ å¼•ç”¨è®¡æ•°å’Œå†™æ—¶å¤åˆ¶ã€‚å› ä¸ºæœ‰å¼•ç”¨è®¡æ•°å’Œå†™æ—¶å¤åˆ¶åœ¨å˜é‡èµ‹å€¼ä¸”ä¸åšä¿®æ”¹æ—¶æ‰èƒ½å¤§é‡èŠ‚çœå†…å­˜ã€‚ ä»¥stringç±»å‹ä¸ºä¾‹,å®ƒåœ¨phpä¸­çš„ç»“æ„ç±»å‹åº”è¯¥æ˜¯è¿™æ ·çš„: _zend_string:123456struct _zend_string &#123; zend_refcounted_h gc; zend_ulong h; /* hash value */ size_t len; char val[1]; /*å­—ç¬¦ä¸²èµ·å§‹åœ°å€*/&#125;; å…¶ä¸­gc å­—æ®µè¡¨ç¤ºè¿™ä¸ªç»“æ„ä½“è¢«å¼•ç”¨çš„æ¬¡æ•°,åƒåœ¾å›æ”¶çš„æ—¶å€™ä¼šç”¨åˆ°ã€‚ h å­—ç¬¦ä¸²é€šè¿‡Times33è®¡ç®—å‡ºæ¥çš„hashcode len å­—ç¬¦ä¸²é•¿åº¦ val å­—ç¬¦ä¸²å†…å®¹ æˆ‘ä»¬åœ¨è¿™é‡Œéƒ½ä¼šæœ‰ç–‘é—®,ä¸ºä»€ä¹ˆå­˜å‚¨å­—ç¬¦ä¸²å†…å®¹çš„æ—¶å€™æ²¡æœ‰ä½¿ç”¨char*ç±»å‹,è€Œç”¨äº†ä¸€ä¸ªæ•°ç»„ç±»å‹æ¥å­˜å‚¨ã€‚zend_stringåœ¨ç”³è¯·å†…å­˜çš„æ—¶å€™ä¼šä¼šç”³è¯·malloc(sizeof(zend_string)+å­—ç¬¦ä¸²é•¿åº¦),ä¸”val[0]å­˜çš„æ˜¯å­—ç¬¦ä¸²æœ€åä¸€ä¸ªå­—ç¬¦å®‰â€œ\\0â€ zend_stringç»“æ„åœ¨å†…å­˜ä¸­å¦‚ä¸‹æ‰€ç¤º: å½“æ—¶ä¹Ÿåœ¨char val[1]çš„åœ°æ–¹ç–‘æƒ‘äº†å¾ˆä¹…,å†å¾€ä¸Šæ‰¾äº†å¾ˆå¤šæ–‡ç« ,å…¶ä¸­Nikita Popov(nikicï¼ŒPHP å®˜æ–¹å¼€å‘ç»„æˆå‘˜ï¼ŒæŸæ—ç§‘æŠ€å¤§å­¦çš„å­¦ç”Ÿ) è¿™æ ·è§£é‡Š 1å¦‚æœä½ å¯¹ C è¯­è¨€äº†è§£çš„ä¸æ˜¯å¾ˆæ·±å…¥çš„è¯ï¼Œå¯èƒ½ä¼šè§‰å¾— val çš„å®šä¹‰æœ‰äº›å¥‡æ€ªï¼šè¿™ä¸ªå£°æ˜åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œä½†æ˜¯æ˜¾ç„¶æˆ‘ä»¬æƒ³å­˜å‚¨çš„å­—ç¬¦ä¸²é•¿åº¦è‚¯å®šå¤§äºä¸€ä¸ªå­—ç¬¦çš„é•¿åº¦ã€‚è¿™é‡Œå…¶å®ä½¿ç”¨çš„æ˜¯ç»“æ„ä½“çš„ä¸€ä¸ªã€é»‘ã€\bæ–¹æ³•ï¼šåœ¨å£°æ˜æ•°ç»„æ—¶åªå®šä¹‰ä¸€ä¸ªå…ƒç´ ï¼Œä½†æ˜¯å®é™…åˆ›å»º zend_string æ—¶å†åˆ†é…è¶³å¤Ÿçš„å†…å­˜æ¥å­˜å‚¨æ•´ä¸ªå­—ç¬¦ä¸²ã€‚è¿™æ ·æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥é€šè¿‡ val è®¿é—®å®Œæ•´çš„å­—ç¬¦ä¸²ã€‚ å‚è€ƒ: Internal value representation in PHP 7 - Part 2 [è¯‘]å˜é‡åœ¨ PHP7 å†…éƒ¨çš„å®ç°ï¼ˆäºŒï¼‰ phpå†…æ ¸åˆ†æâ€”â€”2.1 å˜é‡çš„å†…éƒ¨å®ç°","tags":[{"name":"phpæºç ","slug":"phpæºç ","permalink":"http://yoursite.com/tags/phpæºç /"}]},{"title":"phpçš„å¼•ç”¨","date":"2018-08-12T14:18:07.000Z","path":"2018/08/12/phpçš„&ç¬¦å·/","text":"&amp;&amp;æ˜¯phpä¸­çš„å¼•ç”¨,ä»–å¹¶ä¸ä¸€ç§ç‹¬ç«‹çš„æ•°æ®ç±»å‹,è€Œæ˜¯æŒ‡å‘å…¶ä»–æ•°æ®ç±»å‹çš„æ•°æ®ç»“æ„,å’ŒCè¯­è¨€çš„æŒ‡é’ˆç±»ä¼¼ã€‚ å…·ä½“ä½œç”¨ä¸º:å½“æˆ‘ä»¬ä¿®æ”¹å¼•ç”¨ç±»å‹å˜é‡æ˜¯,å…¶ä¿®æ”¹çš„å°†ä½œç”¨äºå®é™…å¼•ç”¨çš„å˜é‡ä¸Šã€‚ å¦‚æœå½“æˆ‘ä»¬ä½¿ç”¨&amp;ç¬¦å·ç”Ÿæˆä¸€ä¸ªå¼•ç”¨å˜é‡æ—¶,é¦–å…ˆä¼šä¸º&amp;æ“ä½œç”Ÿæˆä¸€ä¸ªzend_referenceç»“æ„,zend_referenceå°±æ˜¯å¼•ç”¨ç±»å‹çš„ç»“æ„ä½“,ä»–å†…åµŒä¸€ä¸ªzval,ç„¶åæ­¤ç»“æ„çš„ä½“zvalçš„valueæŒ‡å‘åŸæ¥zvalçš„valueä¸Šã€‚ç„¶åå°†åŸæ¥zvalçš„å˜é‡ç±»å‹å˜ä¸ºIS_REFERENCE,åŸæ¥zvalçš„valueæ‰§è¡Œæ–°åˆ›å»ºzend_referenceç»“æ„ã€‚ç´¢å¼•&amp;çš„ä½œç”¨å°±æ˜¯æ–°ç”Ÿæˆzend_reference,ç„¶åå°†å…¶æŒ‡å‘åŸæ¥çš„zvalçš„valueä¸Š,é¡ºä¾¿æŠŠåŸæ¥zvalçš„å˜é‡ç±»å‹å˜åŒ–ä¸ºå¼•ç”¨ç±»å‹ã€‚ 1234struct _zend_reference &#123; zend_refcondted_h gc; zval val; æŒ‡å‘åŸæ¥çš„value.&#125;; ä¸¾ä¸ªæ —å­12$a = time(); //æ­¥éª¤1$b = &amp;$a; //æ­¥éª¤2 æ­¥éª¤1 ç°åœ¨$a = time()æ˜¯ä»–ä»¬çš„æ•°æ®ç»“æ„æŒ‡å‘ä¸º: æ­¤æ—¶æ•°æ®ç»“æ„,ä¸€ç›´æŒ‡é’ˆæŒ‡å‘æ˜¯è¿™ä¸ªæ ·å­ã€‚ æ­¥éª¤2 ä¹Ÿå°±æ˜¯è¯´PHPçš„å¼•ç”¨åœ¨ä½¿ç”¨åæ–°ç”Ÿæˆä¸€ä¸ªå¼•ç”¨ç±»å‹æœºæ„,ç„¶åå°†å¼•ç”¨ç±»å‹ç»“æ„æŒ‡å‘è¶Šæ¥çš„value,æœ€åå°†åŸæ¥zvalçš„valueæŒ‡å‘æ–°ç”Ÿæˆçš„ç»“æ„ä½“,å¹¶å°†å…¶å˜é‡ç±»å‹å˜ä¸ºå¼•ç”¨ç±»å‹,IS_REFERENCEã€‚å½“ç„¶éšä¹‹æ”¹å˜çš„è¿˜æœ‰è®¡æ•°ã€‚","tags":[{"name":"phpæºç ","slug":"phpæºç ","permalink":"http://yoursite.com/tags/phpæºç /"}]},{"title":"swagger","date":"2018-08-06T07:30:13.000Z","path":"2018/08/06/swagger/","text":"swagger æ˜¯ä»€ä¹ˆé¬¼?swaggeråƒæ˜¯ä¸ªæ¥å£ç”Ÿæˆã€ç®¡ç†ã€mockã€æµ‹è¯•çš„æ¡†æ¶ã€‚ä¸»è¦åŠŸèƒ½: æ”¯æŒAPIè‡ªåŠ¨ç”ŸæˆåŒæ­¥çš„åœ¨çº¿æ–‡æ¡£ è¿™äº›æ–‡æ¡£å¯ç”¨äºé¡¹ç›®å†…éƒ¨APIå®¡æ ¸ æ–¹ä¾¿æµ‹è¯•äººå‘˜äº†è§£API è¿™äº›æ–‡æ¡£å¯ä½œä¸ºå®¢æˆ·äº§å“æ–‡æ¡£çš„ä¸€éƒ¨åˆ†è¿›è¡Œå‘å¸ƒ å¯ä»¥mockæ¥å£æ–¹ä¾¿è°ƒè¯•æ”¯æŒAPIè§„èŒƒç”Ÿæˆä»£ç ï¼Œç”Ÿæˆçš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éª¨æ¶ä»£ç å¯ä»¥åŠ é€Ÿå¼€å‘å’Œæµ‹è¯•é€Ÿåº¦##swagger-ui ä¸€ä¸ªæ˜¯ä¸€ä¸ªç®¡ç†æ¥å£çš„æœåŠ¡,å®ƒå¯ä»¥æ ¹æ®swagger.jsonæ¨¡æ‹Ÿæ¥å£è¿”å›ã€‚æ­å»ºswagger-ui å…‹éš†swagger-ui git clone https://github.com/swagger-api/swagger-ui.git é…ç½®nginx æœåŠ¡ 123456789101112131415161718192021222324252627282930313233server &#123; listen 8090; server_name www.swagger-ui.com; autoindex on; #charset koi8-r; # access_log logs/host.access.log main; root /Users/lijian/Desktop/code/web_code/swagger/swagger-ui/dist; location / &#123; index index.php index.html index.htm; try_files $uri $uri/ /index.php?$query_string; &#125; #error_page 404 /404.html; # redirect server error pages to the static page /50x.html # error_page 500 502 503 504 /50x.html; location = /50x.html &#123; root html; &#125; location ~ \\.php$ &#123; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; fastcgi_split_path_info ^(.+\\.php)(/.+)$; fastcgi_param PATH_TRANSLATED $document_root$fastcgi_path_info; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; &#125; &#125; é‡å¯NGINXnginx -s reload æ ·å­å¦‚ä¸‹: swagger.jsonswagger.json,swagger-uièƒ½å¤Ÿå°†swagger.jsonè§£æä¸ºå¯¹åº”çš„å¯å¤„ç†çš„æ¥å£æ–‡æ¡£ã€‚ æ•ˆæœå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚æœ€ç»ˆè¦çš„ä¸€ç‚¹åœ¨äº http://localhost:8091/swagger.jsonè¯¥urlä¸ºè¢«è§£æçš„jsonåœ°å€ã€‚ å½“ç„¶å¦‚æœæˆ‘ä»¬éœ€è¦ç®¡ç†ä¸åŒé¡¹ç›®çš„é¡¹ç›®,å¯ä»¥å•ç‹¬é…ç½®ä¸ªæœåŠ¡ç”¨æ¥ç®¡ç†swagger.jsonã€‚ swagger-phpgithub åœ°å€: https://github.com/zircote/swagger-php é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨é¡¹ç›®é‡Œå¼•å…¥swagger-php æ‰©å±•åŒ…ã€‚ composer global require zircote/swagger-php æŒ‰ç…§swaggeræ–‡æ¡£å†™swaggerå¤‡æ³¨:eg: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465/** * @SWG\\Post( * path=&quot;/guestbook/appmsg&quot;, * summary=&quot;è®¿å®¢ç•™è¨€&quot;, * tags=&#123;&quot;new&quot;, &quot;guests&quot;&#125;, * description=&quot;è®¿å®¢ç•™è¨€&quot;, * operationId=&quot;appmsg&quot;, * @SWG\\Parameter( * description=&quot;msg&quot;, * format=&quot;string&quot;, * in=&quot;formData&quot;, * name=&quot;msg&quot;, * required=true, * type=&quot;string&quot;, * ), * @SWG\\Parameter( * description=&quot;email&quot;, * format=&quot;string&quot;, * in=&quot;formData&quot;, * name=&quot;email&quot;, * required=true, * type=&quot;string&quot;, * * ), * consumes=&#123;&quot;multipart/form-data&quot;, &quot;application/x-www-form-urlencoded&quot;&#125;, * produces=&#123;&quot;application/json&quot;&#125;, * @SWG\\Response( * response=&quot;200&quot;, * description=&quot;è¿”å›æˆåŠŸ&quot;, * ), * ) * *//** * @SWG\\Get( * path=&quot;/get/feedback&quot;, * summary=&quot;ç•™è¨€è¡¨&quot;, * tags=&#123;&quot;getList&quot;&#125;, * descriptionId=&quot;appmsglist&quot;, * @SWG\\Parameter( * description=&quot;Id&quot;, * format=&quot;integer&quot;, * in=&quot;formData&quot;, * name=&quot;user_id&quot;, * required=&quot;true&quot;, * type=&quot;integer&quot; * ), * @SWG\\Parameter( * description=&quot;phone&quot;, * format=&quot;integer&quot;, * in=&quot;formData&quot;, * name=&quot;user_id&quot;, * required=&quot;true&quot;, * type=&quot;integer&quot; * ), * consumes=&#123;&quot;multipart/form-data&quot;, &quot;application/x-www-form-urlencode&quot;&#125;, * produces=&#123;&quot;application/json&quot;&#125;, * @SWG\\Response( * response=&quot;200&quot;, * description=&quot;è¿”å›æˆåŠŸ&quot;, * ) * ) * */ å†™å®Œä»¥åè¿è¡Œ: ./vendor/zircote/swagger-php/bin/swagger app/Business/Hera/HeraMockApi.php -o ./../../swagger_json/rrc/swagger.jsonç¬¬ä¸€ä¸ªä¸ºswagger.jsonçš„ç”Ÿæˆå™¨,ç¬¬äºŒä¸ªä¸ºç›®æ ‡æ–‡ä»¶,ç¬¬ä¸‰ä¸ªä¸ºç”Ÿæˆæ–‡ä»¶ã€‚ ç„¶åæˆ‘ä»¬åœ¨swagger-ui å¼•å…¥ç”Ÿæˆçš„jsonå³å¯ã€‚","tags":[{"name":"pear","slug":"pear","permalink":"http://yoursite.com/tags/pear/"}]},{"title":"è®¾è®¡æ¨¡å¼-å»ºé€ è€…æ¨¡å¼(builder template method)","date":"2018-08-01T12:53:15.000Z","path":"2018/08/01/è®¾è®¡æ¨¡å¼/","text":"builder æ¨¡å¼builder å»ºé€ è€…æ¨¡å¼,åˆç§°ç”Ÿæˆå™¨æ¨¡å¼ã€‚ å»ºé€ è€…æ¨¡å¼æ˜¯ä¸ºäº†ç®€åŒ– ä½¿ç”¨å¤šä¸ªå»ºå•çš„å¯¹è±¡æ„å»ºæˆä¸€ä¸ªå¤æ‚å¯¹è±¡çš„ è®¾è®¡æ¨¡å¼ã€‚ å±äºåˆ›å»ºå‹æ¨¡å¼ã€‚ ä»£ç ç¤ºä¾‹ 1234567891011121314151617181920publish class SmallWheel()&#123; &#125;publish class BigWheel()&#123; &#125;publish class SmallCar()&#123; publish $wheel;&#125;publish class BigCar()&#123; publish $wheel;&#125; ä»¥ä¸Šä¸ºé›¶ä»¶ã€‚ 12345678910111213141516171819publish CarBuilder()&#123; //åˆ›å»ºå°è½¿è½¦ publish function getSmallCar() &#123; $smallCar = new SmallCar(); $smallCar-&gt;whell = new SmallWheel(); return $smallCar; &#125; //åˆ›å»ºå¤§è½¿è½¦ publish function getBigCar() &#123; $bigCar = new BigCar(); $bigCar-&gt;whell = new BigWheel(); return $bigCar; &#125;&#125; è°ƒåº¦ 12345$carBuilder = new CArBuilder();$smallCar = $carBuilder-&gt;getSmallCar();$bigCar = $carBuilder-&gt;getBigCar(); å¤‡æ³¨: å»ºé€ è€…æ¨¡å¼ä¸å·¥å‚æ¨¡å¼åŒºåˆ«:å·¥å‚æ¨¡å¼ç”¨äºæ‰¹é‡åˆ›å»ºé‚£å“ªä¸€ç§ç±», å»ºé€ è€…æ¨¡å¼æ›´æ³¨é‡æ„å»ºè¿‡ç¨‹ã€‚ template methodæ¨¡æ¿æ–¹æ³•:å®šä¹‰ä¸€ä¸ªæŠ½è±¡ç±»æˆ–è€…/çˆ¶ç±»,ç”±ç»§æ‰¿å®ƒçš„å­ç±»æŒ‰ç…§éœ€æ±‚é‡å†™å®ƒçš„æ–¹æ³•å®ç°ã€‚ eg: 123456789101112publish abstract class Car()&#123; //å¼ºåˆ¶å­ç±»å®ç° abstract public function run(); abstract public function turnOnTheLight(); //ä¸å¼ºåˆ¶ public function palyMusic() &#123; return 'hengheng hahei'; &#125;&#125; ç»§æ‰¿ 123456789101112public class SmaCar extends car &#123; public function run() &#123; return 'run'; &#125; public funtion turnOnTheLight() &#123; return 'turnOnTheLight'; &#125;&#125; ä»¥ä¸Š","tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"http://yoursite.com/tags/è®¾è®¡æ¨¡å¼/"}]},{"title":"Item2ä½¿ç”¨sz rzå‘½ä»¤ä»æœåŠ¡ä¸‹è½½ä¸Šä¼ æ–‡ä»¶","date":"2018-07-12T13:27:37.000Z","path":"2018/07/12/ä½¿ç”¨sz-rzå‘½ä»¤ä»æœåŠ¡ä¸‹è½½ä¸Šä¼ æ–‡ä»¶/","text":"èƒŒæ™¯å¦‚ä½•ä»linuxæœåŠ¡ä¸‹è½½/ä¸Šä¼ æ–‡ä»¶ ä½¿ç”¨scpå‘½ä»¤ ä½¿ç”¨szå‘½ä»¤ è¿™é‡Œä¸»è¦ä»‹ç»ä½¿ç”¨szå‘½ä»¤ä¸‹è½½æ–‡ä»¶ å®‰è£… å®‰è£…lrzsz hobrew install llssz åœ¨æœ¬åœ°ç¼–å†™shellç”¨äºæ¥å—szå‘½ä»¤ä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶ ä¸Šä¼ shell iterm2-send-zmodem.sh12345678910111213141516171819202122232425262728293031323334#!/bin/bash#Author: Matt Mastracci (matthew@mastracci.com)# AppleScript from http://stackoverflow.com/questions/4309087/cancel-button-on-osascript-in-a-bash-script# licensed under cc-wiki with attribution required# Remainder of script public domainosascript -e &apos;tell application &quot;iTerm2&quot; to version&apos; &gt; /dev/null 2&gt;&amp;1 &amp;&amp; NAME=iTerm2 || NAME=iTermif [[ $NAME = &quot;iTerm&quot; ]]; then FILE=`osascript -e &apos;tell application &quot;iTerm&quot; to activate&apos; -e &apos;tell application &quot;iTerm&quot; to set thefile to choose file with prompt &quot;Choose a file to send&quot;&apos; -e &quot;do shell script (\\&quot;echo \\&quot;&amp;(quoted form of POSIX path of thefile as Unicode text)&amp;\\&quot;\\&quot;)&quot;`else FILE=`osascript -e &apos;tell application &quot;iTerm2&quot; to activate&apos; -e &apos;tell application &quot;iTerm2&quot; to set thefile to choose file with prompt &quot;Choose a file to send&quot;&apos; -e &quot;do shell script (\\&quot;echo \\&quot;&amp;(quoted form of POSIX path of thefile as Unicode text)&amp;\\&quot;\\&quot;)&quot;`fiif [[ $FILE = &quot;&quot; ]]; then echo Cancelled. # Send ZModem cancel echo -e \\\\x18\\\\x18\\\\x18\\\\x18\\\\x18 sleep 1 echo echo \\# Cancelled transferelse /usr/local/bin/sz &quot;$FILE&quot; -e -b sleep 1 echo echo \\# Received $FILEfi ä¸‹è½½shell iterm2-recv-zmodem.sh 12345678910111213141516171819202122232425262728#!/bin/bash# Author: Matt Mastracci (matthew@mastracci.com)# AppleScript from http://stackoverflow.com/questions/4309087/cancel-button-on-osascript-in-a-bash-script# licensed under cc-wiki with attribution required # Remainder of script public domainosascript -e &apos;tell application &quot;iTerm2&quot; to version&apos; &gt; /dev/null 2&gt;&amp;1 &amp;&amp; NAME=iTerm2 || NAME=iTermif [[ $NAME = &quot;iTerm&quot; ]]; then FILE=`osascript -e &apos;tell application &quot;iTerm&quot; to activate&apos; -e &apos;tell application &quot;iTerm&quot; to set thefile to choose folder with prompt &quot;Choose a folder to place received files in&quot;&apos; -e &quot;do shell script (\\&quot;echo \\&quot;&amp;(quoted form of POSIX path of thefile as Unicode text)&amp;\\&quot;\\&quot;)&quot;`else FILE=`osascript -e &apos;tell application &quot;iTerm2&quot; to activate&apos; -e &apos;tell application &quot;iTerm2&quot; to set thefile to choose folder with prompt &quot;Choose a folder to place received files in&quot;&apos; -e &quot;do shell script (\\&quot;echo \\&quot;&amp;(quoted form of POSIX path of thefile as Unicode text)&amp;\\&quot;\\&quot;)&quot;`fiif [[ $FILE = &quot;&quot; ]]; then echo Cancelled. # Send ZModem cancel echo -e \\\\x18\\\\x18\\\\x18\\\\x18\\\\x18 sleep 1 echo echo \\# Cancelled transferelse cd &quot;$FILE&quot; /usr/local/bin/rz -E -e -b sleep 1 echo echo echo \\# Sent \\-\\&gt; $FILEfi é…ç½®iterm2 è®¾ç½®Iterm2çš„Tirggerç‰¹æ€§ï¼Œprofiles-default-editProfiles-Advancedä¸­çš„Tirgger 1234567891011æ·»åŠ ä¸¤æ¡triggerï¼Œåˆ†åˆ«è®¾ç½®Regular expressionï¼ŒActionï¼ŒParametersï¼ŒInstantå¦‚ä¸‹ï¼š 1.ç¬¬ä¸€æ¡ Regular expression: rz waiting to receive.\\*\\*B0100 Action: Run Silent Coprocess Parameters: /usr/local/bin/iterm2-send-zmodem.sh Instant: checked 2.ç¬¬äºŒæ¡ Regular expression: \\*\\*B00000000000000 Action: Run Silent Coprocess Parameters: /usr/local/bin/iterm2-recv-zmodem.sh Instant: checked å¤‡æ³¨:æ³¨æ„ä¸¤ä¸ªæ–‡ä»¶çš„æƒé™","tags":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"http://yoursite.com/tags/å·¥å…·/"}]},{"title":"solr-å¢åˆ æ”¹æŸ¥","date":"2018-06-21T12:21:18.000Z","path":"2018/06/21/solr-ä»æ§åˆ¶é¡µé¢åˆ é™¤æ•°æ®/","text":"èƒŒæ™¯solr ç‰ˆæœ¬ 5.3.1 1.åˆ é™¤æ•°æ®solr æä¾›å¤šé‡åˆ é™¤æ•°æ®æ–¹å¼, ä»æ§åˆ¶é¡µåˆ é™¤æ•°æ®æ˜¯ä¸€ç§æ–¹å¼,ä¸»è¦ç”¨äºäººå·¥åˆ é™¤å°‘é‡æ•°æ®eg: æ‰§è¡Œåˆ é™¤æ“ä½œä¹‹å‰: åˆ é™¤æ“ä½œåªéœ€åœ¨æ§åˆ¶é¡µDocument Type é€‰æ‹©XMLé€‰é¡¹,ç„¶åè¾“å…¥ä¸€ä¸‹å†…å®¹æäº¤å³å¯ã€‚ 123&lt;commit/&gt;&lt;delete&gt;&lt;query&gt;id:change.me1&lt;/query&gt;&lt;/delete&gt;&lt;commit/&gt; å…·ä½“æ‰§è¡Œ,ä»¥åŠhttpè¯·æ±‚: æœ€åä¸ºæ‰§è¡Œåˆ é™¤åçš„ç»“æœ: æ–°å¢æ•°æ®json æ–¹å¼æ·»åŠ æ•°æ®åŒæ ·åœ¨solrçš„æ§åˆ¶é¡µé¢,é€‰åœ¨Document Typeä¸ºjsonã€‚ è¾“å…¥: 1&#123;&quot;id&quot;:&quot;ceshi2&quot;,&quot;title&quot;:&quot;è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•&quot;&#125; å¯ä»¥çœ‹å‡ºæ¥solræ˜¯å·²httpè¯·æ±‚çš„æ–¹å¼è¯·æ±‚ solr server,æ‰€ä»¥æˆ‘ä»¬ç”¨ç¨‹åºå»æŸ¥è¯¢solræ•°æ®æ˜¯,ä¹Ÿå¯jsonçš„æ–¹å¼å»æŸ¥è¯¢ã€‚å½“ç„¶solræ”¯æŒxmlç­‰å¤šç§åŠŸèƒ½ã€‚ï¼ˆsolræ”¯æŒä»æ•°æ®åº“å¯¼å…¥æ•°æ®ï¼‰å…·ä½“æŸ¥è¯¢è§„åˆ™ï¼ˆç›®å‰è¿˜æ²¡æ‰¾åˆ°,æ‰¾åˆ°åè¡¥å……ï¼‰: æ‰§è¡Œç»“æœ æ›´æ–°æ•°æ®ç¬¬ä¸€ä¸ªé—®é¢˜:solrä¸æ”¯æŒå±€éƒ¨æ›´æ–°ã€‚æ‰€æœ‰çš„æ›´æ–°æ“ä½œå¯¹äºsolræ¥è¯´éƒ½æ˜¯ä¸€æ¬¡æ•°æ®çš„åˆ é™¤å’Œæ’å…¥,ä¾‹å¦‚: åŒäº‹åˆè¯´æ”¯æŒå±€éƒ¨æ›´æ–°,ä½†æ˜¯æˆ‘è¿˜æ²¡æœ‰æ‰¾åˆ°ç›¸å…³æ–‡æ¡£,è¿™ä¸ªå¸¦æ±‚è¯","tags":[{"name":"solr","slug":"solr","permalink":"http://yoursite.com/tags/solr/"}]},{"title":"websocketè®¢é˜…ç«å¸æˆäº¤è®°å½•","date":"2018-06-19T10:15:57.000Z","path":"2018/06/19/websocketè®¢é˜…ç«å¸æˆäº¤è®°å½•/","text":"python3å•çº¿ç¨‹ï¼šæ–‡ä»¶ä¸€ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798# -*- coding: utf-8 -*-#author: maxie_ljimport _threadfrom websocket import create_connectionfrom mysqlOpertion import connect_mysqlimport gzipimport timeimport json# é“¾æ¥def connect(): while(1): try: print('') # æŒ‚ä»£ç† ws = create_connection(\"wss://www.huobi.br.com/-/s/pro/ws\") #print('é“¾æ¥æˆåŠŸ') return ws break except Exception as err: #print(err) #print('connect ws error,retry...') time.sleep(1)def getsubconfig(): # ç»Ÿè®¡å‚æ•° tradeStr=[ \"\"\"&#123;\"sub\": \"market.elfusdt.trade.detail\",\"id\": \"id1\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.btcusdt.trade.detail\",\"id\": \"id2\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.htusdt.trade.detail\",\"id\": \"id3\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.swftcbtc.trade.detail\",\"id\": \"id4\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.topcbtc.trade.detail\",\"id\": \"id6\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.bchusdt.trade.detail\",\"id\": \"id7\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.ethusdt.trade.detail\",\"id\": \"id8\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.etcusdt.trade.detail\",\"id\": \"id9\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.eosusdt.trade.detail\",\"id\": \"id9\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.ltcusdt.trade.detail\",\"id\": \"id9\"&#125;\"\"\" ] return tradeStr# è®¢é˜…def sub(ws,tradeStr): ws.send(tradeStr)# è·å–è¿”å›def getResponse(ws,tradeStr): db = connect_mysql.connect() while 1 : try : compressData=ws.recv() except Exception : #print('é“¾æ¥å¼‚å¸¸') run(tradeStr,1) try : result=gzip.decompress(compressData).decode('utf-8') except: #print('ä¸¢åŒ…è§£æå¼‚å¸¸') continue if result[:7] == '&#123;\"ping\"': ts=result[8:21] #print('å¿ƒè·³åŒ…',ts) pong='&#123;\"pong\":'+ts+'&#125;' ws.send(pong) else: if result[:5] == '&#123;\"ch\"': result = json.loads(result) #print(result) #print('------------------------------------------------------') n = 0 while n &lt; len(result['tick']['data']) : connect_mysql.commit('%s' % result['ch'].split('.')[1],result['tick']['data'][n]['price'],result['tick']['data'][n]['amount'],\"'%s'\" % result[\"tick\"][\"data\"][n][\"direction\"], \"'%s'\" % result['ch'].split('.')[1],db); n += 1def subCoin(tradeStr): ws=connect() sub(ws,tradeStr) getResponse(ws,tradeStr)def run(tradeStr,test): subCoin(tradeStr)def main(): tradeStr=getsubconfig() try : tradeStr = getsubconfig() i = 0 while i &lt; len(tradeStr) : _thread.start_new_thread( run, (tradeStr[i],i) ) i += 1 except Exception as err : print(err) while 1: passif __name__ == '__main__': main() å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼šæ–‡ä»¶ä¸€ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889# -*- coding: utf-8 -*-#author: maxie_ljimport _threadfrom websocket import create_connectionfrom test1 import connect_mysqlimport gzipimport timeimport json# é“¾æ¥æ•°æ®åº“def connect(): while(1): try: ws = create_connection(\"wss://www.huobi.br.com/-/s/pro/ws\") # print('é“¾æ¥æˆåŠŸ') return ws break except Exception as err: print(err) #print('connect ws error,retry...') time.sleep(1)def getsubconfig(): # ç»Ÿè®¡å‚æ•° tradeStr=[ \"\"\"&#123;\"sub\": \"market.elfusdt.trade.detail\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.btcusdt.trade.detail\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.htusdt.trade.detail\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.swftcbtc.trade.detail\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.topcbtc.trade.detail\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.bchusdt.trade.detail\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.ethusdt.trade.detail\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.etcusdt.trade.detail\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.eosusdt.trade.detail\"&#125;\"\"\", \"\"\"&#123;\"sub\": \"market.ltcusdt.trade.detail\"&#125;\"\"\" ] return tradeStr# è®¢é˜…def sub(ws,tradeStr): ws.send(tradeStr)# è·å–è¿”å›def getResponse(ws): db = connect_mysql.connect() while 1 : try : compressData=ws.recv() except Exception : ws=connect() subCoin(ws) print('é“¾æ¥å¼‚å¸¸') try : result=gzip.decompress(compressData).decode('utf-8') except: print('ä¸¢åŒ…è§£æå¼‚å¸¸') continue if result[:7] == '&#123;\"ping\"': ts=result[8:21] #print('å¿ƒè·³åŒ…',ts) pong='&#123;\"pong\":'+ts+'&#125;' ws.send(pong) else: if result[:5] == '&#123;\"ch\"': result = json.loads(result) print(result) #print('------------------------------------------------------') n = 0 while n &lt; len(result['tick']['data']) : connect_mysql.commit('%s' % result['ch'].split('.')[1],result['tick']['data'][n]['price'],result['tick']['data'][n]['amount'],\"'%s'\" % result[\"tick\"][\"data\"][n][\"direction\"], \"'%s'\" % result['ch'].split('.')[1],db); n += 1# è®¢é˜…def subCoin(ws): tradeStr=getsubconfig() i = 0 while i &lt; len(tradeStr) : sub(ws,tradeStr[i]) i += 1# ä¸»å‡½æ•°def main(): ws=connect() subCoin(ws) getResponse(ws)if __name__ == '__main__': main() 1234567891011121314151617181920212223242526272829### æ–‡ä»¶äºŒ:```pythonimport jsonimport pymysqlimport timeclass connect_mysql(): db = &apos;&apos; def connect() : db = connect_mysql.db = pymysql.connect(&quot;localhost&quot;, &quot;root&quot;, &quot;root&quot;, &quot;huobi&quot;, charset=&apos;utf8&apos; ) return db def commit(table, price, amount, action, coin_type, db) : try: cursor = db.cursor() sql = &quot;INSERT INTO %s_success_order(action,order_amount, price, coin_type)VALUES (%s, %.10f, %.10f,%s )&quot; % (table,action, amount, price,coin_type ) cursor.execute(sql) # æäº¤åˆ°æ•°æ®åº“æ‰§è¡Œ db.commit() except Exception as e: db = connect_mysql.db = pymysql.connect(&quot;localhost&quot;, &quot;root&quot;, &quot;root&quot;, &quot;huobi&quot;, charset=&apos;utf8&apos; ) commit(table, price, amount, action, coin_type, db) return def connect_close() : connect_mysql.db.close() æ–‡ä»¶äºŒæ˜¯å•çº¿ç¨‹å’Œå¤šçº¿ç¨‹ç‰ˆçš„å…¬ç”¨æ–‡ä»¶ shell è„šæœ¬123456789101112#!/bin/bashtotal=1avaliable=`ps -ef | grep -w huobi.py | grep -v grep | wc -l`diff=`expr $total - $avaliable`#echo $diff &gt;&gt; /home/script/diff.text#echo $total &gt;&gt; /home/script/diff.text#echo $avaliable &gt;&gt; /home/script/diff.textif [ $diff -gt 0 ];then for((i=0;i&lt;$diff;i++));do /usr/local/bin/python3 /home/script/huobi.py &gt;&gt; /home/script/huobi.out donefi crontab é…ç½®123MAILTO=\"\"* * * * * sudo /bin/bash /home/script/huobi.sh æ³¨æ„äº‹é¡¹ï¼šåœ¨å†™shellè„šæœ¬æ—¶ï¼Œå°½é‡ç”¨ç»å¯¹è·¯å¾„ã€‚","tags":[{"name":"æŠ˜è…¾","slug":"æŠ˜è…¾","permalink":"http://yoursite.com/tags/æŠ˜è…¾/"}]},{"title":"PHPExcel","date":"2017-10-30T02:42:03.000Z","path":"2017/10/30/PHPExecel/","text":"PHPEXcel èƒŒæ™¯åœ¨å·¥ä½œä¸­æˆ‘ä»¬è‚¯å®šä¼šé‡åˆ°ç”±äºåç«¯ç®¡ç†ç³»ç»Ÿä¸å®Œå–„ï¼Œè€Œå¯¼è‡´è¿è¥åŒå­¦æ— æ³•ä»ç®¡ç†ç³»ç»Ÿè·å–æƒ³è¦çš„æ•°æ®ã€‚äº¦æˆ–ç¨‹åºè®¾è®¡ä¹‹åˆæ²¡æœ‰è€ƒè™‘åˆ°å®Œå–„ï¼Œå¯¼è‡´ä¸€äº›å¿…è¦çš„æ•°æ®æ²¡æœ‰å½•å…¥ï¼Œå¸Œæœ›åç»­è¡¥å……æ‰¹é‡å¯¼å…¥ã€‚åœ¨è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦è·å–ä»æ•°æ®æ‰¹é‡å¯¼å‡ºæ•°æ®æˆ–è€…å¯¼å…¥æ•°æ®ï¼Œè€Œæ— è®ºå¯¼å…¥è¿˜æ˜¯å¯¼å‡ºæ•°æ®ï¼Œæˆ‘ä»¬éƒ½å¸Œæœ›æ˜¯Excelæ ¼å¼ã€‚ æ ¹æ®Execelç”Ÿæˆsql1.PHPExcel å‡†å¤‡ï¼šæˆ‘ä»¬éœ€è¦ä»githubè·å–PHPExcelå·¥å…·åŒ…ã€‚åœ°å€ https://github.com/PHPOffice/PHPExcel æ‰“å¼€PHPExcelæ–‡ä»¶å¤¹ï¼Œçœ‹ä¸‹ä»£ç ç»“æ„ã€‚æˆ‘ä»¬éœ€è¦çš„ä¸»è¦ä»£ç åœ¨Classesæ–‡ä»¶ä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦å¼•å…¥PHPExcel.phpå³å¯ã€‚ ä»£ç å®ç°1234567891011121314151617181920212223242526272829include './code/web_code/PHPExcel/Classes/PHPExcel.php';//å¼•å…¥å¿…è¦çš„ç¬¬ä¸‰æ–¹ä¾èµ–$inputFileType = 'Excel2007';//è®¾ç½®Excelçš„ç‰ˆæœ¬$inputFileName = './targe.xlsx';// éœ€è¦å¯¼å…¥æ–‡ä»¶åœ°å€$currentsheet = $objPHPExcel-&gt;getSheet(0); //é€‰æ‹©Excelé¡µ$maxColumn = $currentsheet-&gt;getHighestColumn(); //è·å–å½“å‰é¡µçš„æœ€å¤§åˆ—æ•°$maxRow = $currentsheet-&gt;getHighestRow(); //è·å–å½“å‰é¡µçš„æœ€å¤§è¡Œæ•°//å¾ªç¯æ‹¼æ¥sqlfor ($i=2; $i&lt; $maxRow; $i++) &#123; //è¿‡æ»¤æ¡ä»¶ if(is_null($currentsheet-&gt;getCell('J'.$i)-&gt;getValue())||$currentsheet-&gt;getCell('J'.$i)-&gt;getValue()== 'å·²é€€æ¬¾' || $currentsheet-&gt;getCell('J'.$i)-&gt;getValue() == 'å¾…é€€æ¬¾' || $currentsheet-&gt;getCell('J'.$i)-&gt;getValue() == 'å·²ç»ç”³è¯·é€€æ¬¾' || $currentsheet-&gt;getCell('J'.$i)-&gt;getValue() == 'é€€äº†' ||$currentsheet-&gt;getCell('J'.$i)-&gt;getValue() == 'æ²¡æœ‰ç”µè¯' || $currentsheet-&gt;getCell('J'.$i)-&gt;getValue() == '0') &#123; continue; &#125; //è¿‡æ»¤æ¡ä»¶ if(!is_numeric($currentsheet-&gt;getCell('J'.$i)-&gt;getValue())||$currentsheet-&gt;getCell('J'.$i)-&gt;getValue() == '0' || empty($currentsheet-&gt;getCell('J'.$i)-&gt;getValue()) || $currentsheet-&gt;getCell('J'.$i)-&gt;getValue() == '') &#123; continue; &#125; $sql_bd_name .= ' WHEN '.$currentsheet-&gt;getCell('A'.$i)-&gt;getValue().' THEN '.$currentsheet-&gt;getCell('J'.$i)-&gt;getValue(); $sql_bd_name .= ','.$currentsheet-&gt;getCell('A'.$i)-&gt;getValue(); $res +=1;&#125;//è¾“å…¥ï¼Œå½“ç„¶è¿™é‡Œæ— è®ºæˆ‘ä»¬ç”¨fopenæˆ–è€…å…¶ä»–çš„è¾“å…¥å½“å±éƒ½å¯ä»¥ï¼Œè¿™é‡Œæˆ‘æŠŠç»“æœæ‰“åˆ°äº†æ§åˆ¶å°ã€‚echo $sql_bd_name;echo $res æˆ‘ä»¬ç”Ÿæˆçš„sqlæ˜¯WHEN THENçš„æ ·å¼ï¼Œå®Œæ•´è¯­å¥åº”è¯¥æ˜¯ update tablename set seller_jn_activity CASE idWHEN 1 TEHN 2END,bd_jn_activity CASE idwhen 2 THEN 3ENDWHERE in (1,2,3) å‘ç°æ•°æ®æ¸…æ´—å…¶å®æ˜¯ä¸€ä»¶å¾ˆéº»çƒ¦çš„äº‹ã€‚","tags":[{"name":"pear","slug":"pear","permalink":"http://yoursite.com/tags/pear/"}]},{"title":"ä¸€æ¬¡HTTPè¯·æ±‚","date":"2016-11-20T12:09:23.000Z","path":"2016/11/20/ä¸€æ¬¡HTTPè¯·æ±‚/","text":"#ä¸€æ¬¡å®Œæ•´çš„HTTPè¯·æ±‚ï¼Œä»¥åŠè¯·æ±‚æ–¹å¼çš„åŒºåˆ« ä»Šå¤©åœ¨å¯¹æ¥ä¸šåŠ¡ç»„masæ—¶å€™é‡åˆ°ä¸€ä¸ªå¾ˆå°‘é‡åˆ°çš„é—®é¢˜ï¼Œå‘é€ä¸€ä¸ªä¸€ä¸ªä¸ä½†å‚æ•°çš„POSTçš„è¯·æ±‚ã€‚åœ¨æˆ‘çš„å°è±¡é‡Œä¼ å‚å¥½åƒå¿…å¸¦åå­—ï¼Œå› ä¸ºå°±åƒä¸€ä¸ªä½ ä¸è®¤è¯†çš„äººè¦æ¥ä½ å®¶ï¼Œä½ è‚¯å®šä¸ä¼šè®©ä»–è¿›æ¥çš„ã€‚æ‰€ä»¥é‡æ–°ç¼•äº†ä¸€ä¸‹POSTè¯·æ±‚ï¼Œå†²å†²èƒ½ã€‚ ##ä¸€æ¬¡HTTPè¯·æ±‚çš„è¿‡ç¨‹ è®¿é—®æŸä¸ªç½‘å€ï¼Œä¾‹å¦‚æˆ‘ä»¬è®¿é—®www.baidu.comæµè§ˆå™¨ä¼šå’Œç™¾åº¦çš„æœåŠ¡å™¨è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ï¼ˆä¸­é—´çš„åŸŸåè§£æç­‰æš‚ä¸è€ƒè™‘ï¼‰ç„¶åæ˜¯ç¨‹åºå±‚é¢çš„ä¿¡æ¯è¯·æ±‚ä¸æäº¤ ä¸‰æ¬¡æ¡æ‰‹-&gt;getæˆ–è€…postè¯·æ±‚ 1ï¼‰ Clienté¦–å…ˆå‘é€ä¸€ä¸ªè¿æ¥è¯•æ¢ï¼ŒACK=0 è¡¨ç¤ºç¡®è®¤å·æ— æ•ˆï¼ŒSYN = 1 è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªè¿æ¥è¯·æ±‚æˆ–è¿æ¥æ¥å—æŠ¥æ–‡ï¼ŒåŒæ—¶è¡¨ç¤ºè¿™ä¸ªæ•°æ®æŠ¥ä¸èƒ½æºå¸¦æ•°æ®ï¼Œseq = x è¡¨ç¤ºClientè‡ªå·±çš„åˆå§‹åºå·ï¼ˆseq = 0 å°±ä»£è¡¨è¿™æ˜¯ç¬¬0å·åŒ…ï¼‰ï¼Œè¿™æ—¶å€™Clientè¿›å…¥syn_sentçŠ¶æ€ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯ç­‰å¾…æœåŠ¡å™¨çš„å›å¤ 2ï¼‰ Serverç›‘å¬åˆ°è¿æ¥è¯·æ±‚æŠ¥æ–‡åï¼Œå¦‚åŒæ„å»ºç«‹è¿æ¥ï¼Œåˆ™å‘Clientå‘é€ç¡®è®¤ã€‚TCPæŠ¥æ–‡é¦–éƒ¨ä¸­çš„SYN å’Œ ACKéƒ½ç½®1 ï¼Œack = x + 1è¡¨ç¤ºæœŸæœ›æ”¶åˆ°å¯¹æ–¹ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„ç¬¬ä¸€ä¸ªæ•°æ®å­—èŠ‚åºå·æ˜¯x+1ï¼ŒåŒæ—¶è¡¨æ˜xä¸ºæ­¢çš„æ‰€æœ‰æ•°æ®éƒ½å·²æ­£ç¡®æ”¶åˆ°ï¼ˆack=1å…¶å®æ˜¯ack=0+1,ä¹Ÿå°±æ˜¯æœŸæœ›å®¢æˆ·ç«¯çš„ç¬¬1ä¸ªåŒ…ï¼‰ï¼Œseq = y è¡¨ç¤ºServer è‡ªå·±çš„åˆå§‹åºå·ï¼ˆseq=0å°±ä»£è¡¨è¿™æ˜¯æœåŠ¡å™¨è¿™è¾¹å‘å‡ºçš„ç¬¬0å·åŒ…ï¼‰ã€‚è¿™æ—¶æœåŠ¡å™¨è¿›å…¥syn_rcvdï¼Œè¡¨ç¤ºæœåŠ¡å™¨å·²ç»æ”¶åˆ°Clientçš„è¿æ¥è¯·æ±‚ï¼Œç­‰å¾…clientçš„ç¡®è®¤ã€‚ 3ï¼‰ Clientæ”¶åˆ°ç¡®è®¤åè¿˜éœ€å†æ¬¡å‘é€ç¡®è®¤ï¼ŒåŒæ—¶æºå¸¦è¦å‘é€ç»™Serverçš„æ•°æ®ã€‚ACK ç½®1 è¡¨ç¤ºç¡®è®¤å·ack= y + 1 æœ‰æ•ˆï¼ˆä»£è¡¨æœŸæœ›æ”¶åˆ°æœåŠ¡å™¨çš„ç¬¬1ä¸ªåŒ…ï¼‰ï¼ŒClientè‡ªå·±çš„åºå·seq= x + 1ï¼ˆè¡¨ç¤ºè¿™å°±æ˜¯æˆ‘çš„ç¬¬1ä¸ªåŒ…ï¼Œç›¸å¯¹äºç¬¬0ä¸ªåŒ…æ¥è¯´çš„ï¼‰ï¼Œä¸€æ—¦æ”¶åˆ°Clientçš„ç¡®è®¤ä¹‹åï¼Œè¿™ä¸ªTCPè¿æ¥å°±è¿›å…¥EstablishedçŠ¶æ€ï¼Œå°±å¯ä»¥å‘èµ·httpè¯·æ±‚äº†ã€‚ postè¯·æ±‚HTTP åè®®æ˜¯ä»¥ ASCII ç ä¼ è¾“ï¼Œå»ºç«‹åœ¨TCP/IPåè®®ä¹‹ä¸Šçš„åº”ç”¨å±‚è§„èŒƒï¼Œè§„èŒƒæŠŠ HTTP è¯·æ±‚åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šçŠ¶æ€è¡Œã€è¯·æ±‚å¤´ã€æ¶ˆæ¯ä¸»ä½“ã€‚ç±»ä¼¼äºä¸‹é¢è¿™æ ·ï¼š åè®®è§„å®š POST æäº¤çš„æ•°æ®å¿…é¡»æ”¾åœ¨æ¶ˆæ¯ä¸»ä½“ï¼ˆentity-bodyï¼‰ä¸­ï¼Œä½†åè®®å¹¶æ²¡æœ‰è§„å®šæ•°æ®å¿…é¡»ä½¿ç”¨ä»€ä¹ˆç¼–ç æ–¹å¼ã€‚å®é™…ä¸Šï¼Œå¼€å‘è€…å®Œå…¨å¯ä»¥è‡ªå·±å†³å®šæ¶ˆæ¯ä¸»ä½“çš„æ ¼å¼ï¼Œåªè¦æœ€åå‘é€çš„ HTTP è¯·æ±‚æ»¡è¶³ä¸Šé¢çš„æ ¼å¼å°±å¯ä»¥ã€‚ ä½†æ˜¯ï¼Œæ•°æ®å‘é€å‡ºå»ï¼Œè¿˜è¦æœåŠ¡ç«¯è§£ææˆåŠŸæ‰æœ‰æ„ä¹‰ã€‚ä¸€èˆ¬æœåŠ¡ç«¯è¯­è¨€å¦‚ phpã€python ç­‰ï¼Œä»¥åŠå®ƒä»¬çš„ frameworkï¼Œéƒ½å†…ç½®äº†è‡ªåŠ¨è§£æå¸¸è§æ•°æ®æ ¼å¼çš„åŠŸèƒ½ã€‚æœåŠ¡ç«¯é€šå¸¸æ˜¯æ ¹æ®è¯·æ±‚å¤´ï¼ˆheadersï¼‰ä¸­çš„ Content-Type å­—æ®µæ¥è·çŸ¥è¯·æ±‚ä¸­çš„æ¶ˆæ¯ä¸»ä½“æ˜¯ç”¨ä½•ç§æ–¹å¼ç¼–ç ï¼Œå†å¯¹ä¸»ä½“è¿›è¡Œè§£æã€‚æ‰€ä»¥è¯´åˆ° POST æäº¤æ•°æ®æ–¹æ¡ˆï¼ŒåŒ…å«äº† Content-Type å’Œæ¶ˆæ¯ä¸»ä½“ç¼–ç æ–¹å¼ä¸¤éƒ¨åˆ†ã€‚ä¸‹é¢å°±æ­£å¼å¼€å§‹ä»‹ç»å®ƒä»¬ã€‚ headerContent-Typeï¼Œå†…å®¹ç±»å‹ï¼Œä¸€èˆ¬æ˜¯æŒ‡ç½‘é¡µä¸­å­˜åœ¨çš„Content-Typeï¼Œç”¨äºå®šä¹‰ç½‘ç»œæ–‡ä»¶çš„ç±»å‹å’Œç½‘é¡µçš„ç¼–ç ï¼Œå†³å®šæ–‡ä»¶æ¥æ”¶æ–¹å°†ä»¥ä»€ä¹ˆå½¢å¼ã€ä»€ä¹ˆç¼–ç è¯»å–è¿™ä¸ªæ–‡ä»¶.å½“ç„¶è¿˜æœ‰UAç­‰å…¶ä»–å¤´ä¿¡æ¯ï¼Œ Content-Typeå¯¹ç…§è¡¨ï¼šhttp://tool.oschina.net/commons è¯´å‡ ç§å¸¸è§çš„Content-Type 1.application/x-www-form-urlencodedè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬å¸¸è§formè¡¨æ ¼æçš„æ–¹å¼ 2.multipart/form-data è¿™åˆæ˜¯ä¸€ä¸ªå¸¸è§çš„ POST æ•°æ®æäº¤çš„æ–¹å¼ã€‚æˆ‘ä»¬ä½¿ç”¨è¡¨å•ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œå¿…é¡»è®© form çš„ enctyped ç­‰äºè¿™ä¸ªå€¼ã€‚ç›´æ¥æ¥çœ‹ä¸€ä¸ªè¯·æ±‚ç¤ºä¾‹ 3.application/json application/json è¿™ä¸ª Content-Type ä½œä¸ºå“åº”å¤´å¤§å®¶è‚¯å®šä¸é™Œç”Ÿã€‚å®é™…ä¸Šï¼Œç°åœ¨è¶Šæ¥è¶Šå¤šçš„äººæŠŠå®ƒä½œä¸ºè¯·æ±‚å¤´ï¼Œç”¨æ¥å‘Šè¯‰æœåŠ¡ç«¯æ¶ˆæ¯ä¸»ä½“æ˜¯åºåˆ—åŒ–åçš„ JSON å­—ç¬¦ä¸²ã€‚ç”±äº JSON è§„èŒƒçš„æµè¡Œï¼Œé™¤äº†ä½ç‰ˆæœ¬ IE ä¹‹å¤–çš„å„å¤§æµè§ˆå™¨éƒ½åŸç”Ÿæ”¯æŒ JSON.stringifyï¼ŒæœåŠ¡ç«¯è¯­è¨€ä¹Ÿéƒ½æœ‰å¤„ç† JSON çš„å‡½æ•°ï¼Œä½¿ç”¨ JSON ä¸ä¼šé‡ä¸Šä»€ä¹ˆéº»çƒ¦ã€‚ so ç”¨è¿™ç§æ ¼å¼å°±å¯ä»¥ä¼ é€’éKey Valçš„æ•°æ®","tags":[{"name":"ç½‘ç»œ","slug":"ç½‘ç»œ","permalink":"http://yoursite.com/tags/ç½‘ç»œ/"}]},{"title":"php curl","date":"2015-07-18T12:28:10.000Z","path":"2015/07/18/php-curl/","text":"å‚æ•°1curl_setoptCURLOPT_RETURNTRANSFER è¡¨ç¤ºæ˜¯å¦ç›´æ¥è¾“å‡ºåˆ°æ§åˆ¶å° eg: 1234567$curl = curl_init();curl_setopt($curl, CURLOPT_URL, 'http://baidu.com');curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);curl_setopt($curl, CURLOPT_HEADER, 0);// curl_setopt($curl, CURLOPT_POST, 1);$ret = curl_exec($curl);// var_dump($ret); è¾“å‡ºç»“æœä¸º: æ‰“å¼€å‚æ•° 12345678&lt;?php$curl = curl_init();curl_setopt($curl, CURLOPT_URL, &apos;http://baidu.com&apos;);curl_setopt($curl, CURLOPT_RETURNTRANSFER, 0);curl_setopt($curl, CURLOPT_HEADER, 0);// curl_setopt($curl, CURLOPT_POST, 1);$ret = curl_exec($curl);// var_dump($ret); è¾“å‡ºç»“æœ å‚æ•°2CURLOPT_HEADERCURLOPT_HEADER è¡¨ç¤ºæ˜¯å¦è¾“å‡ºå¤´ä¿¡æ¯ 12345678&lt;?php$curl = curl_init();curl_setopt($curl, CURLOPT_URL, &apos;http://baidu.com&apos;);curl_setopt($curl, CURLOPT_RETURNTRANSFER, 0);curl_setopt($curl, CURLOPT_HEADER, 1);// curl_setopt($curl, CURLOPT_POST, 1);$ret = curl_exec($curl);// var_dump($ret); è¿”å›ç»“æœ 12345678&lt;?php$curl = curl_init();curl_setopt($curl, CURLOPT_URL, &apos;http://baidu.com&apos;);curl_setopt($curl, CURLOPT_RETURNTRANSFER, 0);curl_setopt($curl, CURLOPT_HEADER, 0);// curl_setopt($curl, CURLOPT_POST, 1);$ret = curl_exec($curl);// var_dump($ret); è¿”å›ç»“æœ get ä¸ postget123456789//åˆå§‹åŒ–$curl = curl_init();//è®¾ç½®urlcurl_setopt($curl, CURLOPT_URL, &apos;http://baidu.com&apos;);curl_setopt($curl, CURLOPT_RETURNTRANSFER, 0);curl_setopt($curl, CURLOPT_HEADER, 0);$ret = curl_exec($curl);//å…³é—­curl_close($curl); post 12345678910//åˆå§‹åŒ–$curl = curl_init();//è®¾ç½®urlcurl_setopt($curl, CURLOPT_URL, &apos;http://baidu.com&apos;);curl_setopt($curl, CURLOPT_RETURNTRANSFER, 0);curl_setopt($curl, CURLOPT_HEADER, 0);curl_setopt($curl, CURLOPT_POST, 1);$ret = curl_exec($curl);//å…³é—­curl_close($curl);","tags":[{"name":"php","slug":"php","permalink":"http://yoursite.com/tags/php/"}]},{"title":"github","date":"2015-06-26T14:04:09.000Z","path":"2015/06/26/github/","text":"Gitçš„å®‰è£…å’Œä½¿ç”¨ å‡†å¤‡å·¥ä½œï¼š ä¸‹è½½git å®¢æˆ·ç«¯ é“¾æ¥åœ°å€ ä¸‹è½½å®Œæ¯•åï¼Œå®‰è£…ä¸€è·¯ä¸€ä¸‹ä¸€æ­¥ã€‚å®‰è£…å®Œæˆä¹‹åæˆ‘ä»¬å¼€å§‹ä½¿ç”¨Gitä½¿ç”¨å‰æˆ‘ä»¬éœ€è¦å‘Šè¯‰Gitï¼Œæˆ‘ä»¬æ˜¯è°ã€‚æ‰€ä»¥éœ€è¦é…ç½®ä¸€äº›ä¿¡æ¯ï¼Œæ¥ç¡®å®šæˆ‘ä»¬çš„èº«ä»½ã€‚ 12git config â€“global user.name â€œç”¨æˆ·åâ€git config â€“global user.email â€œé‚®ç®±â€ ç¬¬ä¸€æ¡å‘½ä»¤ç”¨æ¥å‘Šè¯‰ git æˆ‘ä»¬çš„åå­—ï¼ˆä»¥åé“¾æ¥githubï¼‰ç¬¬äºŒæ¡å‘½ä»¤ç”¨æ¥å‘Šè¯‰git æˆ‘ä»¬çš„é‚®ç®± åˆ°æ­¤æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Gitäº† é“¾æ¥githubå¦‚æœæˆ‘ä»¬å¸Œæœ›æŠŠè‡ªå·±çš„é¡¹ç›®æ‰˜ç®¡åœ¨githubæˆ‘ä»¬å°±éœ€è¦å†åšä¸€äº›é…ç½® é¦–å…ˆæˆ‘ä»¬éœ€è¦ç”Ÿæˆssh,ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤1ssh-keygen â€“t rsa â€“C ç„¶åä»–æç¤ºçš„é»˜è®¤è·¯å¾„ç”Ÿæˆä¸€äº›æ–‡ä»¶ï¼Œæˆ–è€…ä½ è‡ªå·±é…ç½®è·¯å¾„ã€‚ åœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­ä¼šè®©ä½ è¾“å…¥å¯†ç ï¼Œå¯ä»¥ä¸è¾“å…¥ï¼Œä¸€è·¯å›è½¦ç”Ÿæˆå®Œæ¯•åï¼Œä¼šåœ¨ä½ é€‰æ‹©è·¯å¾„ä¸‹ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ ä¸€ä¸ªæ˜¯ .rsa ä¸€ä¸ªæ˜¯ .pub æˆ‘ä»¬è¿™é‡Œåªéœ€è¦.pubé‡Œçš„å†…å®¹ å¤åˆ¶é‡Œè¾¹çš„å†…å®¹ æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æŠŠæ–‡ä»¶é‡Œçš„keyæ·»åŠ åˆ°æˆ‘ä»¬çš„githubè´¦å·é‡Œã€‚ é¦–å…ˆæˆ‘ä»¬ç™»é™†æˆ‘ä»¬çš„githubè´¦å·ã€‚ ç„¶ååœ¨è®¾ç½®é‡Œ NEW SSH KEY æ·»åŠ æè¿°ç„¶åæŠŠæˆ‘ä»¬çš„keyå¤åˆ¶åˆ°é‡Œè¾¹å³å¯ã€‚ ä¸è¿‡åœ¨æäº¤ä¹‹å‰æˆ‘ä»¬è¿˜éœ€è¦åšä¸€äº›é…ç½®æ¥ç¡®å®šæˆ‘ä»¬éœ€è¦æŠŠå½“å‰åº“çš„ä»£ç æ¨é€åˆ°githubè´¦å·çš„å“ªä¸ªåº“é‡Œ1git remote add origin git@github.com:aaa/xxx åœ¨ä¸Šè¾¹çš„é…ç½®çš„å‘½ä»¤ä¸­ï¼Œaaaè¡¨ç¤ºçš„æˆ‘ä»¬çš„githubè´¦å·ã€‚xxxä½¿æˆ‘ä»¬çš„åº“æ–‡ä»¶ã€‚ä»¥åå°±å¯ä»¥ä½¿ç”¨gitæ¥è¿›è¡Œç‰ˆæœ¬ç®¡ç†å’Œæ¨é€åˆ°githubé‡Œäº†ã€‚æ­£å¸¸æ“ä½œä»£ç 1234git statusgit add .git commit -a &apos;message&apos;git push æäº¤å®Œæ¯•ã€‚ å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨å…¶ä»–ç”µè„‘ä¸Šä½¿ç”¨æˆ‘ä»¬æ‰˜ç®¡çš„ä»£ç ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨1git pull æˆ–è€…1git colne &apos;address&apos; æ¥ä»githubä¸Šè·å–æˆ‘ä»¬æ‰€éœ€è¦çš„ä»£ç  å¦‚æœåœ¨é…ç½®è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼ŒæŒ‰ç…§æç¤ºçš„ä»£ç è§£å†³å³å¯ã€‚å½“ç„¶åœ¨æ­¤å¦‚æœæˆ‘ä»¬ç›´æ¥ä½¿ç”¨äº†1git commit -a ä¼šå¼¹å‡ºæ¥vimçª—å£ï¼Œåœ¨è¿™é‡Œå†™ä¸€äº›vimçš„å‘½ä»¤åœ¨éinsertçŠ¶æ€ä¸‹æˆ‘ä»¬ä½¿ç”¨ctrl+dæ¥æ‰¹é‡é€‰æ‹©#ï¼Œç„¶åæŒ‰dåˆ é™¤ åœ¨é£æ’å…¥æ¨¡å¼å†™:wq ä¿å­˜å¹¶æ¨å‡º","tags":[{"name":"git","slug":"git","permalink":"http://yoursite.com/tags/git/"}]},{"title":"hexo git githubæ­å»ºåšå®¢","date":"2015-06-02T13:48:07.000Z","path":"2015/06/02/hexo-git-githubæ­å»ºåšå®¢/","text":"å¼€å§‹**éœ€æ±‚ç¯å¢ƒ git gitä¸‹è½½åœ°å€ node.js node.jsä¸‹è½½åœ°å€ ä¸¤ä¸ªå®‰è£…éƒ½æ˜¯ä¸€è·¯ä¸‹ä¸€æ­¥ éªŒè¯è½¯ä»¶æ­£ç¡®å®‰è£…git --version node -v npm -v å¦‚æœæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ï¼Œæ€å®‰è£…æˆåŠŸã€‚ å®‰è£…hexoåœ¨è¿™é‡Œå¦‚æœè¢«å¢™çš„å¯ä»¥ä½¿ç”¨æ·˜å®é•œåƒcnpm å…·ä½“æ€ä¹ˆæ“ä½œå¯ä»¥è‡ªè¡Œç™¾åº¦ï¼Œè¿™é‡Œä¸å¤šåšè§£é‡Šã€‚ä¸è¿‡ä¸€èˆ¬ä¸ä¼šè¢«å¢™ï¼Œæˆ‘ä½¿ç”¨npmã€‚è¿è¡Œä¸‹è¾¹çš„å‘½ä»¤å®‰è£…hexoï¼šè¢«å¢™è¯·ä½¿ç”¨å‘½ä»¤ï¼š npm install -g cnpm --registry=https://registry.npm.taobao.org ä»¥ä¸‹æ˜¯æ²¡æœ‰è¢«å¢™çš„å‘½ä»¤ï¼Œè¢«å¢™æŠŠnpmæ¢æˆcnpmå³å¯ã€‚å®‰è£…hexo npm install hexo-cli -g å®‰è£…å®Œæˆåï¼ŒéªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸã€‚ hexo -v æ–°å»ºæ–‡ä»¶å¤¹yourblog,è¾“å…¥å‘½ä»¤ $ hexo init blog $ cd blog æ–°å»ºåšå®¢ $ hexo new &quot;Hello Hexo&quot; ç”Ÿæˆé™æ€é¡µé¢ $ hexo generate è¿è¡ŒæœåŠ¡ $ hexo server ç„¶åæ‰“å¼€æµè§ˆå™¨è¾“å…¥ localhost:4000 å³å¯è®¿é—®æœ¬åœ°é™æ€é¡µé¢ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠæœ¬åœ°é™æ€é¡µé¢PUSHåˆ°github é¦–å…ˆä½ è¦æœ‰githubè´¦å·ã€‚ æ–°å»ºä¸€ä¸ªgithub.ioçš„åº“ è®¾ç½®æœ¬åœ°githubé…ç½®å‚æ•° ç»æœ¬åœ°é™æ€é¡µé¢pushåˆ°github githubè®¾ç½® æ–°å»ºgithubè´¦å·å°±ä¸åœ¨è¿™é‡Œé™ˆè¿°äº†ï¼Œå¦‚æœæœ‰åŒå­¦ä¸ä¼šä½¿ç”¨gitå°†ä»£ç pushåˆ°githubçš„è¯å¯ä»¥å‚è€ƒ å»–é›ªå³°çš„å®˜ç½‘æˆ‘ä»¬æ¥ç›´æ¥è¿›è¡Œç¬¬äºŒä¸ï¼Œåˆ›å»ºä¸€ä¸ªgithub.ioåº“ã€‚é¦–å…ˆç™»é™†æˆ‘ä»¬çš„githubè´¦å·ç‚¹å‡»new repository,ç„¶åè¾“å…¥youname.github.iogitè®¾ç½®è®¾ç½®gité…ç½®ä¿¡æ¯ $ git config --global user.name &quot;ä½ çš„ç”¨æˆ·å&quot; $ git config --global user.email &quot;ä½ çš„é‚®ç®±&quot; hexo è®¾ç½® å®‰è£…hexo gitæ’ä»¶ npm install hexo-deployer-git --save ç„¶åæ‰“å¼€åšå®¢æ ¹ç›®å½•çš„_config.ymlæ–‡ä»¶å¤§è‡´å†…å®¹æ˜¯è¿™ä¸ªæ ·å­çš„ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192# Hexo Configuration## Docs: https://hexo.io/docs/configuration.html## Source: https://github.com/hexojs/hexo/# Sitetitle: å’Œå¥³ç¥¨æŠ¢å¯ä¹subtitle:description:author: MaxieLjlanguage:timezone:# URL## If your site is put in a subdirectory, set url as &apos;http://yoursite.com/child&apos; and root as &apos;/child/&apos;url: http://yoursite.comroot: /permalink: :year/:month/:day/:title/permalink_defaults:# Directorysource_dir: sourcepublic_dir: publictag_dir: tagsarchive_dir: archivescategory_dir: categoriescode_dir: downloads/codei18n_dir: :langskip_render:# Writingnew_post_name: :title.md # File name of new postsdefault_layout: posttitlecase: false # Transform title into titlecaseexternal_link: true # Open external links in new tabfilename_case: 0render_drafts: falsepost_asset_folder: falserelative_link: falsefuture: truehighlight: enable: true line_number: true auto_detect: false tab_replace:# Category &amp; Tagdefault_category: uncategorizedcategory_map:tag_map:# Date / Time format## Hexo uses Moment.js to parse and display date## You can customize the date format as defined in## http://momentjs.com/docs/#/displaying/format/date_format: YYYY-MM-DDtime_format: HH:mm:ss# Pagination## Set per_page to 0 to disable paginationper_page: 10pagination_dir: page# Extensions## Plugins: https://hexo.io/plugins/## Themes: https://hexo.io/themes/theme: yilia# Deployment## Docs: https://hexo.io/docs/deployment.htmldeploy: type: git repository: https://github.com/MaxieLj/MaxieLj.github.io.git branch: masterjsonContent: meta: false pages: false posts: title: true date: true path: true text: true raw: false content: false slug: false updated: false comments: false link: false permalink: false excerpt: false categories: false tags: true æˆ‘ä»¬åªéœ€è¦åœ¨å°¾éƒ¨æ·»åŠ ï¼š1234deploy: type: git repository: https://github.com/MaxieLj/MaxieLj.github.io.git branch: master ç„¶åæˆ‘ä»¬è¿è¡Œ $ hexo g ç”Ÿæˆé™æ€æ–‡ä»¶ç„¶åæ¨é€åˆ°github $ hexo d ç„¶åè®¿é—®youname.github.ioå°±å¯ä»¥çœ‹åˆ°ç”Ÿæˆçš„é™æ€é¡µé¢äº†å½“ç„¶æˆ‘ä»¬ä¸€èˆ¬æ˜¯åœ¨æœ¬åœ°è°ƒè¯•å¥½å†ç”¨ hexo dæ¨é€åˆ°github","tags":[{"name":"hexo","slug":"hexo","permalink":"http://yoursite.com/tags/hexo/"}]}]